function melisClientKoNotification(e,t,i,s){void 0===s&&(s="closeByButtonOnly"),s="closeByButtonOnly"!==s?"overlay-hideonclick":"";var o="<h3>"+melisHelper.melisTranslator(e)+"</h3>";o+="<h4>"+melisHelper.melisTranslator(t)+"</h4>",$.each(i,function(e,t){if("label"!==e){o+='<p class="modal-error-cont"><b>'+(void 0==i[e].label?void 0==i.label?e:i.label:i[e].label)+": </b>  ";try{$.each(t,function(e,t){"label"!==e&&"form"!==e&&($errMsg="",t instanceof Object?$errMsg=t[0]:$errMsg=t,o+='<span><i class="fa fa-circle"></i>'+$errMsg+"</span>")})}catch(i){"label"!==e&&"form"!==e&&(o+='<span><i class="fa fa-circle"></i>'+t+"</span>")}o+="</p>"}});var a="<div class='melis-modaloverlay "+s+"'></div>";a+="<div class='melis-modal-cont KOnotif'>  <div class='modal-content'>"+o+" <span class='btn btn-block btn-primary'>"+translations.tr_meliscore_notification_modal_Close+"</span></div> </div>",$body.append(a)}function melisSKUKoNotification(e,t,i,s){void 0===s&&(s="closeByButtonOnly"),s="closeByButtonOnly"!==s?"overlay-hideonclick":"";var o="<h3>"+melisHelper.melisTranslator(e)+"</h3>";o+="<h4>"+melisHelper.melisTranslator(t)+"</h4>",$.each(i,function(e,t){if("label"!==e){o+='<p class="modal-error-cont"><b>'+(void 0==i[e].label?void 0==i.label?e:i.label:i[e].label)+": </b>  ";try{$.each(t,function(e,t){"label"!==e&&"form"!==e&&($errMsg="",t instanceof Object?$errMsg=t[0]:$errMsg=t,o+='<span><i class="fa fa-circle"></i>'+$errMsg+"</span>")})}catch(i){"label"!==e&&"form"!==e&&(o+='<span><i class="fa fa-circle"></i>'+t+"</span>")}o+="</p>"}});var a="<div class='melis-modaloverlay "+s+"'></div>";a+="<div class='melis-modal-cont KOnotif'>  <div class='modal-content'>"+o+" <span class='btn btn-block btn-primary'>"+translations.tr_meliscore_notification_modal_Close+"</span></div> </div>",$body.append(a)}function highlightSKUErrors(e,t,i){$(".duplicate-table-label").css("color","inherit"),0===e&&$.each(t,function(e,t){"form"in t&&$.each(this.form,function(e,t){$("#"+t+"_label").css("color","red")})})}function commerceDasboardPluginOrderMessagesDelete(e){1==e.find(".melis-commerce-dashboard-plugin-order-messages-parent").length&&(e.find(".melis-commerce-dashboard-plugin-order-messages-parent label.active input[value='all']").length>0?0==--commerceDashPluginorderMessagesInstanceCount&&(clearInterval(commerceDashPluginOrderMessagesAllMessagesInterval),commerceDashPluginOrderMessagesAllMessagesInterval=""):0==--commDashPluginOrderMessagesWithUnansweredFilterInstance&&(clearInterval(commerceDashPluginOrderMessagesUnseenMessagesInterval),commerceDashPluginOrderMessagesUnseenMessagesInterval=""))}var pUniqueId=[];$(function(){$("body")});var melisCommerce=function(e){function t(e){$("#"+e).append('<div id="loader" class="overlay-loader"><img class="loader-icon spinning-cog" src="/MelisCore/assets/images/cog12.svg" data-cog="cog12"></div>')}function i(e){$("#"+e+" .loader-icon").removeClass("spinning-cog").addClass("shrinking-cog"),setTimeout(function(){$("#"+e+" #loader").remove()},500)}function s(){$(".tooltipTable").each(function(){$(this).qtip({content:{text:$(this).next(".tooltiptext")},overwrite:!1,style:{classes:"qtip-tipsy qtip-shadow",width:"auto"},hide:{fixed:!0,delay:300,event:"mouseleave"},position:{target:"mouse",adjust:{mouse:!1},my:"center center",at:"center center"}})})}function o(){$(".tooltipTableVar").each(function(){$(this).qtip({content:{text:$(this).next(".tooltiptext")},overwrite:!1,style:{classes:"qtip-tipsy qtip-shadow",width:"auto"},hide:{fixed:!0,delay:300,event:"mouseleave"},position:{target:"mouse",adjust:{mouse:!1},my:"center center",at:"center center"}})})}function a(e,t,i,s){melisHelper.tabOpen(melisCore.escapeHtml(t),"icon-shippment",e+"_id_meliscommerce_products_page","meliscommerce_products_page",{productId:e},i),s&&"function"==typeof s&&s()}function r(){melisHelper.tabClose(melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page")}function n(){return activeTabId.split("_")[0]}function l(e){var t=melisCommerce.getCurrentProductId();null!=e&&(t=e),melisCoreTool.clearForm("productTextTypeForm"),melisHelper.zoneReload(t+"_id_meliscommerce_products_page","meliscommerce_products_page",{productId:t})}function c(){console.log("done");var e="";e="en_EN"==melisLangId?"en":melisLangId,setTimeout(function(){tinymce.init({mode:"specific_textareas",editor_selector:"mceEditor",language:e,height:200,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste template"],menubar:!1,toolbar:"undo redo | styleselect | bold italic | link image |  alignleft aligncenter alignright alignjustify | code"})},1e3)}function d(e,t,i,s,o){$(e).DataTable({responsive:!0,paging:!0,ordering:!0,processing:!0,serverSide:!0,searching:!0,lengthMenu:[[5,10,25,50,100,-1],[5,10,25,50,100,"All"]],pageLength:10,ajax:{url:t,type:"POST"},order:[[1,"asc"]],columns:i,columnDefs:[{responsivePriority:1,targets:0},{responsivePriority:2,targets:-1}],language:{url:"/melis/MelisCore/Language/getDataTableTranslations"},dom:'<"bulk-action"><"filter-bar fl">rtip',drawCallback:function(e){$(this).css("width","100%")}}),$(".filter-bar").html(s),$(".bulk-action").html(o)}function h(e,t,i,s){$.ajax({type:"POST",url:e,data:t,dataType:"json",encode:!0}).success(function(e){i(e)}).error(function(){s()})}function m(){return $("#"+activeTabId).find("div.ecom-doc-container").data("form-type")}function u(e){null==e?$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComDocument/setUniqueId",data:{id:e},dataType:"json",encode:!0}).success(function(e){pUniqueId[activeTabId]=e.id}):pUniqueId[activeTabId]=e}function p(){return pUniqueId[activeTabId]}function _(e){$("li a.tab-element[data-id='"+e+"']").css("pointer-events","none").parent().css("cursor","not-allowed")}function f(e){$("li a.tab-element[data-id='"+e+"']").css("pointer-events","auto").parent().css("cursor","pointer")}function g(){$.each($("#melis-id-nav-bar-tabs li a"),function(e,t){_($(t).data("id"))}),$.each($("ul.sideMenu"),function(e,t){$(t).css("pointer-events","none").parent().css("cursor","not-allowed")})}function v(){$.each($("#melis-id-nav-bar-tabs li a"),function(e,t){f($(t).data("id"))}),$.each($("ul.sideMenu"),function(e,t){$(t).css("pointer-events","none").css("pointer-events","auto").parent().css("cursor","pointer")})}return{pendingZoneStart:t,pendingZoneDone:i,initTooltipTable:s,initTooltipVarTable:o,initCommerceTable:d,openProductPage:a,postSave:h,getCurrentProductId:n,closeCurrentProductPage:r,reloadCurrentProdPage:l,initTinyMCE:c,getDocFormType:m,setUniqueId:u,getUniqueId:p,enableTab:f,disableTab:_,disableAllTabs:g,enableAllTabs:v}}(window);setInterval(function(){melisCommerce.enableAllTabs()},1e4),$(function(){var e=$.fn.checkbox,t=function(e,t){this.$element=$(e),this.options=$.extend({},$.fn.checkbox.defaults,t),this.$label=this.$element.parent(),this.$icon=this.$label.find("i"),this.$chk=this.$label.find("input[type=checkbox]"),this.setState(this.$chk),this.$chk.on("change",$.proxy(this.itemchecked,this))};t.prototype={constructor:t,setState:function(e){e=e||this.$chk;var t=e.is(":checked"),i=!!e.prop("disabled");this.$icon.removeClass("checked disabled"),!0===t&&this.$icon.addClass("checked"),!0===i&&this.$icon.addClass("disabled")},enable:function(){this.$chk.attr("disabled",!1),this.$icon.removeClass("disabled")},disable:function(){this.$chk.attr("disabled",!0),this.$icon.addClass("disabled")},toggle:function(){this.$chk.click()},itemchecked:function(e){var t=$(e.target);this.setState(t)},check:function(){this.$chk.prop("checked",!0),this.setState(this.$chk)},uncheck:function(){this.$chk.prop("checked",!1),this.setState(this.$chk)},isChecked:function(){return this.$chk.is(":checked")}},$.fn.checkbox=function(e){var i,s=Array.prototype.slice.call(arguments,1),o=this.each(function(){var o=$(this),a=o.data("checkbox"),r="object"==typeof e&&e;a||o.data("checkbox",a=new t(this,r)),"string"==typeof e&&(i=a[e].apply(a,s))});return void 0===i?o:i},$.fn.checkbox.defaults={},$.fn.checkbox.Constructor=t,$.fn.checkbox.noConflict=function(){return $.fn.checkbox=e,this},$(function(){$(window).on("load",function(){$(".checkbox-custom > input[type=checkbox]").each(function(){var e=$(this);e.data("checkbox")||e.checkbox(e.data())})})})}),function(e,t,i){!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):jQuery&&!jQuery.fn.qtip&&e(jQuery)}(function(s){"use strict";function o(e,t,i,o){this.id=i,this.target=e,this.tooltip=S,this.elements={target:e},this._id=V+"-"+i,this.timers={img:{}},this.options=t,this.plugins={},this.cache={event:{},target:s(),disabled:D,attr:o,onTooltip:D,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=D}function a(e){return e===S||"object"!==s.type(e)}function r(e){return!(s.isFunction(e)||e&&e.attr||e.length||"object"===s.type(e)&&(e.jquery||e.then))}function n(e){var t,i,o,n;return a(e)?D:(a(e.metadata)&&(e.metadata={type:e.metadata}),"content"in e&&(t=e.content,a(t)||t.jquery||t.done?(i=r(t)?D:t,t=e.content={text:i}):i=t.text,"ajax"in t&&(o=t.ajax,n=o&&o.once!==D,delete t.ajax,t.text=function(e,t){var a=i||s(this).attr(t.options.content.attr)||"Loading...",r=s.ajax(s.extend({},o,{context:t})).then(o.success,S,o.error).then(function(e){return e&&n&&t.set("content.text",e),e},function(e,i,s){t.destroyed||0===e.status||t.set("content.text",i+": "+s)});return n?a:(t.set("content.text",a),r)}),"title"in t&&(s.isPlainObject(t.title)&&(t.button=t.title.button,t.title=t.title.text),r(t.title||D)&&(t.title=D))),"position"in e&&a(e.position)&&(e.position={my:e.position,at:e.position}),"show"in e&&a(e.show)&&(e.show=e.show.jquery?{target:e.show}:e.show===M?{ready:M}:{event:e.show}),"hide"in e&&a(e.hide)&&(e.hide=e.hide.jquery?{target:e.hide}:{event:e.hide}),"style"in e&&a(e.style)&&(e.style={classes:e.style}),s.each(R,function(){this.sanitize&&this.sanitize(e)}),e)}function l(e,t){for(var i,s=0,o=e,a=t.split(".");o=o[a[s++]];)s<a.length&&(i=o);return[i||e,a.pop()]}function c(e,t){var i,s,o;for(i in this.checks)if(this.checks.hasOwnProperty(i))for(s in this.checks[i])this.checks[i].hasOwnProperty(s)&&(o=new RegExp(s,"i").exec(e))&&(t.push(o),("builtin"===i||this.plugins[i])&&this.checks[i][s].apply(this.plugins[i]||this,t))}function d(e){return K.concat("").join(e?"-"+e+" ":" ")}function h(e,t){return t>0?setTimeout(s.proxy(e,this),t):void e.call(this)}function m(e){this.tooltip.hasClass(ee)||(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this.timers.show=h.call(this,function(){this.toggle(M,e)},this.options.show.delay))}function u(e){if(!this.tooltip.hasClass(ee)&&!this.destroyed){var t=s(e.relatedTarget),i=t.closest(Y)[0]===this.tooltip[0],o=t[0]===this.options.show.target[0];if(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this!==t[0]&&"mouse"===this.options.position.target&&i||this.options.hide.fixed&&/mouse(out|leave|move)/.test(e.type)&&(i||o))try{e.preventDefault(),e.stopImmediatePropagation()}catch(e){}else this.timers.hide=h.call(this,function(){this.toggle(D,e)},this.options.hide.delay,this)}}function p(e){!this.tooltip.hasClass(ee)&&this.options.hide.inactive&&(clearTimeout(this.timers.inactive),this.timers.inactive=h.call(this,function(){this.hide(e)},this.options.hide.inactive))}function _(e){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(e)}function f(e,i,o){s(t.body).delegate(e,(i.split?i:i.join("."+V+" "))+"."+V,function(){var e=x.api[s.attr(this,W)];e&&!e.disabled&&o.apply(e,arguments)})}function g(e,i,a){var r,l,c,d,h,m=s(t.body),u=e[0]===t?m:e,p=e.metadata?e.metadata(a.metadata):S,_="html5"===a.metadata.type&&p?p[a.metadata.name]:S,f=e.data(a.metadata.name||"qtipopts");try{f="string"==typeof f?s.parseJSON(f):f}catch(e){}if(d=s.extend(M,{},x.defaults,a,"object"==typeof f?n(f):S,n(_||p)),l=d.position,d.id=i,"boolean"==typeof d.content.text){if(c=e.attr(d.content.attr),d.content.attr===D||!c)return D;d.content.text=c}if(l.container.length||(l.container=m),l.target===D&&(l.target=u),d.show.target===D&&(d.show.target=u),d.show.solo===M&&(d.show.solo=l.container.closest("body")),d.hide.target===D&&(d.hide.target=u),d.position.viewport===M&&(d.position.viewport=l.container),l.container=l.container.eq(0),l.at=new T(l.at,M),l.my=new T(l.my),e.data(V))if(d.overwrite)e.qtip("destroy",!0);else if(d.overwrite===D)return D;return e.attr(B,i),d.suppress&&(h=e.attr("title"))&&e.removeAttr("title").attr(ie,h).attr("title",""),r=new o(e,d,i,!!c),e.data(V,r),r}function v(e){return e.charAt(0).toUpperCase()+e.slice(1)}function y(e,t){var s,o,a=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+Ce.join(a+" ")+a).split(" "),n=0;if(be[t])return e.css(be[t]);for(;s=r[n++];)if((o=e.css(s))!==i)return be[t]=s,o}function b(e,t){return Math.ceil(parseFloat(y(e,t)))}function C(e,t){this._ns="tip",this.options=t,this.offset=t.offset,this.size=[t.width,t.height],this.qtip=e,this.init(e)}function k(e,t){this.options=t,this._ns="-modal",this.qtip=e,this.init(e)}function w(e){this._ns="ie6",this.qtip=e,this.init(e)}var x,$,T,j,I,M=!0,D=!1,S=null,A="x",O="y",P="width",H="height",z="top",N="left",L="bottom",E="right",F="center",U="flipinvert",q="shift",R={},V="qtip",B="data-hasqtip",W="data-qtip-id",K=["ui-widget","ui-tooltip"],Y="."+V,Q="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),G=V+"-fixed",J=V+"-default",X=V+"-focus",Z=V+"-hover",ee=V+"-disabled",te="_replacedByqTip",ie="oldtitle",se={ie:function(){var e,i;for(e=4,i=t.createElement("div");(i.innerHTML="\x3c!--[if gt IE "+e+"]><i></i><![endif]--\x3e")&&i.getElementsByTagName("i")[0];e+=1);return e>4?e:NaN}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||D};$=o.prototype,$._when=function(e){return s.when.apply(s,e)},$.render=function(e){if(this.rendered||this.destroyed)return this;var t=this,i=this.options,o=this.cache,a=this.elements,r=i.content.text,n=i.content.title,l=i.content.button,c=i.position,d=[];return s.attr(this.target[0],"aria-describedby",this._id),o.posClass=this._createPosClass((this.position={my:c.my,at:c.at}).my),this.tooltip=a.tooltip=s("<div/>",{id:this._id,class:[V,J,i.style.classes,o.posClass].join(" "),width:i.style.width||"",height:i.style.height||"",tracking:"mouse"===c.target&&c.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":D,"aria-describedby":this._id+"-content","aria-hidden":M}).toggleClass(ee,this.disabled).attr(W,this.id).data(V,this).appendTo(c.container).append(a.content=s("<div />",{class:V+"-content",id:this._id+"-content","aria-atomic":M})),this.rendered=-1,this.positioning=M,n&&(this._createTitle(),s.isFunction(n)||d.push(this._updateTitle(n,D))),l&&this._createButton(),s.isFunction(r)||d.push(this._updateContent(r,D)),this.rendered=M,this._setWidget(),s.each(R,function(e){var i;"render"===this.initialize&&(i=this(t))&&(t.plugins[e]=i)}),this._unassignEvents(),this._assignEvents(),this._when(d).then(function(){t._trigger("render"),t.positioning=D,t.hiddenDuringWait||!i.show.ready&&!e||t.toggle(M,o.event,D),t.hiddenDuringWait=D}),x.api[this.id]=this,this},$.destroy=function(e){function t(){if(!this.destroyed){this.destroyed=M;var e,t=this.target,i=t.attr(ie);this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),s.each(this.plugins,function(){this.destroy&&this.destroy()});for(e in this.timers)this.timers.hasOwnProperty(e)&&clearTimeout(this.timers[e]);t.removeData(V).removeAttr(W).removeAttr(B).removeAttr("aria-describedby"),this.options.suppress&&i&&t.attr("title",i).removeAttr(ie),this._unassignEvents(),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=S,delete x.api[this.id]}}return this.destroyed?this.target:(e===M&&"hide"!==this.triggering||!this.rendered?t.call(this):(this.tooltip.one("tooltiphidden",s.proxy(t,this)),!this.triggering&&this.hide()),this.target)},j=$.checks={builtin:{"^id$":function(e,t,i,o){var a=i===M?x.nextid:i,r=V+"-"+a;a!==D&&a.length>0&&!s("#"+r).length?(this._id=r,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):e[t]=o},"^prerender":function(e,t,i){i&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(e,t,i){this._updateContent(i)},"^content.attr$":function(e,t,i,s){this.options.content.text===this.target.attr(s)&&this._updateContent(this.target.attr(i))},"^content.title$":function(e,t,i){return i?(i&&!this.elements.title&&this._createTitle(),void this._updateTitle(i)):this._removeTitle()},"^content.button$":function(e,t,i){this._updateButton(i)},"^content.title.(text|button)$":function(e,t,i){this.set("content."+t,i)},"^position.(my|at)$":function(e,t,i){"string"==typeof i&&(this.position[t]=e[t]=new T(i,"at"===t))},"^position.container$":function(e,t,i){this.rendered&&this.tooltip.appendTo(i)},"^show.ready$":function(e,t,i){i&&(!this.rendered&&this.render(M)||this.toggle(M))},"^style.classes$":function(e,t,i,s){this.rendered&&this.tooltip.removeClass(s).addClass(i)},"^style.(width|height)":function(e,t,i){this.rendered&&this.tooltip.css(t,i)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(e,t,i){this.rendered&&this.tooltip.toggleClass(J,!!i)},"^events.(render|show|move|hide|focus|blur)$":function(e,t,i){this.rendered&&this.tooltip[(s.isFunction(i)?"":"un")+"bind"]("tooltip"+t,i)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(this.rendered){var e=this.options.position;this.tooltip.attr("tracking","mouse"===e.target&&e.adjust.mouse),this._unassignEvents(),this._assignEvents()}}}},$.get=function(e){if(this.destroyed)return this;var t=l(this.options,e.toLowerCase()),i=t[0][t[1]];return i.precedance?i.string():i};var oe=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,ae=/^prerender|show\.ready/i;$.set=function(e,t){if(this.destroyed)return this;var i,o=this.rendered,a=D,r=this.options;return"string"==typeof e?(i=e,e={},e[i]=t):e=s.extend({},e),s.each(e,function(t,i){if(o&&ae.test(t))return void delete e[t];var n,c=l(r,t.toLowerCase());n=c[0][c[1]],c[0][c[1]]=i&&i.nodeType?s(i):i,a=oe.test(t)||a,e[t]=[c[0],c[1],i,n]}),n(r),this.positioning=M,s.each(e,s.proxy(c,this)),this.positioning=D,this.rendered&&this.tooltip[0].offsetWidth>0&&a&&this.reposition("mouse"===r.position.target?S:this.cache.event),this},$._update=function(e,t){var i=this,o=this.cache;return this.rendered&&e?(s.isFunction(e)&&(e=e.call(this.elements.target,o.event,this)||""),s.isFunction(e.then)?(o.waiting=M,e.then(function(e){return o.waiting=D,i._update(e,t)},S,function(e){return i._update(e,t)})):e===D||!e&&""!==e?D:(e.jquery&&e.length>0?t.empty().append(e.css({display:"block",visibility:"visible"})):t.html(e),this._waitForContent(t).then(function(e){i.rendered&&i.tooltip[0].offsetWidth>0&&i.reposition(o.event,!e.length)}))):D},$._waitForContent=function(e){var t=this.cache;return t.waiting=M,(s.fn.imagesLoaded?e.imagesLoaded():(new s.Deferred).resolve([])).done(function(){t.waiting=D}).promise()},$._updateContent=function(e,t){this._update(e,this.elements.content,t)},$._updateTitle=function(e,t){this._update(e,this.elements.title,t)===D&&this._removeTitle(D)},$._createTitle=function(){var e=this.elements,t=this._id+"-title";e.titlebar&&this._removeTitle(),e.titlebar=s("<div />",{class:V+"-titlebar "+(this.options.style.widget?d("header"):"")}).append(e.title=s("<div />",{id:t,class:V+"-title","aria-atomic":M})).insertBefore(e.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(e){s(this).toggleClass("ui-state-active ui-state-focus","down"===e.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(e){s(this).toggleClass("ui-state-hover","mouseover"===e.type)}),this.options.content.button&&this._createButton()},$._removeTitle=function(e){var t=this.elements;t.title&&(t.titlebar.remove(),t.titlebar=t.title=t.button=S,e!==D&&this.reposition())},$._createPosClass=function(e){return V+"-pos-"+(e||this.options.position.my).abbrev()},$.reposition=function(i,o){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=M;var a,r,n,l,c=this.cache,d=this.tooltip,h=this.options.position,m=h.target,u=h.my,p=h.at,_=h.viewport,f=h.container,g=h.adjust,v=g.method.split(" "),y=d.outerWidth(D),b=d.outerHeight(D),C=0,k=0,w=d.css("position"),x={left:0,top:0},$=d[0].offsetWidth>0,T=i&&"scroll"===i.type,j=s(e),I=f[0].ownerDocument,S=this.mouse;if(s.isArray(m)&&2===m.length)p={x:N,y:z},x={left:m[0],top:m[1]};else if("mouse"===m)p={x:N,y:z},(!g.mouse||this.options.hide.distance)&&c.origin&&c.origin.pageX?i=c.origin:!i||i&&("resize"===i.type||"scroll"===i.type)?i=c.event:S&&S.pageX&&(i=S),"static"!==w&&(x=f.offset()),I.body.offsetWidth!==(e.innerWidth||I.documentElement.clientWidth)&&(r=s(t.body).offset()),x={left:i.pageX-x.left+(r&&r.left||0),top:i.pageY-x.top+(r&&r.top||0)},g.mouse&&T&&S&&(x.left-=(S.scrollX||0)-j.scrollLeft(),x.top-=(S.scrollY||0)-j.scrollTop());else{if("event"===m?i&&i.target&&"scroll"!==i.type&&"resize"!==i.type?c.target=s(i.target):i.target||(c.target=this.elements.target):"event"!==m&&(c.target=s(m.jquery?m:this.elements.target)),m=c.target,m=s(m).eq(0),0===m.length)return this;m[0]===t||m[0]===e?(C=se.iOS?e.innerWidth:m.width(),k=se.iOS?e.innerHeight:m.height(),m[0]===e&&(x={top:(_||m).scrollTop(),left:(_||m).scrollLeft()})):R.imagemap&&m.is("area")?a=R.imagemap(this,m,p,R.viewport?v:D):R.svg&&m&&m[0].ownerSVGElement?a=R.svg(this,m,p,R.viewport?v:D):(C=m.outerWidth(D),k=m.outerHeight(D),x=m.offset()),a&&(C=a.width,k=a.height,r=a.offset,x=a.position),x=this.reposition.offset(m,x,f),(se.iOS>3.1&&se.iOS<4.1||se.iOS>=4.3&&se.iOS<4.33||!se.iOS&&"fixed"===w)&&(x.left-=j.scrollLeft(),x.top-=j.scrollTop()),(!a||a&&a.adjustable!==D)&&(x.left+=p.x===E?C:p.x===F?C/2:0,x.top+=p.y===L?k:p.y===F?k/2:0)}return x.left+=g.x+(u.x===E?-y:u.x===F?-y/2:0),x.top+=g.y+(u.y===L?-b:u.y===F?-b/2:0),R.viewport?(n=x.adjusted=R.viewport(this,x,h,C,k,y,b),r&&n.left&&(x.left+=r.left),r&&n.top&&(x.top+=r.top),n.my&&(this.position.my=n.my)):x.adjusted={left:0,top:0},c.posClass!==(l=this._createPosClass(this.position.my))&&(c.posClass=l,d.removeClass(c.posClass).addClass(l)),this._trigger("move",[x,_.elem||_],i)?(delete x.adjusted,o===D||!$||isNaN(x.left)||isNaN(x.top)||"mouse"===m||!s.isFunction(h.effect)?d.css(x):s.isFunction(h.effect)&&(h.effect.call(d,this,s.extend({},x)),d.queue(function(e){s(this).css({opacity:"",height:""}),se.ie&&this.style.removeAttribute("filter"),e()})),this.positioning=D,this):this},$.reposition.offset=function(e,i,o){function a(e,t){i.left+=t*e.scrollLeft(),i.top+=t*e.scrollTop()}if(!o[0])return i;var r,n,l,c,d=s(e[0].ownerDocument),h=!!se.ie&&"CSS1Compat"!==t.compatMode,m=o[0];do{"static"!==(n=s.css(m,"position"))&&("fixed"===n?(l=m.getBoundingClientRect(),a(d,-1)):(l=s(m).position(),l.left+=parseFloat(s.css(m,"borderLeftWidth"))||0,l.top+=parseFloat(s.css(m,"borderTopWidth"))||0),i.left-=l.left+(parseFloat(s.css(m,"marginLeft"))||0),i.top-=l.top+(parseFloat(s.css(m,"marginTop"))||0),r||"hidden"===(c=s.css(m,"overflow"))||"visible"===c||(r=s(m)))}while(m=m.offsetParent);return r&&(r[0]!==d[0]||h)&&a(r,1),i};var re=(T=$.reposition.Corner=function(e,t){e=(""+e).replace(/([A-Z])/," $1").replace(/middle/gi,F).toLowerCase(),this.x=(e.match(/left|right/i)||e.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(e.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!t;var i=e.charAt(0);this.precedance="t"===i||"b"===i?O:A}).prototype;re.invert=function(e,t){this[e]=this[e]===N?E:this[e]===E?N:t||this[e]},re.string=function(e){var t=this.x,i=this.y,s=t!==i?"center"===t||"center"!==i&&(this.precedance===O||this.forceY)?[i,t]:[t,i]:[t];return!1!==e?s.join(" "):s},re.abbrev=function(){var e=this.string(!1);return e[0].charAt(0)+(e[1]&&e[1].charAt(0)||"")},re.clone=function(){return new T(this.string(),this.forceY)},$.toggle=function(e,i){var o=this.cache,a=this.options,r=this.tooltip;if(i){if(/over|enter/.test(i.type)&&o.event&&/out|leave/.test(o.event.type)&&a.show.target.add(i.target).length===a.show.target.length&&r.has(i.relatedTarget).length)return this;o.event=s.event.fix(i)}if(this.waiting&&!e&&(this.hiddenDuringWait=M),!this.rendered)return e?this.render(1):this;if(this.destroyed||this.disabled)return this;var n,l,c,d=e?"show":"hide",h=this.options[d],m=this.options.position,u=this.options.content,p=this.tooltip.css("width"),_=this.tooltip.is(":visible"),f=e||1===h.target.length,g=!i||h.target.length<2||o.target[0]===i.target;return(typeof e).search("boolean|number")&&(e=!_),n=!r.is(":animated")&&_===e&&g,l=n?S:!!this._trigger(d,[90]),this.destroyed?this:(l!==D&&e&&this.focus(i),!l||n?this:(s.attr(r[0],"aria-hidden",!e),e?(this.mouse&&(o.origin=s.event.fix(this.mouse)),s.isFunction(u.text)&&this._updateContent(u.text,D),s.isFunction(u.title)&&this._updateTitle(u.title,D),!I&&"mouse"===m.target&&m.adjust.mouse&&(s(t).bind("mousemove."+V,this._storeMouse),I=M),p||r.css("width",r.outerWidth(D)),this.reposition(i,arguments[2]),p||r.css("width",""),h.solo&&("string"==typeof h.solo?s(h.solo):s(Y,h.solo)).not(r).not(h.target).qtip("hide",new s.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete o.origin,I&&!s(Y+'[tracking="true"]:visible',h.solo).not(r).length&&(s(t).unbind("mousemove."+V),I=D),this.blur(i)),c=s.proxy(function(){e?(se.ie&&r[0].style.removeAttribute("filter"),r.css("overflow",""),"string"==typeof h.autofocus&&s(this.options.show.autofocus,r).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):r.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(e?"visible":"hidden")},this),h.effect===D||f===D?(r[d](),c()):s.isFunction(h.effect)?(r.stop(1,1),h.effect.call(r,this),r.queue("fx",function(e){c(),e()})):r.fadeTo(90,e?1:0,c),e&&h.target.trigger("qtip-"+this.id+"-inactive"),this))},$.show=function(e){return this.toggle(M,e)},$.hide=function(e){return this.toggle(D,e)},$.focus=function(e){if(!this.rendered||this.destroyed)return this;var t=s(Y),i=this.tooltip,o=parseInt(i[0].style.zIndex,10),a=x.zindex+t.length;return i.hasClass(X)||this._trigger("focus",[a],e)&&(o!==a&&(t.each(function(){this.style.zIndex>o&&(this.style.zIndex=this.style.zIndex-1)}),t.filter("."+X).qtip("blur",e)),i.addClass(X)[0].style.zIndex=a),this},$.blur=function(e){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(X),this._trigger("blur",[this.tooltip.css("zIndex")],e),this)},$.disable=function(e){return this.destroyed?this:("toggle"===e?e=!(this.rendered?this.tooltip.hasClass(ee):this.disabled):"boolean"!=typeof e&&(e=M),this.rendered&&this.tooltip.toggleClass(ee,e).attr("aria-disabled",e),this.disabled=!!e,this)},$.enable=function(){return this.disable(D)},$._createButton=function(){var e=this,t=this.elements,i=t.tooltip,o=this.options.content.button,a="string"==typeof o,r=a?o:"Close tooltip";t.button&&t.button.remove(),o.jquery?t.button=o:t.button=s("<a />",{class:"qtip-close "+(this.options.style.widget?"":V+"-icon"),title:r,"aria-label":r}).prepend(s("<span />",{class:"ui-icon ui-icon-close",html:"&times;"})),t.button.appendTo(t.titlebar||i).attr("role","button").click(function(t){return i.hasClass(ee)||e.hide(t),D})},$._updateButton=function(e){if(!this.rendered)return D;var t=this.elements.button;e?this._createButton():t.remove()},$._setWidget=function(){var e=this.options.style.widget,t=this.elements,i=t.tooltip,s=i.hasClass(ee);i.removeClass(ee),ee=e?"ui-state-disabled":"qtip-disabled",i.toggleClass(ee,s),i.toggleClass("ui-helper-reset "+d(),e).toggleClass(J,this.options.style.def&&!e),t.content&&t.content.toggleClass(d("content"),e),t.titlebar&&t.titlebar.toggleClass(d("header"),e),t.button&&t.button.toggleClass(V+"-icon",!e)},$._storeMouse=function(e){return(this.mouse=s.event.fix(e)).type="mousemove",this},$._bind=function(e,t,i,o,a){if(e&&i&&t.length){var r="."+this._id+(o?"-"+o:"");return s(e).bind((t.split?t:t.join(r+" "))+r,s.proxy(i,a||this)),this}},$._unbind=function(e,t){return e&&s(e).unbind("."+this._id+(t?"-"+t:"")),this},$._trigger=function(e,t,i){var o=new s.Event("tooltip"+e);return o.originalEvent=i&&s.extend({},i)||this.cache.event||S,this.triggering=e,this.tooltip.trigger(o,[this].concat(t||[])),this.triggering=D,!o.isDefaultPrevented()},$._bindEvents=function(e,t,i,o,a,r){var n=i.filter(o).add(o.filter(i)),l=[];n.length&&(s.each(t,function(t,i){var o=s.inArray(i,e);o>-1&&l.push(e.splice(o,1)[0])}),l.length&&(this._bind(n,l,function(e){(!!this.rendered&&this.tooltip[0].offsetWidth>0?r:a).call(this,e)}),i=i.not(n),o=o.not(n))),this._bind(i,e,a),this._bind(o,t,r)},$._assignInitialEvents=function(e){function t(e){return this.disabled||this.destroyed?D:(this.cache.event=e&&s.event.fix(e),this.cache.target=e&&s(e.target),clearTimeout(this.timers.show),void(this.timers.show=h.call(this,function(){this.render("object"==typeof e||i.show.ready)},i.prerender?0:i.show.delay)))}var i=this.options,o=i.show.target,a=i.hide.target,r=i.show.event?s.trim(""+i.show.event).split(" "):[],n=i.hide.event?s.trim(""+i.hide.event).split(" "):[];this._bind(this.elements.target,["remove","removeqtip"],function(){this.destroy(!0)},"destroy"),/mouse(over|enter)/i.test(i.show.event)&&!/mouse(out|leave)/i.test(i.hide.event)&&n.push("mouseleave"),this._bind(o,"mousemove",function(e){this._storeMouse(e),this.cache.onTarget=M}),this._bindEvents(r,n,o,a,t,function(){return this.timers?void clearTimeout(this.timers.show):D}),(i.show.ready||i.prerender)&&t.call(this,e)},$._assignEvents=function(){var i=this,o=this.options,a=o.position,r=this.tooltip,n=o.show.target,l=o.hide.target,c=a.container,d=a.viewport,h=s(t),f=s(e),g=o.show.event?s.trim(""+o.show.event).split(" "):[],v=o.hide.event?s.trim(""+o.hide.event).split(" "):[];s.each(o.events,function(e,t){i._bind(r,"toggle"===e?["tooltipshow","tooltiphide"]:["tooltip"+e],t,null,r)}),/mouse(out|leave)/i.test(o.hide.event)&&"window"===o.hide.leave&&this._bind(h,["mouseout","blur"],function(e){/select|option/.test(e.target.nodeName)||e.relatedTarget||this.hide(e)}),o.hide.fixed?l=l.add(r.addClass(G)):/mouse(over|enter)/i.test(o.show.event)&&this._bind(l,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+o.hide.event).indexOf("unfocus")>-1&&this._bind(c.closest("html"),["mousedown","touchstart"],function(e){var t=s(e.target),i=this.rendered&&!this.tooltip.hasClass(ee)&&this.tooltip[0].offsetWidth>0,o=t.parents(Y).filter(this.tooltip[0]).length>0;t[0]===this.target[0]||t[0]===this.tooltip[0]||o||this.target.has(t[0]).length||!i||this.hide(e)}),"number"==typeof o.hide.inactive&&(this._bind(n,"qtip-"+this.id+"-inactive",p,"inactive"),this._bind(l.add(r),x.inactiveEvents,p)),this._bindEvents(g,v,n,l,m,u),this._bind(n.add(r),"mousemove",function(e){if("number"==typeof o.hide.distance){var t=this.cache.origin||{},i=this.options.hide.distance,s=Math.abs;(s(e.pageX-t.pageX)>=i||s(e.pageY-t.pageY)>=i)&&this.hide(e)}this._storeMouse(e)}),"mouse"===a.target&&a.adjust.mouse&&(o.hide.event&&this._bind(n,["mouseenter","mouseleave"],function(e){return this.cache?void(this.cache.onTarget="mouseenter"===e.type):D}),this._bind(h,"mousemove",function(e){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(ee)&&this.tooltip[0].offsetWidth>0&&this.reposition(e)})),(a.adjust.resize||d.length)&&this._bind(s.event.special.resize?d:f,"resize",_),a.adjust.scroll&&this._bind(f.add(a.container),"scroll",_)},$._unassignEvents=function(){var i=this.options,o=i.show.target,a=i.hide.target,r=s.grep([this.elements.target[0],this.rendered&&this.tooltip[0],i.position.container[0],i.position.viewport[0],i.position.container.closest("html")[0],e,t],function(e){return"object"==typeof e});o&&o.toArray&&(r=r.concat(o.toArray())),
a&&a.toArray&&(r=r.concat(a.toArray())),this._unbind(r)._unbind(r,"destroy")._unbind(r,"inactive")},s(function(){f(Y,["mouseenter","mouseleave"],function(e){var t="mouseenter"===e.type,i=s(e.currentTarget),o=s(e.relatedTarget||e.target),a=this.options;t?(this.focus(e),i.hasClass(G)&&!i.hasClass(ee)&&clearTimeout(this.timers.hide)):"mouse"===a.position.target&&a.position.adjust.mouse&&a.hide.event&&a.show.target&&!o.closest(a.show.target[0]).length&&this.hide(e),i.toggleClass(Z,t)}),f("["+W+"]",Q,p)}),x=s.fn.qtip=function(e,t,o){var a=(""+e).toLowerCase(),r=S,l=s.makeArray(arguments).slice(1),c=l[l.length-1],d=this[0]?s.data(this[0],V):S;return!arguments.length&&d||"api"===a?d:"string"==typeof e?(this.each(function(){var e=s.data(this,V);if(!e)return M;if(c&&c.timeStamp&&(e.cache.event=c),!t||"option"!==a&&"options"!==a)e[a]&&e[a].apply(e,l);else{if(o===i&&!s.isPlainObject(t))return r=e.get(t),D;e.set(t,o)}}),r!==S?r:this):"object"!=typeof e&&arguments.length?void 0:(d=n(s.extend(M,{},e)),this.each(function(e){var t,i;return i=s.isArray(d.id)?d.id[e]:d.id,i=!i||i===D||i.length<1||x.api[i]?x.nextid++:i,t=g(s(this),i,d),t===D?M:(x.api[i]=t,s.each(R,function(){"initialize"===this.initialize&&this(t)}),void t._assignInitialEvents(c))}))},s.qtip=o,x.api={},s.each({attr:function(e,t){if(this.length){var i=this[0],o="title",a=s.data(i,"qtip");if(e===o&&a&&a.options&&"object"==typeof a&&"object"==typeof a.options&&a.options.suppress)return arguments.length<2?s.attr(i,ie):(a&&a.options.content.attr===o&&a.cache.attr&&a.set("content.text",t),this.attr(ie,t))}return s.fn["attr"+te].apply(this,arguments)},clone:function(e){var t=s.fn["clone"+te].apply(this,arguments);return e||t.filter("["+ie+"]").attr("title",function(){return s.attr(this,ie)}).removeAttr(ie),t}},function(e,t){if(!t||s.fn[e+te])return M;var i=s.fn[e+te]=s.fn[e];s.fn[e]=function(){return t.apply(this,arguments)||i.apply(this,arguments)}}),s.ui||(s["cleanData"+te]=s.cleanData,s.cleanData=function(e){for(var t,i=0;(t=s(e[i])).length;i++)if(t.attr(B))try{t.triggerHandler("removeqtip")}catch(e){}s["cleanData"+te].apply(this,arguments)}),x.version="3.0.3",x.nextid=0,x.inactiveEvents=Q,x.zindex=15e3,x.defaults={prerender:D,id:D,overwrite:M,suppress:M,content:{text:M,attr:"title",title:D,button:D},position:{my:"top left",at:"bottom right",target:D,container:D,viewport:D,adjust:{x:0,y:0,mouse:M,scroll:M,resize:M,method:"flipinvert flipinvert"},effect:function(e,t){s(this).animate(t,{duration:200,queue:D})}},show:{target:D,event:"mouseenter",effect:M,delay:90,solo:D,ready:D,autofocus:D},hide:{target:D,event:"mouseleave",effect:M,delay:0,fixed:D,inactive:D,leave:"window",distance:D},style:{classes:"",widget:D,width:D,height:D,def:M},events:{render:S,move:S,show:S,hide:S,toggle:S,visible:S,hidden:S,focus:S,blur:S}};var ne,le,ce,de,he,me="margin",ue="border",pe="color",_e="background-color",fe="transparent",ge=" !important",ve=!!t.createElement("canvas").getContext,ye=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,be={},Ce=["Webkit","O","Moz","ms"];ve?(de=e.devicePixelRatio||1,he=function(){var e=t.createElement("canvas").getContext("2d");return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}(),ce=de/he):le=function(e,t,i){return"<qtipvml:"+e+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(t||"")+' style="behavior: url(#default#VML); '+(i||"")+'" />'},s.extend(C.prototype,{init:function(e){var t,i;i=this.element=e.elements.tip=s("<div />",{class:V+"-tip"}).prependTo(e.tooltip),ve?(t=s("<canvas />").appendTo(this.element)[0].getContext("2d"),t.lineJoin="miter",t.miterLimit=1e5,t.save()):(t=le("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(t+t),e._bind(s("*",i).add(i),["click","mousedown"],function(e){e.stopPropagation()},this._ns)),e._bind(e.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(e){var t=this.qtip.elements.titlebar;return t&&(e.y===z||e.y===F&&this.element.position().top+this.size[1]/2+this.options.offset<t.outerHeight(M))},_parseCorner:function(e){var t=this.qtip.options.position.my;return e===D||t===D?e=D:e===M?e=new T(t.string()):e.string||(e=new T(e),e.fixed=M),e},_parseWidth:function(e,t,i){var s=this.qtip.elements,o=ue+v(t)+"Width";return(i?b(i,o):b(s.content,o)||b(this._useTitle(e)&&s.titlebar||s.content,o)||b(s.tooltip,o))||0},_parseRadius:function(e){var t=this.qtip.elements,i=ue+v(e.y)+v(e.x)+"Radius";return se.ie<9?0:b(this._useTitle(e)&&t.titlebar||t.content,i)||b(t.tooltip,i)||0},_invalidColour:function(e,t,i){var s=e.css(t);return!s||i&&s===e.css(i)||ye.test(s)?D:s},_parseColours:function(e){var t=this.qtip.elements,i=this.element.css("cssText",""),o=ue+v(e[e.precedance])+v(pe),a=this._useTitle(e)&&t.titlebar||t.content,r=this._invalidColour,n=[];return n[0]=r(i,_e)||r(a,_e)||r(t.content,_e)||r(t.tooltip,_e)||i.css(_e),n[1]=r(i,o,pe)||r(a,o,pe)||r(t.content,o,pe)||r(t.tooltip,o,pe)||t.tooltip.css(o),s("*",i).add(i).css("cssText",_e+":"+fe+ge+";"+ue+":0"+ge+";"),n},_calculateSize:function(e){var t,i,s,o=e.precedance===O,a=this.options.width,r=this.options.height,n="c"===e.abbrev(),l=(o?a:r)*(n?.5:1),c=Math.pow,d=Math.round,h=Math.sqrt(c(l,2)+c(r,2)),m=[this.border/l*h,this.border/r*h];return m[2]=Math.sqrt(c(m[0],2)-c(this.border,2)),m[3]=Math.sqrt(c(m[1],2)-c(this.border,2)),t=h+m[2]+m[3]+(n?0:m[0]),i=t/h,s=[d(i*a),d(i*r)],o?s:s.reverse()},_calculateTip:function(e,t,i){i=i||1,t=t||this.size;var s=t[0]*i,o=t[1]*i,a=Math.ceil(s/2),r=Math.ceil(o/2),n={br:[0,0,s,o,s,0],bl:[0,0,s,0,0,o],tr:[0,o,s,0,s,o],tl:[0,0,0,o,s,o],tc:[0,o,a,0,s,o],bc:[0,0,s,0,a,o],rc:[0,0,s,r,0,o],lc:[s,0,s,o,0,r]};return n.lt=n.br,n.rt=n.bl,n.lb=n.tr,n.rb=n.tl,n[e.abbrev()]},_drawCoords:function(e,t){e.beginPath(),e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.closePath()},create:function(){var e=this.corner=(ve||se.ie)&&this._parseCorner(this.options.corner);return this.enabled=!!this.corner&&"c"!==this.corner.abbrev(),this.enabled&&(this.qtip.cache.corner=e.clone(),this.update()),this.element.toggle(this.enabled),this.corner},update:function(t,i){if(!this.enabled)return this;var o,a,r,n,l,c,d,h,m=this.qtip.elements,u=this.element,p=u.children(),_=this.options,f=this.size,g=_.mimic,v=Math.round;t||(t=this.qtip.cache.corner||this.corner),g===D?g=t:(g=new T(g),g.precedance=t.precedance,"inherit"===g.x?g.x=t.x:"inherit"===g.y?g.y=t.y:g.x===g.y&&(g[t.precedance]=t[t.precedance])),a=g.precedance,t.precedance===A?this._swapDimensions():this._resetDimensions(),o=this.color=this._parseColours(t),o[1]!==fe?(h=this.border=this._parseWidth(t,t[t.precedance]),_.border&&1>h&&!ye.test(o[1])&&(o[0]=o[1]),this.border=h=_.border!==M?_.border:h):this.border=h=0,d=this.size=this._calculateSize(t),u.css({width:d[0],height:d[1],lineHeight:d[1]+"px"}),c=t.precedance===O?[v(g.x===N?h:g.x===E?d[0]-f[0]-h:(d[0]-f[0])/2),v(g.y===z?d[1]-f[1]:0)]:[v(g.x===N?d[0]-f[0]:0),v(g.y===z?h:g.y===L?d[1]-f[1]-h:(d[1]-f[1])/2)],ve?(r=p[0].getContext("2d"),r.restore(),r.save(),r.clearRect(0,0,6e3,6e3),n=this._calculateTip(g,f,ce),l=this._calculateTip(g,this.size,ce),p.attr(P,d[0]*ce).attr(H,d[1]*ce),p.css(P,d[0]).css(H,d[1]),this._drawCoords(r,l),r.fillStyle=o[1],r.fill(),r.translate(c[0]*ce,c[1]*ce),this._drawCoords(r,n),r.fillStyle=o[0],r.fill()):(n=this._calculateTip(g),n="m"+n[0]+","+n[1]+" l"+n[2]+","+n[3]+" "+n[4]+","+n[5]+" xe",c[2]=h&&/^(r|b)/i.test(t.string())?8===se.ie?2:1:0,p.css({coordsize:d[0]+h+" "+d[1]+h,antialias:""+(g.string().indexOf(F)>-1),left:c[0]-c[2]*Number(a===A),top:c[1]-c[2]*Number(a===O),width:d[0]+h,height:d[1]+h}).each(function(e){var t=s(this);t[t.prop?"prop":"attr"]({coordsize:d[0]+h+" "+d[1]+h,path:n,fillcolor:o[0],filled:!!e,stroked:!e}).toggle(!(!h&&!e)),!e&&t.html(le("stroke",'weight="'+2*h+'px" color="'+o[1]+'" miterlimit="1000" joinstyle="miter"'))})),e.opera&&setTimeout(function(){m.tip.css({display:"inline-block",visibility:"visible"})},1),i!==D&&this.calculate(t,d)},calculate:function(e,t){if(!this.enabled)return D;var i,o,a=this,r=this.qtip.elements,n=this.element,l=this.options.offset,c={};return e=e||this.corner,i=e.precedance,t=t||this._calculateSize(e),o=[e.x,e.y],i===A&&o.reverse(),s.each(o,function(s,o){var n,d,h;o===F?(n=i===O?N:z,c[n]="50%",c[me+"-"+n]=-Math.round(t[i===O?0:1]/2)+l):(n=a._parseWidth(e,o,r.tooltip),d=a._parseWidth(e,o,r.content),h=a._parseRadius(e),c[o]=Math.max(-a.border,s?d:l+(h>n?h:-n)))}),c[e[i]]-=t[i===A?0:1],n.css({margin:"",top:"",bottom:"",left:"",right:""}).css(c),c},reposition:function(e,t,s){function o(e,t,i,s,o){e===q&&c.precedance===t&&d[s]&&c[i]!==F?c.precedance=c.precedance===A?O:A:e!==q&&d[s]&&(c[t]=c[t]===F?d[s]>0?s:o:c[t]===s?o:s)}function a(e,t,o){c[e]===F?_[me+"-"+t]=p[e]=r[me+"-"+t]-d[t]:(n=r[o]!==i?[d[t],-r[t]]:[-d[t],r[t]],(p[e]=Math.max(n[0],n[1]))>n[0]&&(s[t]-=d[t],p[t]=D),_[r[o]!==i?o:t]=p[e])}if(this.enabled){var r,n,l=t.cache,c=this.corner.clone(),d=s.adjusted,h=t.options.position.adjust.method.split(" "),m=h[0],u=h[1]||h[0],p={left:D,top:D,x:0,y:0},_={};this.corner.fixed!==M&&(o(m,A,O,N,E),o(u,O,A,z,L),c.string()===l.corner.string()&&l.cornerTop===d.top&&l.cornerLeft===d.left||this.update(c,D)),r=this.calculate(c),r.right!==i&&(r.left=-r.right),r.bottom!==i&&(r.top=-r.bottom),r.user=this.offset,p.left=m===q&&!!d.left,p.left&&a(A,N,E),p.top=u===q&&!!d.top,p.top&&a(O,z,L),this.element.css(_).toggle(!(p.x&&p.y||c.x===F&&p.y||c.y===F&&p.x)),s.left-=r.left.charAt?r.user:m!==q||p.top||!p.left&&!p.top?r.left+this.border:0,s.top-=r.top.charAt?r.user:u!==q||p.left||!p.left&&!p.top?r.top+this.border:0,l.cornerLeft=d.left,l.cornerTop=d.top,l.corner=c.clone()}},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),ne=R.tip=function(e){return new C(e,e.options.style.tip)},ne.initialize="render",ne.sanitize=function(e){if(e.style&&"tip"in e.style){var t=e.style.tip;"object"!=typeof t&&(t=e.style.tip={corner:t}),/string|boolean/i.test(typeof t.corner)||(t.corner=M)}},j.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(e){this.size=[e.width,e.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},s.extend(M,x.defaults,{style:{tip:{corner:M,mimic:D,width:6,height:6,border:M,offset:0}}});var ke,we,xe="qtip-modal",$e="."+xe;we=function(){function e(e){if(s.expr[":"].focusable)return s.expr[":"].focusable;var t,i,o,a=!isNaN(s.attr(e,"tabindex")),r=e.nodeName&&e.nodeName.toLowerCase();return"area"===r?(t=e.parentNode,i=t.name,!(!e.href||!i||"map"!==t.nodeName.toLowerCase())&&(!!(o=s("img[usemap=#"+i+"]")[0])&&o.is(":visible"))):/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r?e.href||a:a}function i(e){c.length<1&&e.length?e.not("body").blur():c.first().focus()}function o(e){if(n.is(":visible")){var t=s(e.target),o=a.tooltip,r=t.closest(Y);(r.length<1?D:parseInt(r[0].style.zIndex,10)>parseInt(o[0].style.zIndex,10))||t.closest(Y)[0]===o[0]||i(t)}}var a,r,n,l=this,c={};s.extend(l,{init:function(){return n=l.elem=s("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return D}}).hide(),s(t.body).bind("focusin"+$e,o),s(t).bind("keydown"+$e,function(e){a&&a.options.show.modal.escape&&27===e.keyCode&&a.hide(e)}),n.bind("click"+$e,function(e){a&&a.options.show.modal.blur&&a.hide(e)}),l},update:function(t){a=t,c=t.options.show.modal.stealfocus!==D?t.tooltip.find("*").filter(function(){return e(this)}):[]},toggle:function(e,o,c){var d=e.tooltip,h=e.options.show.modal,m=h.effect,u=o?"show":"hide",p=n.is(":visible"),_=s($e).filter(":visible:not(:animated)").not(d);return l.update(e),o&&h.stealfocus!==D&&i(s(":focus")),n.toggleClass("blurs",h.blur),o&&n.appendTo(t.body),n.is(":animated")&&p===o&&r!==D||!o&&_.length?l:(n.stop(M,D),s.isFunction(m)?m.call(n,o):m===D?n[u]():n.fadeTo(parseInt(c,10)||90,o?1:0,function(){o||n.hide()}),o||n.queue(function(e){n.css({left:"",top:""}),s($e).length||n.detach(),e()}),r=o,a.destroyed&&(a=S),l)}}),l.init()},we=new we,s.extend(k.prototype,{init:function(e){var t=e.tooltip;return this.options.on?(e.elements.overlay=we.elem,t.addClass(xe).css("z-index",x.modal_zindex+s($e).length),e._bind(t,["tooltipshow","tooltiphide"],function(e,i,o){var a=e.originalEvent;if(e.target===t[0])if(a&&"tooltiphide"===e.type&&/mouse(leave|enter)/.test(a.type)&&s(a.relatedTarget).closest(we.elem[0]).length)try{e.preventDefault()}catch(e){}else(!a||a&&"tooltipsolo"!==a.type)&&this.toggle(e,"tooltipshow"===e.type,o)},this._ns,this),e._bind(t,"tooltipfocus",function(e,i){if(!e.isDefaultPrevented()&&e.target===t[0]){var o=s($e),a=x.modal_zindex+o.length,r=parseInt(t[0].style.zIndex,10);we.elem[0].style.zIndex=a-1,o.each(function(){this.style.zIndex>r&&(this.style.zIndex-=1)}),o.filter("."+X).qtip("blur",e.originalEvent),t.addClass(X)[0].style.zIndex=a,we.update(i);try{e.preventDefault()}catch(e){}}},this._ns,this),void e._bind(t,"tooltiphide",function(e){e.target===t[0]&&s($e).filter(":visible").not(t).last().qtip("focus",e)},this._ns,this)):this},toggle:function(e,t,i){return e&&e.isDefaultPrevented()?this:void we.toggle(this.qtip,!!t,i)},destroy:function(){this.qtip.tooltip.removeClass(xe),this.qtip._unbind(this.qtip.tooltip,this._ns),we.toggle(this.qtip,D),delete this.qtip.elements.overlay}}),ke=R.modal=function(e){return new k(e,e.options.show.modal)},ke.sanitize=function(e){e.show&&("object"!=typeof e.show.modal?e.show.modal={on:!!e.show.modal}:void 0===e.show.modal.on&&(e.show.modal.on=M))},x.modal_zindex=x.zindex-200,ke.initialize="render",j.modal={"^show.modal.(on|blur)$":function(){this.destroy(),this.init(),this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}},s.extend(M,x.defaults,{show:{modal:{on:D,effect:M,blur:M,stealfocus:M,escape:M}}}),R.viewport=function(i,s,o,a,r,n,l){function c(e,t,i,o,a,r,n,l,c){var d=s[a],v=b[e],y=C[e],k=i===q,w=v===a?c:v===r?-c:-c/2,x=y===a?l:y===r?-l:-l/2,$=f[a]+g[a]-(u?0:m[a]),T=$-d,j=d+c-(n===P?p:_)-$,I=w-(b.precedance===e||v===b[t]?x:0)-(y===F?l/2:0);return k?(I=(v===a?1:-1)*w,s[a]+=T>0?T:j>0?-j:0,s[a]=Math.max(-m[a]+g[a],d-I,Math.min(Math.max(-m[a]+g[a]+(n===P?p:_),d+I),s[a],"center"===v?d-w:1e9))):(o*=i===U?2:0,T>0&&(v!==a||j>0)?(s[a]-=I+o,h.invert(e,a)):j>0&&(v!==r||T>0)&&(s[a]-=(v===F?-I:I)+o,h.invert(e,r)),s[a]<f[a]&&-s[a]>j&&(s[a]=d,h=b.clone())),s[a]-d}var d,h,m,u,p,_,f,g,v=o.target,y=i.elements.tooltip,b=o.my,C=o.at,k=o.adjust,w=k.method.split(" "),x=w[0],$=w[1]||w[0],T=o.viewport,j=o.container,I={left:0,top:0};return T.jquery&&v[0]!==e&&v[0]!==t.body&&"none"!==k.method?(m=j.offset()||I,u="static"===j.css("position"),d="fixed"===y.css("position"),p=T[0]===e?T.width():T.outerWidth(D),_=T[0]===e?T.height():T.outerHeight(D),f={left:d?0:T.scrollLeft(),top:d?0:T.scrollTop()},g=T.offset()||I,"shift"===x&&"shift"===$||(h=b.clone()),I={left:"none"!==x?c(A,O,x,k.x,N,E,P,a,n):0,top:"none"!==$?c(O,A,$,k.y,z,L,H,r,l):0,my:h}):I},R.polys={polygon:function(e,t){var i,s,o,a={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:D},r=0,n=[],l=1,c=1,d=0,h=0;for(r=e.length;r--;)i=[parseInt(e[--r],10),parseInt(e[r+1],10)],i[0]>a.position.right&&(a.position.right=i[0]),i[0]<a.position.left&&(a.position.left=i[0]),i[1]>a.position.bottom&&(a.position.bottom=i[1]),i[1]<a.position.top&&(a.position.top=i[1]),n.push(i);if(s=a.width=Math.abs(a.position.right-a.position.left),o=a.height=Math.abs(a.position.bottom-a.position.top),"c"===t.abbrev())a.position={left:a.position.left+a.width/2,top:a.position.top+a.height/2};else{for(;s>0&&o>0&&l>0&&c>0;)for(s=Math.floor(s/2),o=Math.floor(o/2),t.x===N?l=s:t.x===E?l=a.width-s:l+=Math.floor(s/2),t.y===z?c=o:t.y===L?c=a.height-o:c+=Math.floor(o/2),r=n.length;r--&&!(n.length<2);)d=n[r][0]-a.position.left,h=n[r][1]-a.position.top,(t.x===N&&d>=l||t.x===E&&l>=d||t.x===F&&(l>d||d>a.width-l)||t.y===z&&h>=c||t.y===L&&c>=h||t.y===F&&(c>h||h>a.height-c))&&n.splice(r,1);a.position={left:n[0][0],top:n[0][1]}}return a},rect:function(e,t,i,s){return{width:Math.abs(i-e),height:Math.abs(s-t),position:{left:Math.min(e,i),top:Math.min(t,s)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(e,t,i,s,o){var a=R.polys._angles[o.abbrev()],r=0===a?0:i*Math.cos(a*Math.PI),n=s*Math.sin(a*Math.PI);return{width:2*i-Math.abs(r),height:2*s-Math.abs(n),position:{left:e+r,top:t+n},adjustable:D}},circle:function(e,t,i,s){return R.polys.ellipse(e,t,i,i,s)}},R.svg=function(e,i,o){for(var a,r,n,l,c,d,h,m,u,p=i[0],_=s(p.ownerSVGElement),f=p.ownerDocument,g=(parseInt(i.css("stroke-width"),10)||0)/2;!p.getBBox;)p=p.parentNode;if(!p.getBBox||!p.parentNode)return D;switch(p.nodeName){case"ellipse":case"circle":m=R.polys.ellipse(p.cx.baseVal.value,p.cy.baseVal.value,(p.rx||p.r).baseVal.value+g,(p.ry||p.r).baseVal.value+g,o);break;case"line":case"polygon":case"polyline":for(h=p.points||[{x:p.x1.baseVal.value,y:p.y1.baseVal.value},{x:p.x2.baseVal.value,y:p.y2.baseVal.value}],m=[],d=-1,l=h.numberOfItems||h.length;++d<l;)c=h.getItem?h.getItem(d):h[d],m.push.apply(m,[c.x,c.y]);m=R.polys.polygon(m,o);break;default:m=p.getBBox(),m={width:m.width,height:m.height,position:{left:m.x,top:m.y}}}return u=m.position,_=_[0],_.createSVGPoint&&(r=p.getScreenCTM(),h=_.createSVGPoint(),h.x=u.left,h.y=u.top,n=h.matrixTransform(r),u.left=n.x,u.top=n.y),f!==t&&"mouse"!==e.position.target&&(a=s((f.defaultView||f.parentWindow).frameElement).offset())&&(u.left+=a.left,u.top+=a.top),f=s(f),u.left+=f.scrollLeft(),u.top+=f.scrollTop(),m},R.imagemap=function(e,t,i){t.jquery||(t=s(t));var o,a,r,n,l,c=(t.attr("shape")||"rect").toLowerCase().replace("poly","polygon"),d=s('img[usemap="#'+t.parent("map").attr("name")+'"]'),h=s.trim(t.attr("coords")),m=h.replace(/,$/,"").split(",");if(!d.length)return D;if("polygon"===c)n=R.polys.polygon(m,i);else{if(!R.polys[c])return D;for(r=-1,l=m.length,a=[];++r<l;)a.push(parseInt(m[r],10));n=R.polys[c].apply(this,a.concat(i))}return o=d.offset(),o.left+=Math.ceil((d.outerWidth(D)-d.width())/2),o.top+=Math.ceil((d.outerHeight(D)-d.height())/2),n.position.left+=o.left,n.position.top+=o.top,n};var Te;s.extend(w.prototype,{_scroll:function(){var t=this.qtip.elements.overlay;t&&(t[0].style.top=s(e).scrollTop()+"px")},init:function(i){var o=i.tooltip;s("select, object").length<1&&(this.bgiframe=i.elements.bgiframe=s('<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>').appendTo(o),i._bind(o,"tooltipmove",this.adjustBGIFrame,this._ns,this)),this.redrawContainer=s("<div/>",{id:V+"-rcontainer"}).appendTo(t.body),i.elements.overlay&&i.elements.overlay.addClass("qtipmodal-ie6fix")&&(i._bind(e,["scroll","resize"],this._scroll,this._ns,this),i._bind(o,["tooltipshow"],this._scroll,this._ns,this)),this.redraw()},adjustBGIFrame:function(){var e,t,i=this.qtip.tooltip,s={height:i.outerHeight(D),width:i.outerWidth(D)},o=this.qtip.plugins.tip,a=this.qtip.elements.tip;t=parseInt(i.css("borderLeftWidth"),10)||0,t={left:-t,top:-t},o&&a&&(e="x"===o.corner.precedance?[P,N]:[H,z],t[e[1]]-=a[e[0]]()),this.bgiframe.css(t).css(s)},redraw:function(){if(this.qtip.rendered<1||this.drawing)return this;var e,t,i,s,o=this.qtip.tooltip,a=this.qtip.options.style,r=this.qtip.options.position.container;return this.qtip.drawing=1,a.height&&o.css(H,a.height),a.width?o.css(P,a.width):(o.css(P,"").appendTo(this.redrawContainer),t=o.width(),1>t%2&&(t+=1),i=o.css("maxWidth")||"",s=o.css("minWidth")||"",e=(i+s).indexOf("%")>-1?r.width()/100:0,i=(i.indexOf("%")>-1?e:1*parseInt(i,10))||t,s=(s.indexOf("%")>-1?e:1*parseInt(s,10))||0,t=i+s?Math.min(Math.max(t,s),i):t,o.css(P,Math.round(t)).appendTo(r)),this.drawing=0,this},destroy:function(){this.bgiframe&&this.bgiframe.remove(),this.qtip._unbind([e,this.qtip.tooltip],this._ns)}}),Te=R.ie6=function(e){return 6===se.ie?new w(e):D},Te.initialize="render",j.ie6={"^content|style$":function(){this.redraw()}}})}(window,document),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e,t){function i(){return new Date(Date.UTC.apply(Date,arguments))}"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,i){i===t&&(i=0),i<0&&(i+=this.length),i<0&&(i=0);for(var s=this.length;i<s;i++)if(i in this&&this[i]===e)return i;return-1});var s=function(i,s){var o=this;this.element=e(i),this.container=s.container||"body",this.language=s.language||this.element.data("date-language")||"en",this.language=this.language in a?this.language:this.language.split("-")[0],this.language=this.language in a?this.language:"en",this.isRTL=a[this.language].rtl||!1,this.formatType=s.formatType||this.element.data("format-type")||"standard",this.format=r.parseFormat(s.format||this.element.data("date-format")||a[this.language].format||r.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=s.fontAwesome||this.element.data("font-awesome")||!1,this.bootcssVer=s.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=!!this.element.is(".date")&&(3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-remove, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar, .add-on .fa-calendar, .add-on .fa-clock-o").parent()),this.componentReset=!!this.element.is(".date")&&(3==this.bootcssVer?this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent()),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.linkField=s.linkField||this.element.data("link-field")||!1,this.linkFormat=r.parseFormat(s.linkFormat||this.element.data("link-format")||r.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=s.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=s.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=s.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=s.initialDate||new Date,this.zIndex=s.zIndex||this.element.data("z-index")||t,this.title=void 0!==s.title&&s.title,this.defaultTimeZone=(new Date).toString().split("(")[1].slice(0,-1),this.timezone=s.timezone||this.defaultTimeZone,this.icons={leftArrow:this.fontAwesome?"fa-arrow-left":3===this.bootcssVer?"glyphicon-arrow-left":"icon-arrow-left",rightArrow:this.fontAwesome?"fa-arrow-right":3===this.bootcssVer?"glyphicon-arrow-right":"icon-arrow-right"},this.icontype=this.fontAwesome?"fa":"glyphicon",this._attachEvents(),this.clickedOutside=function(t){0===e(t.target).closest(".datetimepicker").length&&o.hide()},this.formatViewType="datetime","formatViewType"in s?this.formatViewType=s.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in s?this.minView=s.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=r.convertViewMode(this.minView),this.maxView=r.modes.length-1,"maxView"in s?this.maxView=s.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=r.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in s?this.wheelViewModeNavigation=s.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in s?this.wheelViewModeNavigationInverseDirection=s.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in s?this.wheelViewModeNavigationDelay=s.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in s?this.startViewMode=s.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=r.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in s?this.viewSelect=s.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=r.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in s?this.forceParse=s.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));for(var n=3===this.bootcssVer?r.templateV3:r.template;-1!==n.indexOf("{iconType}");)n=n.replace("{iconType}",this.icontype);for(;-1!==n.indexOf("{leftArrow}");)n=n.replace("{leftArrow}",this.icons.leftArrow);for(;-1!==n.indexOf("{rightArrow}");)n=n.replace("{rightArrow}",this.icons.rightArrow);if(this.picker=e(n).appendTo(this.isInline?this.element:this.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(e.fn.mousewheel?this.picker.on({mousewheel:e.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu"),this.isRTL){this.picker.addClass("datetimepicker-rtl");var l=3===this.bootcssVer?".prev span, .next span":".prev i, .next i";this.picker.find(l).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}e(document).on("mousedown",this.clickedOutside),this.autoclose=!1,"autoclose"in s?this.autoclose=s.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in s?this.keyboardNavigation=s.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=s.todayBtn||this.element.data("date-today-btn")||!1,this.clearBtn=s.clearBtn||this.element.data("date-clear-btn")||!1,this.todayHighlight=s.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=(s.weekStart||this.element.data("date-weekstart")||a[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-1/0,this.endDate=1/0,this.datesDisabled=[],this.daysOfWeekDisabled=[],this.setStartDate(s.startDate||this.element.data("date-startdate")),this.setEndDate(s.endDate||this.element.data("date-enddate")),this.setDatesDisabled(s.datesDisabled||this.element.data("date-dates-disabled")),this.setDaysOfWeekDisabled(s.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(s.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(s.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};s.prototype={constructor:s,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:e.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]];for(var t,i,s=0;s<this._events.length;s++)t=this._events[s][0],i=this._events[s][1],t.on(i)},_detachEvents:function(){for(var e,t,i=0;i<this._events.length;i++)e=this._events[i][0],t=this._events[i][1],e.off(t);this._events=[]},show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(t){this.isVisible&&(this.isInline||(this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),e(document).off("mousedown",this.clickedOutside),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},getInitialDate:function(){return this.initialDate},setInitialDate:function(e){this.initialDate=e},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){this.format=r.parseFormat(e,this.formatType);var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t):(this.component&&this.element.find("input").val(t),this.element.data("date",t)),this.linkField&&e("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return e==t&&(e=this.format),r.formatDate(this.date,e,this.language,this.formatType,this.timezone)},setStartDate:function(e){this.startDate=e||-1/0,this.startDate!==-1/0&&(this.startDate=r.parseDate(this.startDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||1/0,this.endDate!==1/0&&(this.endDate=r.parseDate(this.endDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setDatesDisabled:function(t){this.datesDisabled=t||[],e.isArray(this.datesDisabled)||(this.datesDisabled=this.datesDisabled.split(/,\s*/)),this.datesDisabled=e.map(this.datesDisabled,function(e){return r.parseDate(e,this.format,this.language,this.formatType,this.timezone).toDateString()}),this.update(),this.updateNavArrows()},setTitle:function(e,t){return this.picker.find(e).find("th:eq(1)").text(!1===this.title?t:this.title)},setDaysOfWeekDisabled:function(t){this.daysOfWeekDisabled=t||[],e.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=e.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(t){
this.minutesDisabled=t||[],e.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=e.map(this.minutesDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(t){this.hoursDisabled=t||[],e.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=e.map(this.hoursDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){if(!this.zIndex){var t=0;e("div").each(function(){var i=parseInt(e(this).css("zIndex"),10);i>t&&(t=i)}),this.zIndex=t+10}var i,s,o,a;a=this.container instanceof e?this.container.offset():e(this.container).offset(),this.component?(i=this.component.offset(),o=i.left,"bottom-left"!=this.pickerPosition&&"top-left"!=this.pickerPosition||(o+=this.component.outerWidth()-this.picker.outerWidth())):(i=this.element.offset(),o=i.left,"bottom-left"!=this.pickerPosition&&"top-left"!=this.pickerPosition||(o+=this.element.outerWidth()-this.picker.outerWidth()));var r=document.body.clientWidth||window.innerWidth;o+220>r&&(o=r-220),s="top-left"==this.pickerPosition||"top-right"==this.pickerPosition?i.top-this.picker.outerHeight():i.top+this.height,s-=a.top,o-=a.left,this.picker.css({top:s,left:o,zIndex:this.zIndex})}},update:function(){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):("string"==typeof(e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate)||e instanceof String)&&(e=e.replace(/^\s+|\s+$/g,"")),e||(e=new Date,t=!1),this.date=r.parseDate(e,this.format,this.language,this.formatType,this.timezone),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+a[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+a[this.language].monthsShort[t++]+"</span>";this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(null!=this.date&&null!=this.viewDate){var t=new Date(this.viewDate),s=t.getUTCFullYear(),o=t.getUTCMonth(),n=t.getUTCDate(),l=t.getUTCHours(),c=t.getUTCMinutes(),d=this.startDate!==-1/0?this.startDate.getUTCFullYear():-1/0,h=this.startDate!==-1/0?this.startDate.getUTCMonth():-1/0,m=this.endDate!==1/0?this.endDate.getUTCFullYear():1/0,u=this.endDate!==1/0?this.endDate.getUTCMonth()+1:1/0,p=new i(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),_=new Date;if(this.setTitle(".datetimepicker-days",a[this.language].months[o]+" "+s),"time"==this.formatViewType){var f=this.getFormattedDate();this.setTitle(".datetimepicker-hours",f),this.setTitle(".datetimepicker-minutes",f)}else this.setTitle(".datetimepicker-hours",n+" "+a[this.language].months[o]+" "+s),this.setTitle(".datetimepicker-minutes",n+" "+a[this.language].months[o]+" "+s);this.picker.find("tfoot th.today").text(a[this.language].today||a.en.today).toggle(!1!==this.todayBtn),this.picker.find("tfoot th.clear").text(a[this.language].clear||a.en.clear).toggle(!1!==this.clearBtn),this.updateNavArrows(),this.fillMonths();var g=i(s,o-1,28,0,0,0,0),v=r.getDaysInMonth(g.getUTCFullYear(),g.getUTCMonth());g.setUTCDate(v),g.setUTCDate(v-(g.getUTCDay()-this.weekStart+7)%7);var y=new Date(g);y.setUTCDate(y.getUTCDate()+42),y=y.valueOf();for(var b,C=[];g.valueOf()<y;)g.getUTCDay()==this.weekStart&&C.push("<tr>"),b="",g.getUTCFullYear()<s||g.getUTCFullYear()==s&&g.getUTCMonth()<o?b+=" old":(g.getUTCFullYear()>s||g.getUTCFullYear()==s&&g.getUTCMonth()>o)&&(b+=" new"),this.todayHighlight&&g.getUTCFullYear()==_.getFullYear()&&g.getUTCMonth()==_.getMonth()&&g.getUTCDate()==_.getDate()&&(b+=" today"),g.valueOf()==p&&(b+=" active"),(g.valueOf()+864e5<=this.startDate||g.valueOf()>this.endDate||-1!==e.inArray(g.getUTCDay(),this.daysOfWeekDisabled)||-1!==e.inArray(g.toDateString(),this.datesDisabled))&&(b+=" disabled"),C.push('<td class="day'+b+'">'+g.getUTCDate()+"</td>"),g.getUTCDay()==this.weekEnd&&C.push("</tr>"),g.setUTCDate(g.getUTCDate()+1);this.picker.find(".datetimepicker-days tbody").empty().append(C.join("")),C=[];for(var k="",w="",x="",$=this.hoursDisabled||[],T=0;T<24;T++)if(-1===$.indexOf(T)){var j=i(s,o,n,T);b="",j.valueOf()+36e5<=this.startDate||j.valueOf()>this.endDate?b+=" disabled":l==T&&(b+=" active"),this.showMeridian&&2==a[this.language].meridiem.length?(w=T<12?a[this.language].meridiem[0]:a[this.language].meridiem[1],w!=x&&(""!=x&&C.push("</fieldset>"),C.push('<fieldset class="hour"><legend>'+w.toUpperCase()+"</legend>")),x=w,k=T%12?T%12:12,C.push('<span class="hour'+b+" hour_"+(T<12?"am":"pm")+'">'+k+"</span>"),23==T&&C.push("</fieldset>")):(k=T+":00",C.push('<span class="hour'+b+'">'+k+"</span>"))}this.picker.find(".datetimepicker-hours td").html(C.join("")),C=[],k="",w="",x="";for(var I=this.minutesDisabled||[],T=0;T<60;T+=this.minuteStep)if(-1===I.indexOf(T)){var j=i(s,o,n,l,T,0);b="",j.valueOf()<this.startDate||j.valueOf()>this.endDate?b+=" disabled":Math.floor(c/this.minuteStep)==Math.floor(T/this.minuteStep)&&(b+=" active"),this.showMeridian&&2==a[this.language].meridiem.length?(w=l<12?a[this.language].meridiem[0]:a[this.language].meridiem[1],w!=x&&(""!=x&&C.push("</fieldset>"),C.push('<fieldset class="minute"><legend>'+w.toUpperCase()+"</legend>")),x=w,k=l%12?l%12:12,C.push('<span class="minute'+b+'">'+k+":"+(T<10?"0"+T:T)+"</span>"),59==T&&C.push("</fieldset>")):(k=T+":00",C.push('<span class="minute'+b+'">'+l+":"+(T<10?"0"+T:T)+"</span>"))}this.picker.find(".datetimepicker-minutes td").html(C.join(""));var M=this.date.getUTCFullYear(),D=this.setTitle(".datetimepicker-months",s).end().find("span").removeClass("active");if(M==s){var S=D.length-12;D.eq(this.date.getUTCMonth()+S).addClass("active")}(s<d||s>m)&&D.addClass("disabled"),s==d&&D.slice(0,h).addClass("disabled"),s==m&&D.slice(u).addClass("disabled"),C="",s=10*parseInt(s/10,10);var A=this.setTitle(".datetimepicker-years",s+"-"+(s+9)).end().find("td");s-=1;for(var T=-1;T<11;T++)C+='<span class="year'+(-1==T||10==T?" old":"")+(M==s?" active":"")+(s<d||s>m?" disabled":"")+'">'+s+"</span>",s+=1;A.html(C),this.place()}},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth(),s=e.getUTCDate(),o=e.getUTCHours();switch(this.viewMode){case 0:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&s<=this.startDate.getUTCDate()&&o<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&s>=this.endDate.getUTCDate()&&o>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&s<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&s>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(t){if(t.preventDefault(),t.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var i=t.originalEvent,s=i.wheelDelta,o=s>0?1:0===s?0:-1;this.wheelViewModeNavigationInverseDirection&&(o=-o),this.showMode(o),setTimeout(e.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(t){t.stopPropagation(),t.preventDefault();var s=e(t.target).closest("span, td, th, legend");if(s.is("."+this.icontype)&&(s=e(s).parent().closest("span, td, th, legend")),1==s.length){if(s.is(".disabled"))return void this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var o=r.modes[this.viewMode].navStep*("prev"==s[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,o);break;case 1:this.viewDate=this.moveDate(this.viewDate,o);break;case 2:this.viewDate=this.moveMonth(this.viewDate,o);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,o)}this.fill(),this.element.trigger({type:s[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"clear":this.reset(),this.autoclose&&this.hide();break;case"today":var a=new Date;a=i(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),0),a<this.startDate?a=this.startDate:a>this.endDate&&(a=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(a),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!s.is(".disabled")){var n=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),c=this.viewDate.getUTCDate(),d=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),m=this.viewDate.getUTCSeconds();if(s.is(".month")?(this.viewDate.setUTCDate(1),l=s.parent().find("span").index(s),c=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(l),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(i(n,l,c,d,h,m,0))):s.is(".year")?(this.viewDate.setUTCDate(1),n=parseInt(s.text(),10)||0,this.viewDate.setUTCFullYear(n),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(i(n,l,c,d,h,m,0))):s.is(".hour")?(d=parseInt(s.text(),10)||0,(s.hasClass("hour_am")||s.hasClass("hour_pm"))&&(12==d&&s.hasClass("hour_am")?d=0:12!=d&&s.hasClass("hour_pm")&&(d+=12)),this.viewDate.setUTCHours(d),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(i(n,l,c,d,h,m,0))):s.is(".minute")&&(h=parseInt(s.text().substr(s.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(h),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(i(n,l,c,d,h,m,0))),0!=this.viewMode){var u=this.viewMode;this.showMode(-1),this.fill(),u==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(s.is(".day")&&!s.is(".disabled")){var c=parseInt(s.text(),10)||1,n=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),d=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),m=this.viewDate.getUTCSeconds();s.is(".old")?0===l?(l=11,n-=1):l-=1:s.is(".new")&&(11==l?(l=0,n+=1):l+=1),this.viewDate.setUTCFullYear(n),this.viewDate.setUTCMonth(l,c),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(i(n,l,c,d,h,m,0))}var u=this.viewMode;this.showMode(-1),this.fill(),u==this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(e,t){t&&"date"!=t||(this.date=e),t&&"view"!=t||(this.viewDate=e),this.fill(),this.setValue();var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),this.autoclose),this.element.trigger({type:"changeDate",date:this.getDate()}),null==e&&(this.date=this.viewDate)},moveMinute:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCMinutes(i.getUTCMinutes()+t*this.minuteStep),i},moveHour:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCHours(i.getUTCHours()+t),i},moveDate:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCDate(i.getUTCDate()+t),i},moveMonth:function(e,t){if(!t)return e;var i,s,o=new Date(e.valueOf()),a=o.getUTCDate(),r=o.getUTCMonth(),n=Math.abs(t);if(t=t>0?1:-1,1==n)s=-1==t?function(){return o.getUTCMonth()==r}:function(){return o.getUTCMonth()!=i},i=r+t,o.setUTCMonth(i),(i<0||i>11)&&(i=(i+12)%12);else{for(var l=0;l<n;l++)o=this.moveMonth(o,t);i=o.getUTCMonth(),o.setUTCDate(a),s=function(){return i!=o.getUTCMonth()}}for(;s();)o.setUTCDate(--a),o.setUTCMonth(i);return o},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27==e.keyCode&&this.show());var t,i,s,o=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;t=37==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),s=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),s=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,t),s=this.moveDate(this.viewDate,t)):1==viewMode?(i=this.moveHour(this.date,t),s=this.moveHour(this.viewDate,t)):0==viewMode&&(i=this.moveMinute(this.date,t),s=this.moveMinute(this.viewDate,t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=s,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;t=38==e.keyCode?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),s=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),s=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,7*t),s=this.moveDate(this.viewDate,7*t)):1==viewMode?this.showMeridian?(i=this.moveHour(this.date,6*t),s=this.moveHour(this.viewDate,6*t)):(i=this.moveHour(this.date,4*t),s=this.moveHour(this.viewDate,4*t)):0==viewMode&&(i=this.moveMinute(this.date,4*t),s=this.moveMinute(this.viewDate,4*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=s,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 13:if(0!=this.viewMode){var a=this.viewMode;this.showMode(-1),this.fill(),a==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(o){var r;this.isInput?r=this.element:this.component&&(r=this.element.find("input")),r&&r.change(),this.element.trigger({type:"changeDate",date:this.getDate()})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(r.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+r.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(e){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var o=e.fn.datetimepicker;e.fn.datetimepicker=function(i){var o=Array.apply(null,arguments);o.shift();var a;return this.each(function(){var r=e(this),n=r.data("datetimepicker"),l="object"==typeof i&&i;if(n||r.data("datetimepicker",n=new s(this,e.extend({},e.fn.datetimepicker.defaults,l))),"string"==typeof i&&"function"==typeof n[i]&&(a=n[i].apply(n,o))!==t)return!1}),a!==t?a:this},e.fn.datetimepicker.defaults={},e.fn.datetimepicker.Constructor=s;var a=e.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today",clear:"Clear"}},r={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,r.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if("standard"==e)return"input"==t?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"==e)return"input"==t?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if("standard"==e)return/t|hh?|HH?|p|P|z|Z|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"==e)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var i=e.replace(this.validParts(t),"\0").split("\0"),s=e.match(this.validParts(t));if(!i||!i.length||!s||0==s.length)throw new Error("Invalid date format.");return{separators:i,parts:s}},parseDate:function(t,o,r,n,l){if(t instanceof Date){var c=new Date(t.valueOf()-6e4*t.getTimezoneOffset());return c.setMilliseconds(0),c}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(t)&&(o=this.parseFormat("yyyy-mm-dd",n)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(t)&&(o=this.parseFormat("yyyy-mm-dd hh:ii",n)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(t)&&(o=this.parseFormat("yyyy-mm-dd hh:ii:ss",n)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(t)){var d,h,m=/([-+]\d+)([dmwy])/,u=t.match(/([-+]\d+)([dmwy])/g);t=new Date;for(var p=0;p<u.length;p++)switch(d=m.exec(u[p]),h=parseInt(d[1]),d[2]){case"d":t.setUTCDate(t.getUTCDate()+h);break;case"m":t=s.prototype.moveMonth.call(s.prototype,t,h);break;case"w":t.setUTCDate(t.getUTCDate()+7*h);break;case"y":t=s.prototype.moveYear.call(s.prototype,t,h)}return i(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),0)}var _,f,d,u=t&&t.toString().match(this.nonpunctuation)||[],t=new Date(0,0,0,0,0,0,0),g={},v=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P","z","Z"],y={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(12==t?0:t)},H:function(e,t){return e.setUTCHours(12==t?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(1==t?e.getUTCHours()+12:e.getUTCHours())},z:function(){return l}};if(y.M=y.MM=y.mm=y.m,y.dd=y.d,y.P=y.p,y.Z=y.z,t=i(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),u.length==o.parts.length){for(var p=0,b=o.parts.length;p<b;p++){if(_=parseInt(u[p],10),d=o.parts[p],isNaN(_))switch(d){case"MM":f=e(a[r].months).filter(function(){var e=this.slice(0,u[p].length);return e==u[p].slice(0,e.length)}),_=e.inArray(f[0],a[r].months)+1;break;case"M":f=e(a[r].monthsShort).filter(function(){var e=this.slice(0,u[p].length),t=u[p].slice(0,e.length);return e.toLowerCase()==t.toLowerCase()}),_=e.inArray(f[0],a[r].monthsShort)+1;break;case"p":case"P":_=e.inArray(u[p].toLowerCase(),a[r].meridiem)}g[d]=_}for(var C,p=0;p<v.length;p++)(C=v[p])in g&&!isNaN(g[C])&&y[C](t,g[C])}return t},formatDate:function(t,i,s,o,n){if(null==t)return"";var l;if("standard"==o)l={t:t.getTime(),yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear(),m:t.getUTCMonth()+1,M:a[s].monthsShort[t.getUTCMonth()],MM:a[s].months[t.getUTCMonth()],d:t.getUTCDate(),D:a[s].daysShort[t.getUTCDay()],DD:a[s].days[t.getUTCDay()],p:2==a[s].meridiem.length?a[s].meridiem[t.getUTCHours()<12?0:1]:"",h:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds(),z:n},2==a[s].meridiem.length?l.H=l.h%12==0?12:l.h%12:l.H=l.h,l.HH=(l.H<10?"0":"")+l.H,l.P=l.p.toUpperCase(),l.Z=l.z,l.hh=(l.h<10?"0":"")+l.h,l.ii=(l.i<10?"0":"")+l.i,l.ss=(l.s<10?"0":"")+l.s,l.dd=(l.d<10?"0":"")+l.d,l.mm=(l.m<10?"0":"")+l.m;else{if("php"!=o)throw new Error("Invalid format type.");l={y:t.getUTCFullYear().toString().substring(2),Y:t.getUTCFullYear(),F:a[s].months[t.getUTCMonth()],M:a[s].monthsShort[t.getUTCMonth()],n:t.getUTCMonth()+1,t:r.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()),j:t.getUTCDate(),l:a[s].days[t.getUTCDay()],D:a[s].daysShort[t.getUTCDay()],w:t.getUTCDay(),N:0==t.getUTCDay()?7:t.getUTCDay(),S:t.getUTCDate()%10<=a[s].suffix.length?a[s].suffix[t.getUTCDate()%10-1]:"",a:2==a[s].meridiem.length?a[s].meridiem[t.getUTCHours()<12?0:1]:"",g:t.getUTCHours()%12==0?12:t.getUTCHours()%12,G:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},l.m=(l.n<10?"0":"")+l.n,l.d=(l.j<10?"0":"")+l.j,l.A=l.a.toString().toUpperCase(),l.h=(l.g<10?"0":"")+l.g,l.H=(l.G<10?"0":"")+l.G,l.i=(l.i<10?"0":"")+l.i,l.s=(l.s<10?"0":"")+l.s}for(var t=[],c=e.extend([],i.separators),d=0,h=i.parts.length;d<h;d++)c.length&&t.push(c.shift()),t.push(l[i.parts[d]]);return c.length&&t.push(c.shift()),t.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="{iconType} {leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{iconType} {rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};r.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+r.headTemplate+"<tbody></tbody>"+r.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+r.headTemplate+r.contTemplate+r.footTemplate+"</table></div></div>",r.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+r.headTemplateV3+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+r.headTemplateV3+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+r.headTemplateV3+"<tbody></tbody>"+r.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+r.headTemplateV3+r.contTemplate+r.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+r.headTemplateV3+r.contTemplate+r.footTemplate+"</table></div></div>",e.fn.datetimepicker.DPGlobal=r,e.fn.datetimepicker.noConflict=function(){return e.fn.datetimepicker=o,this},e(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(t){var i=e(this);i.data("datetimepicker")||(t.preventDefault(),i.datetimepicker("show"))}),e(function(){e('[data-provide="datetimepicker-inline"]').datetimepicker()})}),function(e,t){"use strict";"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):t(e.jQuery)}(this,function(e){"use strict";var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=e(this.options.menu),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.fitToElement="boolean"==typeof this.options.fitToElement&&this.options.fitToElement,this.shown=!1,this.listen(),this.showHintOnFocus=("boolean"==typeof this.options.showHintOnFocus||"all"===this.options.showHintOnFocus)&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.addItem=!1,this.value=this.$element.val()||this.$element.text()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("value");if(this.$element.data("active",e),this.autoSelect||e){var t=this.updater(e);t||(t=""),this.$element.val(this.displayText(t)||t).text(this.displayText(t)||t).change(),this.afterSelect(t)}return this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t,i=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight}),s="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight;if(this.shown?t=this.$menu:this.$appendTo?(t=this.$menu.appendTo(this.$appendTo),this.hasSameParent=this.$appendTo.is(this.$element.parent())):(t=this.$menu.insertAfter(this.$element),this.hasSameParent=!0),!this.hasSameParent){t.css("position","fixed");var o=this.$element.offset();i.top=o.top,i.left=o.left}var a=e(t).parent().hasClass("dropup"),r=a?"auto":i.top+i.height+s,n=e(t).hasClass("dropdown-menu-right"),l=n?"auto":i.left;return t.css({top:r,left:l}).show(),!0===this.options.fitToElement&&t.css("width",this.$element.outerWidth()+"px"),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){if(this.query=void 0!==t&&null!==t?t:this.$element.val()||this.$element.text()||"",this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;var i=e.proxy(function(){e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(i,this.delay)},process:function(t){var i=this;return t=e.grep(t,function(e){return i.matcher(e)}),t=this.sorter(t),t.length||this.options.addItem?(t.length>0?this.$element.data("active",t[0]):this.$element.data("active",null),this.options.addItem&&t.push(this.options.addItem),"all"==this.options.items?this.render(t).show():this.render(t.slice(0,this.options.items)).show()):this.shown?this.hide():this},matcher:function(e){return~this.displayText(e).indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,i=[],s=[],o=[];t=e.shift();){var a=this.displayText(t);a.toLowerCase().indexOf(this.query.toLowerCase())?~a.indexOf(this.query)?s.push(t):o.push(t):i.push(t)}return i.concat(s,o)},highlighter:function(t){var i,s,o,a,r=e("<div></div>"),n=this.query,l=t.toLowerCase().indexOf(n.toLowerCase()),c=n.length;if(0===c)return r.text(t).html();for(;l>-1;)i=t.substr(0,l),s=t.substr(l,c),o=t.substr(l+c),a=e("<strong></strong>").text(s),r.append(document.createTextNode(i)).append(a),t=o,l=t.toLowerCase().indexOf(n.toLowerCase());return r.append(document.createTextNode(t)).html()},render:function(t){var i=this,s=this,o=!1,a=[],r=i.options.separator;return e.each(t,function(e,i){e>0&&i[r]!==t[e-1][r]&&a.push({__type:"divider"}),!i[r]||0!==e&&i[r]===t[e-1][r]||a.push({__type:"category",name:i[r]}),a.push(i)}),t=e(a).map(function(t,a){if("category"==(a.__type||!1))return e(i.options.headerHtml).text(a.name)[0];if("divider"==(a.__type||!1))return e(i.options.headerDivider)[0];var r=s.displayText(a);return t=e(i.options.item).data("value",a),t.find("a").html(i.highlighter(r,a)),r==s.$element.val()&&(t.addClass("active"),s.$element.data("active",a),o=!0),t[0]}),this.autoSelect&&!o&&(t.filter(":not(.dropdown-header)").first().addClass("active"),this.$element.data("active",t.first().data("value"))),this.$menu.html(t),this},displayText:function(e){return void 0!==e&&void 0!==e.name&&e.name||e},next:function(t){var i=this.$menu.find(".active").removeClass("active"),s=i.next();s.length||(s=e(this.$menu.find("li")[0])),s.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),i=t.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("input",e.proxy(this.input,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this)).on("mousedown",e.proxy(this.mousedown,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("input").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove(),this.destroyed=!0},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function(e){if(this.shown)switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.shiftKey)return;e.preventDefault(),this.prev();break;case 40:if(e.shiftKey)return;e.preventDefault(),this.next()}},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup()},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},input:function(e){var t=this.$element.val()||this.$element.text();this.value!==t&&(this.value=t,this.lookup())},keyup:function(e){if(!this.destroyed)switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide()}},focus:function(e){this.focused||(this.focused=!0,this.options.showHintOnFocus&&!0!==this.skipShowHintOnFocus&&("all"===this.options.showHintOnFocus?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},blur:function(e){this.mousedover||this.mouseddown||!this.shown?this.mouseddown&&(this.skipShowHintOnFocus=!0,this.$element.focus(),this.mouseddown=!1):(this.hide(),this.focused=!1)},click:function(e){e.preventDefault(),this.skipShowHintOnFocus=!0,this.select(),this.$element.focus(),this.hide()},mouseenter:function(t){this.mousedover=!0,
this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},mousedown:function(e){this.mouseddown=!0,this.$menu.one("mouseup",function(e){this.mouseddown=!1}.bind(this))}};var i=e.fn.typeahead;e.fn.typeahead=function(i){var s=arguments;return"string"==typeof i&&"getActive"==i?this.data("active"):this.each(function(){var o=e(this),a=o.data("typeahead"),r="object"==typeof i&&i;a||o.data("typeahead",a=new t(this,r)),"string"==typeof i&&a[i]&&(s.length>1?a[i].apply(a,Array.prototype.slice.call(s,1)):a[i]())})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a class="dropdown-item" href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:e.noop,addItem:!1,delay:0,separator:"category",headerHtml:'<li class="dropdown-header"></li>',headerDivider:'<li class="divider" role="separator"></li>'},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=i,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var i=e(this);i.data("typeahead")||i.typeahead(i.data())})}),function(){function e(e){var t=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};this.label=t.label||t.value,this.value=t.value}function t(e,t,i){for(var s in t){var o=t[s],a=e.input.getAttribute("data-"+s.toLowerCase());"number"==typeof o?e[s]=parseInt(a):!1===o?e[s]=null!==a:o instanceof Function?e[s]=null:e[s]=a,e[s]||0===e[s]||(e[s]=s in i?i[s]:o)}}function i(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function s(e,t){return r.call((t||document).querySelectorAll(e))}function o(){s("input.awesomplete").forEach(function(e){new a(e)})}var a=function(e,s){var o=this;this.isOpened=!1,this.input=i(e),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-autocomplete","list"),s=s||{},t(this,{minChars:2,maxItems:10,autoFirst:!1,data:a.DATA,filter:a.FILTER_CONTAINS,sort:a.SORT_BYLENGTH,item:a.ITEM,replace:a.REPLACE},s),this.index=-1,this.container=i.create("div",{className:"awesomplete",around:e}),this.ul=i.create("ul",{hidden:"hidden",inside:this.container}),this.status=i.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container}),i.bind(this.input,{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown:function(e){var t=e.keyCode;o.opened&&(13===t&&o.selected?(e.preventDefault(),o.select()):27===t?o.close({reason:"esc"}):38!==t&&40!==t||(e.preventDefault(),o[38===t?"previous":"next"]()))}}),i.bind(this.input.form,{submit:this.close.bind(this,{reason:"submit"})}),i.bind(this.ul,{mousedown:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),o.select(t,e.target))}}}),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||s.list||[],a.all.push(this)};a.prototype={set list(e){if(Array.isArray(e))this._list=e;else if("string"==typeof e&&e.indexOf(",")>-1)this._list=e.split(/\s*,\s*/);else if((e=i(e))&&e.children){var t=[];r.apply(e.children).forEach(function(e){if(!e.disabled){var i=e.textContent.trim(),s=e.value||i,o=e.label||i;""!==s&&t.push({label:o,value:s})}}),this._list=t}document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return this.isOpened},close:function(e){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,i.fire(this.input,"awesomplete-close",e||{}))},open:function(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.autoFirst&&-1===this.index&&this.goto(0),i.fire(this.input,"awesomplete-open")},next:function(){var e=this.ul.children.length;this.goto(this.index<e-1?this.index+1:e?0:-1)},previous:function(){var e=this.ul.children.length,t=this.index-1;this.goto(this.selected&&-1!==t?t:e-1)},goto:function(e){var t=this.ul.children;this.selected&&t[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&t.length>0&&(t[e].setAttribute("aria-selected","true"),this.status.textContent=t[e].textContent,i.fire(this.input,"awesomplete-highlight",{text:this.suggestions[this.index]}))},select:function(e,t){if(e?this.index=i.siblingIndex(e):e=this.ul.children[this.index],e){var s=this.suggestions[this.index];i.fire(this.input,"awesomplete-select",{text:s,origin:t||e})&&(this.replace(s),this.close({reason:"select"}),i.fire(this.input,"awesomplete-selectcomplete",{text:s}))}},evaluate:function(){var t=this,i=this.input.value;i.length>=this.minChars&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.map(function(s){return new e(t.data(s,i))}).filter(function(e){return t.filter(e,i)}).sort(this.sort).slice(0,this.maxItems),this.suggestions.forEach(function(e){t.ul.appendChild(t.item(e,i))}),0===this.ul.children.length?this.close({reason:"nomatches"}):this.open()):this.close({reason:"nomatches"})}},a.all=[],a.FILTER_CONTAINS=function(e,t){return RegExp(i.regExpEscape(t.trim()),"i").test(e)},a.FILTER_STARTSWITH=function(e,t){return RegExp("^"+i.regExpEscape(t.trim()),"i").test(e)},a.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:e<t?-1:1},a.ITEM=function(e,t){var s=""===t?e:e.replace(RegExp(i.regExpEscape(t.trim()),"gi"),"<mark>$&</mark>");return i.create("li",{innerHTML:s,"aria-selected":"false"})},a.REPLACE=function(e){this.input.value=e.value},a.DATA=function(e){return e},Object.defineProperty(e.prototype=Object.create(String.prototype),"length",{get:function(){return this.label.length}}),e.prototype.toString=e.prototype.valueOf=function(){return""+this.label};var r=Array.prototype.slice;i.create=function(e,t){var s=document.createElement(e);for(var o in t){var a=t[o];if("inside"===o)i(a).appendChild(s);else if("around"===o){var r=i(a);r.parentNode.insertBefore(s,r),s.appendChild(r)}else o in s?s[o]=a:s.setAttribute(o,a)}return s},i.bind=function(e,t){if(e)for(var i in t){var s=t[i];i.split(/\s+/).forEach(function(t){e.addEventListener(t,s)})}},i.fire=function(e,t,i){var s=document.createEvent("HTMLEvents");s.initEvent(t,!0,!0);for(var o in i)s[o]=i[o];return e.dispatchEvent(s)},i.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},i.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o)),a.$=i,a.$$=s,"undefined"!=typeof self&&(self.Awesomplete=a),"object"==typeof module&&module.exports&&(module.exports=a)}();var commerceCategoryTree=function(){function e(e,a){a=void 0==a?null:a;var r=$("#"+e);r.jstree({core:{multiple:!1,check_callback:!0,animation:500,themes:{name:"proton",responsive:!1,icons:!1},dblclick_toggle:!1,data:{cache:!1,data:s(e),url:"/melis/MelisCommerce/MelisComCategoryList/getCategoryTreeView"}},types:{default:{icon:"fa fa-circle text-success"},selected:{select_node:!1}},checkbox:{three_state:!1,whole_node:!1,tie_selection:!1},plugins:["search","types","checkbox"]}).on("check_node.jstree uncheck_node.jstree",function(t,i){var s=$("#"+e+"_form").data("input-field-selected");i.node.state.checked?$("#"+e+"_form").append('<input type="hidden" name="'+s+'[]" value="'+i.node.original.cat_id+'">'):$("#"+e+"_form input[name='"+s+"[]'][value='"+i.node.original.cat_id+"']").remove()}).on("select_node.jstree deselect_node.jstree ",function(t,i){var s=$("#"+e+"_form").data("input-field-root");i.node.state.selected&&$("#"+e+"_form input[name='"+s+"']").val(i.node.original.cat_id)}).on("after_open.jstree",function(s,o){t(e),i(e)}).on("loaded.jstree",function(t,i){o(e),null!==a&&a(t,i,r)}).on("refresh.jstree",function(s,o){t(e),i(e)})}function t(e){$("form#"+e+"_form input[name='m_category_ids[]']").each(function(){$("#"+$(this).val()+"_categoryId_anchor").addClass("jstree-checked")})}function i(e){$("#"+e+".jstree li.jstree-node .jstree-anchor").each(function(){var e=$(this),t=e.data("textlang"),i='<span title="'+translations.tr_meliscommerce_categories_list_tree_view_product_num+'"></span>';t&&(i=" "+t+i),e.hasClass("updatedText")||(e.append(i),e.addClass("updatedText"))})}function s(e){var t=$("#"+e),i=new Array;return i.push({name:"langlocale",value:t.data("langlocale")}),i.push({name:"idAndNameOnly",value:!0}),$("form#"+e+"_form input[name='m_category_ids[]']").each(function(){i.push({name:"categoriesChecked[]",value:$(this).val()})}),i}function o(e){var t=$("#"+e);$("#catPrdSliderPluginSearch").on("keyup",function(i){var s=$(this).val().trim(),o=t.jstree("search",s);setTimeout(function(){0==$(o).find(".jstree-search").length&&""!=s?($("#"+e).prev("div.alert").removeClass("hidden"),$("#"+e).prev("div.alert").find("strong").text(s)):$("#"+e).prev("div.alert").addClass("hidden")},1500)}),$("#catPrdSliderPluginClearBtn").on("click",function(i){$("#catPrdSliderPluginSearch").val(""),t.jstree("search",""),$("#"+e+"SearchNoResult").addClass("hidden")}),$("#catPrdSliderPluginExpandBtn").on("click",function(e){t.jstree("open_all")}),$("#catPrdSliderPluginCollapseBtn").on("click",function(e){t.jstree("close_all")}),$("#catPrdSliderPluginRefreshBtn").on("click",function(e){t.jstree("search",""),$("#catPrdSliderPluginSearch").val(""),t.jstree(!0).refresh()}),$(".category-tree-view-lang-plugin li a").on("click",function(){var i=$(this).text(),o=$(this).data("locale");$(".categoryLangTreePluginDropdown span.filter-key").text(i),t.data("langlocale",o),t.jstree(!0).settings.core.data.data=s(e),t.jstree(!0).refresh()})}return{initCategoryTree:e}}();!function(e,t){"use strict";"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("jquery")):e.jQueryBridget=t(e,e.jQuery)}(window,function(e,t){"use strict";function i(i,a,n){function l(e,t,s){var o,a="$()."+i+'("'+t+'")';return e.each(function(e,l){var c=n.data(l,i);if(!c)return void r(i+" not initialized. Cannot call methods, i.e. "+a);var d=c[t];if(!d||"_"==t.charAt(0))return void r(a+" is not a valid method");var h=d.apply(c,s);o=void 0===o?h:o}),void 0!==o?o:e}function c(e,t){e.each(function(e,s){var o=n.data(s,i);o?(o.option(t),o._init()):(o=new a(s,t),n.data(s,i,o))})}(n=n||t||e.jQuery)&&(a.prototype.option||(a.prototype.option=function(e){n.isPlainObject(e)&&(this.options=n.extend(!0,this.options,e))}),n.fn[i]=function(e){if("string"==typeof e){return l(this,e,o.call(arguments,1))}return c(this,e),this},s(n))}function s(e){!e||e&&e.bridget||(e.bridget=i)}var o=Array.prototype.slice,a=e.console,r=void 0===a?function(){}:function(e){a.error(e)};return s(t||e.jQuery),i}),function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},s=i[e]=i[e]||[];return-1==s.indexOf(t)&&s.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{};return(i[e]=i[e]||{})[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var s=i.indexOf(t);return-1!=s&&i.splice(s,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var s=0,o=i[s];t=t||[];for(var a=this._onceEvents&&this._onceEvents[e];o;){var r=a&&a[o];r&&(this.off(e,o),delete a[o]),o.apply(this,t),s+=r?0:1,o=i[s]}return this}},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return t()}):"object"==typeof module&&module.exports?module.exports=t():e.getSize=t()}(window,function(){"use strict";function e(e){var t=parseFloat(e);return-1==e.indexOf("%")&&!isNaN(t)&&t}function t(){}function i(){for(var e={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},t=0;c>t;t++){e[l[t]]=0}return e}function s(e){var t=getComputedStyle(e);return t||n("Style returned "+t+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),t}function o(){if(!d){d=!0;var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(t);var o=s(t);a.isBoxSizeOuter=r=200==e(o.width),i.removeChild(t)}}function a(t){if(o(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var a=s(t);if("none"==a.display)return i();var n={};n.width=t.offsetWidth,n.height=t.offsetHeight;for(var d=n.isBorderBox="border-box"==a.boxSizing,h=0;c>h;h++){var m=l[h],u=a[m],p=parseFloat(u);n[m]=isNaN(p)?0:p}var _=n.paddingLeft+n.paddingRight,f=n.paddingTop+n.paddingBottom,g=n.marginLeft+n.marginRight,v=n.marginTop+n.marginBottom,y=n.borderLeftWidth+n.borderRightWidth,b=n.borderTopWidth+n.borderBottomWidth,C=d&&r,k=e(a.width);!1!==k&&(n.width=k+(C?0:_+y));var w=e(a.height);return!1!==w&&(n.height=w+(C?0:f+b)),n.innerWidth=n.width-(_+y),n.innerHeight=n.height-(f+b),n.outerWidth=n.width+g,n.outerHeight=n.height+v,n}}var r,n="undefined"==typeof console?t:function(e){console.error(e)},l=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],c=l.length,d=!1;return a}),function(e,t){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",t):"object"==typeof module&&module.exports?module.exports=t():e.matchesSelector=t()}(window,function(){"use strict";var e=function(){var e=Element.prototype;if(e.matches)return"matches";if(e.matchesSelector)return"matchesSelector";for(var t=["webkit","moz","ms","o"],i=0;i<t.length;i++){var s=t[i],o=s+"MatchesSelector";if(e[o])return o}}();return function(t,i){return t[e](i)}}),function(e,t){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("desandro-matches-selector")):e.fizzyUIUtils=t(e,e.matchesSelector)}(window,function(e,t){var i={};i.extend=function(e,t){for(var i in t)e[i]=t[i];return e},i.modulo=function(e,t){return(e%t+t)%t},i.makeArray=function(e){var t=[];if(Array.isArray(e))t=e;else if(e&&"number"==typeof e.length)for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e);return t},i.removeFrom=function(e,t){var i=e.indexOf(t);-1!=i&&e.splice(i,1)},i.getParent=function(e,i){for(;e!=document.body;)if(e=e.parentNode,t(e,i))return e},i.getQueryElement=function(e){return"string"==typeof e?document.querySelector(e):e},i.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},i.filterFindElements=function(e,s){e=i.makeArray(e);var o=[];return e.forEach(function(e){if(e instanceof HTMLElement){if(!s)return void o.push(e);t(e,s)&&o.push(e);for(var i=e.querySelectorAll(s),a=0;a<i.length;a++)o.push(i[a])}}),o},i.debounceMethod=function(e,t,i){var s=e.prototype[t],o=t+"Timeout";e.prototype[t]=function(){var e=this[o];e&&clearTimeout(e);var t=arguments,a=this;this[o]=setTimeout(function(){s.apply(a,t),delete a[o]},i||100)}},i.docReady=function(e){var t=document.readyState;"complete"==t||"interactive"==t?e():document.addEventListener("DOMContentLoaded",e)},i.toDashed=function(e){return e.replace(/(.)([A-Z])/g,function(e,t,i){return t+"-"+i}).toLowerCase()};var s=e.console;return i.htmlInit=function(t,o){i.docReady(function(){var a=i.toDashed(o),r="data-"+a,n=document.querySelectorAll("["+r+"]"),l=document.querySelectorAll(".js-"+a),c=i.makeArray(n).concat(i.makeArray(l)),d=r+"-options",h=e.jQuery;c.forEach(function(e){var i,a=e.getAttribute(r)||e.getAttribute(d);try{i=a&&JSON.parse(a)}catch(t){return void(s&&s.error("Error parsing "+r+" on "+e.className+": "+t))}var n=new t(e,i);h&&h.data(e,o,n)})})},i}),function(e,t){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],t):"object"==typeof module&&module.exports?module.exports=t(require("ev-emitter"),require("get-size")):(e.Outlayer={},e.Outlayer.Item=t(e.EvEmitter,e.getSize))}(window,function(e,t){"use strict";function i(e){for(var t in e)return!1;return null,!0}function s(e,t){e&&(this.element=e,this.layout=t,this.position={x:0,y:0},this._create())}var o=document.documentElement.style,a="string"==typeof o.transition?"transition":"WebkitTransition",r="string"==typeof o.transform?"transform":"WebkitTransform",n={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[a],l={transform:r,transition:a,transitionDuration:a+"Duration",transitionProperty:a+"Property",transitionDelay:a+"Delay"},c=s.prototype=Object.create(e.prototype);c.constructor=s,c._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},c.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},c.getSize=function(){this.size=t(this.element)},c.css=function(e){var t=this.element.style;for(var i in e){t[l[i]||i]=e[i]}},c.getPosition=function(){var e=getComputedStyle(this.element),t=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),s=e[t?"left":"right"],o=e[i?"top":"bottom"],a=this.layout.size,r=-1!=s.indexOf("%")?parseFloat(s)/100*a.width:parseInt(s,10),n=-1!=o.indexOf("%")?parseFloat(o)/100*a.height:parseInt(o,10);r=isNaN(r)?0:r,n=isNaN(n)?0:n,r-=t?a.paddingLeft:a.paddingRight,n-=i?a.paddingTop:a.paddingBottom,this.position.x=r,this.position.y=n},c.layoutPosition=function(){var e=this.layout.size,t={},i=this.layout._getOption("originLeft"),s=this.layout._getOption("originTop"),o=i?"paddingLeft":"paddingRight",a=i?"left":"right",r=i?"right":"left",n=this.position.x+e[o];t[a]=this.getXValue(n),t[r]="";var l=s?"paddingTop":"paddingBottom",c=s?"top":"bottom",d=s?"bottom":"top",h=this.position.y+e[l];t[c]=this.getYValue(h),t[d]="",this.css(t),this.emitEvent("layout",[this])},c.getXValue=function(e){var t=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!t?e/this.layout.size.width*100+"%":e+"px"},c.getYValue=function(e){var t=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&t?e/this.layout.size.height*100+"%":e+"px"},c._transitionTo=function(e,t){this.getPosition();var i=this.position.x,s=this.position.y,o=parseInt(e,10),a=parseInt(t,10),r=o===this.position.x&&a===this.position.y;if(this.setPosition(e,t),r&&!this.isTransitioning)return void this.layoutPosition();var n=e-i,l=t-s,c={};c.transform=this.getTranslate(n,l),this.transition({to:c,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},c.getTranslate=function(e,t){var i=this.layout._getOption("originLeft"),s=this.layout._getOption("originTop");return e=i?e:-e,t=s?t:-t,"translate3d("+e+"px, "+t+"px, 0)"},c.goTo=function(e,t){this.setPosition(e,t),this.layoutPosition()},c.moveTo=c._transitionTo,c.setPosition=function(e,t){this.position.x=parseInt(e,10),this.position.y=parseInt(t,10)},c._nonTransition=function(e){this.css(e.to),e.isCleaning&&this._removeStyles(e.to);for(var t in e.onTransitionEnd)e.onTransitionEnd[t].call(this)},c.transition=function(e){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(e);var t=this._transn;for(var i in e.onTransitionEnd)t.onEnd[i]=e.onTransitionEnd[i];for(i in e.to)t.ingProperties[i]=!0,e.isCleaning&&(t.clean[i]=!0);if(e.from){this.css(e.from);this.element.offsetHeight;null}this.enableTransition(e.to),this.css(e.to),this.isTransitioning=!0};var d="opacity,"+function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}(r);c.enableTransition=function(){if(!this.isTransitioning){var e=this.layout.options.transitionDuration;e="number"==typeof e?e+"ms":e,this.css({transitionProperty:d,transitionDuration:e,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(n,this,!1)}},c.onwebkitTransitionEnd=function(e){this.ontransitionend(e)},c.onotransitionend=function(e){this.ontransitionend(e)};var h={"-webkit-transform":"transform"};c.ontransitionend=function(e){if(e.target===this.element){var t=this._transn,s=h[e.propertyName]||e.propertyName;if(delete t.ingProperties[s],i(t.ingProperties)&&this.disableTransition(),s in t.clean&&(this.element.style[e.propertyName]="",delete t.clean[s]),s in t.onEnd){t.onEnd[s].call(this),delete t.onEnd[s]}this.emitEvent("transitionEnd",[this])}},c.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(n,this,!1),this.isTransitioning=!1},c._removeStyles=function(e){var t={};for(var i in e)t[i]="";this.css(t)};var m={transitionProperty:"",transitionDuration:"",transitionDelay:""};return c.removeTransitionStyles=function(){this.css(m)},c.stagger=function(e){e=isNaN(e)?0:e,this.staggerDelay=e+"ms"},c.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},c.remove=function(){return a&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},c.reveal=function(){delete this.isHidden,this.css({display:""});var e=this.layout.options,t={};t[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:e.hiddenStyle,to:e.visibleStyle,isCleaning:!0,onTransitionEnd:t})},c.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},c.getHideRevealTransitionEndProperty=function(e){var t=this.layout.options[e];if(t.opacity)return"opacity";for(var i in t)return i},c.hide=function(){this.isHidden=!0,this.css({display:""});var e=this.layout.options,t={};t[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:e.visibleStyle,to:e.hiddenStyle,isCleaning:!0,onTransitionEnd:t})},c.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},c.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},s}),function(e,t){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,s,o,a){return t(e,i,s,o,a)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):e.Outlayer=t(e,e.EvEmitter,e.getSize,e.fizzyUIUtils,e.Outlayer.Item)}(window,function(e,t,i,s,o){"use strict";function a(e,t){var i=s.getQueryElement(e);if(!i)return void(l&&l.error("Bad element for "+this.constructor.namespace+": "+(i||e)));this.element=i,c&&(this.$element=c(this.element)),this.options=s.extend({},this.constructor.defaults),this.option(t);var o=++h;this.element.outlayerGUID=o,m[o]=this,this._create(),this._getOption("initLayout")&&this.layout()}function r(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t}function n(e){if("number"==typeof e)return e;var t=e.match(/(^\d*\.?\d*)(\w*)/),i=t&&t[1],s=t&&t[2];return i.length?(i=parseFloat(i))*(p[s]||1):0}var l=e.console,c=e.jQuery,d=function(){},h=0,m={};a.namespace="outlayer",a.Item=o,a.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var u=a.prototype;s.extend(u,t.prototype),u.option=function(e){s.extend(this.options,e)},u._getOption=function(e){var t=this.constructor.compatOptions[e];return t&&void 0!==this.options[t]?this.options[t]:this.options[e]},a.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},u._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),s.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},u.reloadItems=function(){this.items=this._itemize(this.element.children)},u._itemize=function(e){for(var t=this._filterFindItemElements(e),i=this.constructor.Item,s=[],o=0;o<t.length;o++){var a=t[o],r=new i(a,this);s.push(r)}return s},u._filterFindItemElements=function(e){return s.filterFindElements(e,this.options.itemSelector)},u.getItemElements=function(){return this.items.map(function(e){return e.element})},u.layout=function(){this._resetLayout(),this._manageStamps();var e=this._getOption("layoutInstant"),t=void 0!==e?e:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},u._init=u.layout,u._resetLayout=function(){this.getSize()},u.getSize=function(){this.size=i(this.element)},u._getMeasurement=function(e,t){var s,o=this.options[e];o?("string"==typeof o?s=this.element.querySelector(o):o instanceof HTMLElement&&(s=o),this[e]=s?i(s)[t]:o):this[e]=0},u.layoutItems=function(e,t){e=this._getItemsForLayout(e),this._layoutItems(e,t),this._postLayout()},u._getItemsForLayout=function(e){return e.filter(function(e){return!e.isIgnored})},u._layoutItems=function(e,t){if(this._emitCompleteOnItems("layout",e),e&&e.length){var i=[];e.forEach(function(e){var s=this._getItemLayoutPosition(e);s.item=e,s.isInstant=t||e.isLayoutInstant,i.push(s)},this),this._processLayoutQueue(i)}},u._getItemLayoutPosition=function(){return{x:0,y:0}},u._processLayoutQueue=function(e){this.updateStagger(),e.forEach(function(e,t){this._positionItem(e.item,e.x,e.y,e.isInstant,t)},this)},u.updateStagger=function(){var e=this.options.stagger;return null===e||void 0===e?void(this.stagger=0):(this.stagger=n(e),this.stagger)},u._positionItem=function(e,t,i,s,o){s?e.goTo(t,i):(e.stagger(o*this.stagger),e.moveTo(t,i))},u._postLayout=function(){this.resizeContainer()},u.resizeContainer=function(){if(this._getOption("resizeContainer")){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1))}},u._getContainerSize=d,u._setContainerMeasure=function(e,t){if(void 0!==e){var i=this.size;i.isBorderBox&&(e+=t?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),e=Math.max(e,0),this.element.style[t?"width":"height"]=e+"px"}},u._emitCompleteOnItems=function(e,t){function i(){o.dispatchEvent(e+"Complete",null,[t])}function s(){++r==a&&i()}var o=this,a=t.length;if(!t||!a)return void i();var r=0;t.forEach(function(t){t.once(e,s)})},u.dispatchEvent=function(e,t,i){var s=t?[t].concat(i):i;if(this.emitEvent(e,s),c)if(this.$element=this.$element||c(this.element),t){var o=c.Event(t);o.type=e,this.$element.trigger(o,i)}else this.$element.trigger(e,i)},u.ignore=function(e){var t=this.getItem(e);t&&(t.isIgnored=!0)},u.unignore=function(e){var t=this.getItem(e);t&&delete t.isIgnored},u.stamp=function(e){(e=this._find(e))&&(this.stamps=this.stamps.concat(e),e.forEach(this.ignore,this))},u.unstamp=function(e){(e=this._find(e))&&e.forEach(function(e){s.removeFrom(this.stamps,e),this.unignore(e)},this)},u._find=function(e){return e?("string"==typeof e&&(e=this.element.querySelectorAll(e)),e=s.makeArray(e)):void 0},u._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},u._getBoundingRect=function(){var e=this.element.getBoundingClientRect(),t=this.size;this._boundingRect={left:e.left+t.paddingLeft+t.borderLeftWidth,top:e.top+t.paddingTop+t.borderTopWidth,right:e.right-(t.paddingRight+t.borderRightWidth),bottom:e.bottom-(t.paddingBottom+t.borderBottomWidth)}},u._manageStamp=d,u._getElementOffset=function(e){var t=e.getBoundingClientRect(),s=this._boundingRect,o=i(e);return{left:t.left-s.left-o.marginLeft,top:t.top-s.top-o.marginTop,right:s.right-t.right-o.marginRight,bottom:s.bottom-t.bottom-o.marginBottom}},u.handleEvent=s.handleEvent,u.bindResize=function(){e.addEventListener("resize",this),this.isResizeBound=!0},u.unbindResize=function(){e.removeEventListener("resize",this),this.isResizeBound=!1},u.onresize=function(){this.resize()},s.debounceMethod(a,"onresize",100),u.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},u.needsResizeLayout=function(){var e=i(this.element);return this.size&&e&&e.innerWidth!==this.size.innerWidth},u.addItems=function(e){var t=this._itemize(e);return t.length&&(this.items=this.items.concat(t)),t},u.appended=function(e){var t=this.addItems(e);t.length&&(this.layoutItems(t,!0),this.reveal(t))},u.prepended=function(e){var t=this._itemize(e);if(t.length){var i=this.items.slice(0);this.items=t.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(t,!0),this.reveal(t),this.layoutItems(i)}},u.reveal=function(e){if(this._emitCompleteOnItems("reveal",e),e&&e.length){var t=this.updateStagger();e.forEach(function(e,i){e.stagger(i*t),e.reveal()})}},u.hide=function(e){if(this._emitCompleteOnItems("hide",e),e&&e.length){var t=this.updateStagger();e.forEach(function(e,i){e.stagger(i*t),e.hide()})}},u.revealItemElements=function(e){var t=this.getItems(e);this.reveal(t)},u.hideItemElements=function(e){var t=this.getItems(e);this.hide(t)},u.getItem=function(e){for(var t=0;t<this.items.length;t++){var i=this.items[t];if(i.element==e)return i}},u.getItems=function(e){e=s.makeArray(e);var t=[];return e.forEach(function(e){var i=this.getItem(e);i&&t.push(i)},this),t},u.remove=function(e){var t=this.getItems(e);this._emitCompleteOnItems("remove",t),t&&t.length&&t.forEach(function(e){e.remove(),s.removeFrom(this.items,e)},this)},u.destroy=function(){var e=this.element.style;e.height="",e.position="",e.width="",this.items.forEach(function(e){e.destroy()}),this.unbindResize();var t=this.element.outlayerGUID;delete m[t],delete this.element.outlayerGUID,c&&c.removeData(this.element,this.constructor.namespace)},a.data=function(e){e=s.getQueryElement(e);var t=e&&e.outlayerGUID;return t&&m[t]},a.create=function(e,t){var i=r(a);return i.defaults=s.extend({},a.defaults),s.extend(i.defaults,t),i.compatOptions=s.extend({},a.compatOptions),i.namespace=e,i.data=a.data,i.Item=r(o),s.htmlInit(i,e),c&&c.bridget&&c.bridget(e,i),i};var p={ms:1,s:1e3};return a.Item=o,a}),function(e,t){"function"==typeof define&&define.amd?define("isotope/js/item",["outlayer/outlayer"],t):"object"==typeof module&&module.exports?module.exports=t(require("outlayer")):(e.Isotope=e.Isotope||{},e.Isotope.Item=t(e.Outlayer))}(window,function(e){"use strict";function t(){e.Item.apply(this,arguments)}var i=t.prototype=Object.create(e.Item.prototype),s=i._create;i._create=function(){this.id=this.layout.itemGUID++,s.call(this),this.sortData={}},i.updateSortData=function(){if(!this.isIgnored){this.sortData.id=this.id,this.sortData["original-order"]=this.id,this.sortData.random=Math.random();var e=this.layout.options.getSortData,t=this.layout._sorters;for(var i in e){var s=t[i];this.sortData[i]=s(this.element,this)}}};var o=i.destroy;return i.destroy=function(){o.apply(this,arguments),this.css({display:""})},t}),function(e,t){"function"==typeof define&&define.amd?define("isotope/js/layout-mode",["get-size/get-size","outlayer/outlayer"],t):"object"==typeof module&&module.exports?module.exports=t(require("get-size"),require("outlayer")):(e.Isotope=e.Isotope||{},e.Isotope.LayoutMode=t(e.getSize,e.Outlayer))}(window,function(e,t){"use strict";function i(e){this.isotope=e,e&&(this.options=e.options[this.namespace],this.element=e.element,this.items=e.filteredItems,this.size=e.size)}
var s=i.prototype;return["_resetLayout","_getItemLayoutPosition","_manageStamp","_getContainerSize","_getElementOffset","needsResizeLayout","_getOption"].forEach(function(e){s[e]=function(){return t.prototype[e].apply(this.isotope,arguments)}}),s.needsVerticalResizeLayout=function(){var t=e(this.isotope.element);return this.isotope.size&&t&&t.innerHeight!=this.isotope.size.innerHeight},s._getMeasurement=function(){this.isotope._getMeasurement.apply(this,arguments)},s.getColumnWidth=function(){this.getSegmentSize("column","Width")},s.getRowHeight=function(){this.getSegmentSize("row","Height")},s.getSegmentSize=function(e,t){var i=e+t,s="outer"+t;if(this._getMeasurement(i,s),!this[i]){var o=this.getFirstItemSize();this[i]=o&&o[s]||this.isotope.size["inner"+t]}},s.getFirstItemSize=function(){var t=this.isotope.filteredItems[0];return t&&t.element&&e(t.element)},s.layout=function(){this.isotope.layout.apply(this.isotope,arguments)},s.getSize=function(){this.isotope.getSize(),this.size=this.isotope.size},i.modes={},i.create=function(e,t){function o(){i.apply(this,arguments)}return o.prototype=Object.create(s),o.prototype.constructor=o,t&&(o.options=t),o.prototype.namespace=e,i.modes[e]=o,o},i}),function(e,t){"function"==typeof define&&define.amd?define("masonry/masonry",["outlayer/outlayer","get-size/get-size"],t):"object"==typeof module&&module.exports?module.exports=t(require("outlayer"),require("get-size")):e.Masonry=t(e.Outlayer,e.getSize)}(window,function(e,t){var i=e.create("masonry");return i.compatOptions.fitWidth="isFitWidth",i.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var e=0;e<this.cols;e++)this.colYs.push(0);this.maxY=0},i.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var e=this.items[0],i=e&&e.element;this.columnWidth=i&&t(i).outerWidth||this.containerWidth}var s=this.columnWidth+=this.gutter,o=this.containerWidth+this.gutter,a=o/s,r=s-o%s,n=r&&1>r?"round":"floor";a=Math[n](a),this.cols=Math.max(a,1)},i.prototype.getContainerWidth=function(){var e=this._getOption("fitWidth"),i=e?this.element.parentNode:this.element,s=t(i);this.containerWidth=s&&s.innerWidth},i.prototype._getItemLayoutPosition=function(e){e.getSize();var t=e.size.outerWidth%this.columnWidth,i=t&&1>t?"round":"ceil",s=Math[i](e.size.outerWidth/this.columnWidth);s=Math.min(s,this.cols);for(var o=this._getColGroup(s),a=Math.min.apply(Math,o),r=o.indexOf(a),n={x:this.columnWidth*r,y:a},l=a+e.size.outerHeight,c=this.cols+1-o.length,d=0;c>d;d++)this.colYs[r+d]=l;return n},i.prototype._getColGroup=function(e){if(2>e)return this.colYs;for(var t=[],i=this.cols+1-e,s=0;i>s;s++){var o=this.colYs.slice(s,s+e);t[s]=Math.max.apply(Math,o)}return t},i.prototype._manageStamp=function(e){var i=t(e),s=this._getElementOffset(e),o=this._getOption("originLeft"),a=o?s.left:s.right,r=a+i.outerWidth,n=Math.floor(a/this.columnWidth);n=Math.max(0,n);var l=Math.floor(r/this.columnWidth);l-=r%this.columnWidth?0:1,l=Math.min(this.cols-1,l);for(var c=this._getOption("originTop"),d=(c?s.top:s.bottom)+i.outerHeight,h=n;l>=h;h++)this.colYs[h]=Math.max(d,this.colYs[h])},i.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var e={height:this.maxY};return this._getOption("fitWidth")&&(e.width=this._getContainerFitWidth()),e},i.prototype._getContainerFitWidth=function(){for(var e=0,t=this.cols;--t&&0===this.colYs[t];)e++;return(this.cols-e)*this.columnWidth-this.gutter},i.prototype.needsResizeLayout=function(){var e=this.containerWidth;return this.getContainerWidth(),e!=this.containerWidth},i}),function(e,t){"function"==typeof define&&define.amd?define("isotope/js/layout-modes/masonry",["../layout-mode","masonry/masonry"],t):"object"==typeof module&&module.exports?module.exports=t(require("../layout-mode"),require("masonry-layout")):t(e.Isotope.LayoutMode,e.Masonry)}(window,function(e,t){"use strict";var i=e.create("masonry"),s=i.prototype,o={_getElementOffset:!0,layout:!0,_getMeasurement:!0};for(var a in t.prototype)o[a]||(s[a]=t.prototype[a]);var r=s.measureColumns;s.measureColumns=function(){this.items=this.isotope.filteredItems,r.call(this)};var n=s._getOption;return s._getOption=function(e){return"fitWidth"==e?void 0!==this.options.isFitWidth?this.options.isFitWidth:this.options.fitWidth:n.apply(this.isotope,arguments)},i}),function(e,t){"function"==typeof define&&define.amd?define("isotope/js/layout-modes/fit-rows",["../layout-mode"],t):"object"==typeof exports?module.exports=t(require("../layout-mode")):t(e.Isotope.LayoutMode)}(window,function(e){"use strict";var t=e.create("fitRows"),i=t.prototype;return i._resetLayout=function(){this.x=0,this.y=0,this.maxY=0,this._getMeasurement("gutter","outerWidth")},i._getItemLayoutPosition=function(e){e.getSize();var t=e.size.outerWidth+this.gutter,i=this.isotope.size.innerWidth+this.gutter;0!==this.x&&t+this.x>i&&(this.x=0,this.y=this.maxY);var s={x:this.x,y:this.y};return this.maxY=Math.max(this.maxY,this.y+e.size.outerHeight),this.x+=t,s},i._getContainerSize=function(){return{height:this.maxY}},t}),function(e,t){"function"==typeof define&&define.amd?define("isotope/js/layout-modes/vertical",["../layout-mode"],t):"object"==typeof module&&module.exports?module.exports=t(require("../layout-mode")):t(e.Isotope.LayoutMode)}(window,function(e){"use strict";var t=e.create("vertical",{horizontalAlignment:0}),i=t.prototype;return i._resetLayout=function(){this.y=0},i._getItemLayoutPosition=function(e){e.getSize();var t=(this.isotope.size.innerWidth-e.size.outerWidth)*this.options.horizontalAlignment,i=this.y;return this.y+=e.size.outerHeight,{x:t,y:i}},i._getContainerSize=function(){return{height:this.y}},t}),function(e,t){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size","desandro-matches-selector/matches-selector","fizzy-ui-utils/utils","isotope/js/item","isotope/js/layout-mode","isotope/js/layout-modes/masonry","isotope/js/layout-modes/fit-rows","isotope/js/layout-modes/vertical"],function(i,s,o,a,r,n){return t(e,i,s,o,a,r,n)}):"object"==typeof module&&module.exports?module.exports=t(e,require("outlayer"),require("get-size"),require("desandro-matches-selector"),require("fizzy-ui-utils"),require("isotope/js/item"),require("isotope/js/layout-mode"),require("isotope/js/layout-modes/masonry"),require("isotope/js/layout-modes/fit-rows"),require("isotope/js/layout-modes/vertical")):e.Isotope=t(e,e.Outlayer,e.getSize,e.matchesSelector,e.fizzyUIUtils,e.Isotope.Item,e.Isotope.LayoutMode)}(window,function(e,t,i,s,o,a,r){function n(e,t){return function(i,s){for(var o=0;o<e.length;o++){var a=e[o],r=i.sortData[a],n=s.sortData[a];if(r>n||n>r){var l=void 0!==t[a]?t[a]:t,c=l?1:-1;return(r>n?1:-1)*c}}return 0}}var l=e.jQuery,c=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^\s+|\s+$/g,"")},d=t.create("isotope",{layoutMode:"masonry",isJQueryFiltering:!0,sortAscending:!0});d.Item=a,d.LayoutMode=r;var h=d.prototype;h._create=function(){this.itemGUID=0,this._sorters={},this._getSorters(),t.prototype._create.call(this),this.modes={},this.filteredItems=this.items,this.sortHistory=["original-order"];for(var e in r.modes)this._initLayoutMode(e)},h.reloadItems=function(){this.itemGUID=0,t.prototype.reloadItems.call(this)},h._itemize=function(){for(var e=t.prototype._itemize.apply(this,arguments),i=0;i<e.length;i++){e[i].id=this.itemGUID++}return this._updateItemsSortData(e),e},h._initLayoutMode=function(e){var t=r.modes[e],i=this.options[e]||{};this.options[e]=t.options?o.extend(t.options,i):i,this.modes[e]=new t(this)},h.layout=function(){return!this._isLayoutInited&&this._getOption("initLayout")?void this.arrange():void this._layout()},h._layout=function(){var e=this._getIsInstant();this._resetLayout(),this._manageStamps(),this.layoutItems(this.filteredItems,e),this._isLayoutInited=!0},h.arrange=function(e){this.option(e),this._getIsInstant();var t=this._filter(this.items);this.filteredItems=t.matches,this._bindArrangeComplete(),this._isInstant?this._noTransition(this._hideReveal,[t]):this._hideReveal(t),this._sort(),this._layout()},h._init=h.arrange,h._hideReveal=function(e){this.reveal(e.needReveal),this.hide(e.needHide)},h._getIsInstant=function(){var e=this._getOption("layoutInstant"),t=void 0!==e?e:!this._isLayoutInited;return this._isInstant=t,t},h._bindArrangeComplete=function(){function e(){t&&i&&s&&o.dispatchEvent("arrangeComplete",null,[o.filteredItems])}var t,i,s,o=this;this.once("layoutComplete",function(){t=!0,e()}),this.once("hideComplete",function(){i=!0,e()}),this.once("revealComplete",function(){s=!0,e()})},h._filter=function(e){var t=this.options.filter;t=t||"*";for(var i=[],s=[],o=[],a=this._getFilterTest(t),r=0;r<e.length;r++){var n=e[r];if(!n.isIgnored){var l=a(n);l&&i.push(n),l&&n.isHidden?s.push(n):l||n.isHidden||o.push(n)}}return{matches:i,needReveal:s,needHide:o}},h._getFilterTest=function(e){return l&&this.options.isJQueryFiltering?function(t){return l(t.element).is(e)}:"function"==typeof e?function(t){return e(t.element)}:function(t){return s(t.element,e)}},h.updateSortData=function(e){var t;e?(e=o.makeArray(e),t=this.getItems(e)):t=this.items,this._getSorters(),this._updateItemsSortData(t)},h._getSorters=function(){var e=this.options.getSortData;for(var t in e){var i=e[t];this._sorters[t]=m(i)}},h._updateItemsSortData=function(e){for(var t=e&&e.length,i=0;t&&t>i;i++){e[i].updateSortData()}};var m=function(){function e(e){if("string"!=typeof e)return e;var i=c(e).split(" "),s=i[0],o=s.match(/^\[(.+)\]$/),a=o&&o[1],r=t(a,s),n=d.sortDataParsers[i[1]];return e=n?function(e){return e&&n(r(e))}:function(e){return e&&r(e)}}function t(e,t){return e?function(t){return t.getAttribute(e)}:function(e){var i=e.querySelector(t);return i&&i.textContent}}return e}();d.sortDataParsers={parseInt:function(e){return parseInt(e,10)},parseFloat:function(e){return parseFloat(e)}},h._sort=function(){var e=this.options.sortBy;if(e){var t=[].concat.apply(e,this.sortHistory),i=n(t,this.options.sortAscending);this.filteredItems.sort(i),e!=this.sortHistory[0]&&this.sortHistory.unshift(e)}},h._mode=function(){var e=this.options.layoutMode,t=this.modes[e];if(!t)throw new Error("No layout mode: "+e);return t.options=this.options[e],t},h._resetLayout=function(){t.prototype._resetLayout.call(this),this._mode()._resetLayout()},h._getItemLayoutPosition=function(e){return this._mode()._getItemLayoutPosition(e)},h._manageStamp=function(e){this._mode()._manageStamp(e)},h._getContainerSize=function(){return this._mode()._getContainerSize()},h.needsResizeLayout=function(){return this._mode().needsResizeLayout()},h.appended=function(e){var t=this.addItems(e);if(t.length){var i=this._filterRevealAdded(t);this.filteredItems=this.filteredItems.concat(i)}},h.prepended=function(e){var t=this._itemize(e);if(t.length){this._resetLayout(),this._manageStamps();var i=this._filterRevealAdded(t);this.layoutItems(this.filteredItems),this.filteredItems=i.concat(this.filteredItems),this.items=t.concat(this.items)}},h._filterRevealAdded=function(e){var t=this._filter(e);return this.hide(t.needHide),this.reveal(t.matches),this.layoutItems(t.matches,!0),t.matches},h.insert=function(e){var t=this.addItems(e);if(t.length){var i,s,o=t.length;for(i=0;o>i;i++)s=t[i],this.element.appendChild(s.element);var a=this._filter(t).matches;for(i=0;o>i;i++)t[i].isLayoutInstant=!0;for(this.arrange(),i=0;o>i;i++)delete t[i].isLayoutInstant;this.reveal(a)}};var u=h.remove;return h.remove=function(e){e=o.makeArray(e);var t=this.getItems(e);u.call(this,e);for(var i=t&&t.length,s=0;i&&i>s;s++){var a=t[s];o.removeFrom(this.filteredItems,a)}},h.shuffle=function(){for(var e=0;e<this.items.length;e++){this.items[e].sortData.random=Math.random()}this.options.sortBy="random",this._sort(),this._layout()},h._noTransition=function(e,t){var i=this.options.transitionDuration;this.options.transitionDuration=0;var s=e.apply(this,t);return this.options.transitionDuration=i,s},h.getFilteredItemElements=function(){return this.filteredItems.map(function(e){return e.element})},d}),function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}(this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},s=i[e]=i[e]||[];return-1==s.indexOf(t)&&s.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{};return(i[e]=i[e]||[])[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var s=i.indexOf(t);return-1!=s&&i.splice(s,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var s=0,o=i[s];t=t||[];for(var a=this._onceEvents&&this._onceEvents[e];o;){var r=a&&a[o];r&&(this.off(e,o),delete a[o]),o.apply(this,t),s+=r?0:1,o=i[s]}return this}},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}(window,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function s(e){var t=[];if(Array.isArray(e))t=e;else if("number"==typeof e.length)for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e);return t}function o(e,t,a){return this instanceof o?("string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=s(e),this.options=i({},this.options),"function"==typeof t?a=t:i(this.options,t),a&&this.on("always",a),this.getImages(),n&&(this.jqDeferred=new n.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(e,t,a)}function a(e){this.img=e}function r(e,t){this.url=e,this.element=t,this.img=new Image}var n=e.jQuery,l=e.console;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&c[t]){for(var i=e.querySelectorAll("img"),s=0;s<i.length;s++){var o=i[s];this.addImage(o)}if("string"==typeof this.options.background){var a=e.querySelectorAll(this.options.background);for(s=0;s<a.length;s++){var r=a[s];this.addElementBackgroundImages(r)}}}};var c={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,s=i.exec(t.backgroundImage);null!==s;){var o=s&&s[2];o&&this.addBackground(o,e),s=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new a(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new r(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,s){setTimeout(function(){t.progress(e,i,s)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},a.prototype=Object.create(t.prototype),a.prototype.check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},a.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},a.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},a.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},a.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(a.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&(n=t,n.fn.imagesLoaded=function(e,t){return new o(this,e,t).jqDeferred.promise(n(this))})},o.makeJQueryPlugin(),o}),function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.lightbox=t(e.jQuery)}(this,function(e){function t(t){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=e.extend({},this.constructor.defaults),this.option(t)}return t.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:500,fitImagesInViewport:!0,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1},t.prototype.option=function(t){e.extend(this.options,t)},t.prototype.imageCountLabel=function(e,t){return this.options.albumLabel.replace(/%1/g,e).replace(/%2/g,t)},t.prototype.init=function(){this.enable(),this.build()},t.prototype.enable=function(){var t=this;e("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(i){return t.start(e(i.currentTarget)),!1})},t.prototype.build=function(){var t=this;e('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(e("body")),this.$lightbox=e("#lightbox"),this.$overlay=e("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",function(){return t.end(),!1}),this.$lightbox.hide().on("click",function(i){return"lightbox"===e(i.target).attr("id")&&t.end(),!1}),this.$outerContainer.on("click",function(i){return"lightbox"===e(i.target).attr("id")&&t.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===t.currentImageIndex?t.changeImage(t.album.length-1):t.changeImage(t.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return t.currentImageIndex===t.album.length-1?t.changeImage(0):t.changeImage(t.currentImageIndex+1),!1}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return t.end(),!1})},t.prototype.start=function(t){function i(e){s.album.push({link:e.attr("href"),title:e.attr("data-title")||e.attr("title")})}var s=this,o=e(window);o.on("resize",e.proxy(this.sizeOverlay,this)),e("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var a,r=0,n=t.attr("data-lightbox");if(n){a=e(t.prop("tagName")+'[data-lightbox="'+n+'"]');for(var l=0;l<a.length;l=++l)i(e(a[l])),a[l]===t[0]&&(r=l)}else if("lightbox"===t.attr("rel"))i(t);else{a=e(t.prop("tagName")+'[rel="'+t.attr("rel")+'"]');for(var c=0;c<a.length;c=++c)i(e(a[c])),a[c]===t[0]&&(r=c)}var d=o.scrollTop()+this.options.positionFromTop,h=o.scrollLeft();this.$lightbox.css({top:d+"px",left:h+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&e("body").addClass("lb-disable-scrolling"),this.changeImage(r)},t.prototype.changeImage=function(t){var i=this;this.disableKeyboardNav();var s=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),e(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var o=new Image;o.onload=function(){var a,r,n,l,c,d;s.attr("src",i.album[t].link),e(o),s.width(o.width),s.height(o.height),i.options.fitImagesInViewport&&(d=e(window).width(),c=e(window).height(),l=d-i.containerLeftPadding-i.containerRightPadding-20,n=c-i.containerTopPadding-i.containerBottomPadding-120,i.options.maxWidth&&i.options.maxWidth<l&&(l=i.options.maxWidth),i.options.maxHeight&&i.options.maxHeight<l&&(n=i.options.maxHeight),(o.width>l||o.height>n)&&(o.width/l>o.height/n?(r=l,a=parseInt(o.height/(o.width/r),10),s.width(r),s.height(a)):(a=n,r=parseInt(o.width/(o.height/a),10),s.width(r),s.height(a)))),i.sizeContainer(s.width(),s.height())},o.src=this.album[t].link,this.currentImageIndex=t},t.prototype.sizeOverlay=function(){this.$overlay.width(e(document).width()).height(e(document).height())},t.prototype.sizeContainer=function(e,t){function i(){s.$lightbox.find(".lb-dataContainer").width(r),s.$lightbox.find(".lb-prevLink").height(n),s.$lightbox.find(".lb-nextLink").height(n),s.showImage()}var s=this,o=this.$outerContainer.outerWidth(),a=this.$outerContainer.outerHeight(),r=e+this.containerLeftPadding+this.containerRightPadding,n=t+this.containerTopPadding+this.containerBottomPadding;o!==r||a!==n?this.$outerContainer.animate({width:r,height:n},this.options.resizeDuration,"swing",function(){i()}):i()},t.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},t.prototype.updateNav=function(){var e=!1;try{document.createEvent("TouchEvent"),e=!!this.options.alwaysShowNavOnTouchDevices}catch(e){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(e&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),e&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),e&&this.$lightbox.find(".lb-next").css("opacity","1"))))},t.prototype.updateDetails=function(){var t=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",function(t){void 0!==e(this).attr("target")?window.open(e(this).attr("href"),e(this).attr("target")):location.href=e(this).attr("href")}),this.album.length>1&&this.options.showImageNumberLabel){var i=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(i).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return t.sizeOverlay()})},t.prototype.preloadNeighboringImages=function(){if(this.album.length>this.currentImageIndex+1){(new Image).src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){(new Image).src=this.album[this.currentImageIndex-1].link}},t.prototype.enableKeyboardNav=function(){e(document).on("keyup.keyboard",e.proxy(this.keyboardAction,this))},t.prototype.disableKeyboardNav=function(){e(document).off(".keyboard")},t.prototype.keyboardAction=function(e){var t=e.keyCode,i=String.fromCharCode(t).toLowerCase();27===t||i.match(/x|o|c/)?this.end():"p"===i||37===t?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==i&&39!==t||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},t.prototype.end=function(){this.disableKeyboardNav(),e(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),e("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&e("body").removeClass("lb-disable-scrolling")},new t}),$(function(){function e(e){if(t(),e.lengthComputable){var i=e.total,s=e.loaded,o=100*s/i;$("div.progressContent > div.progress > div.progress-bar").attr("aria-valuenow",o),$("div.progressContent > div.progress > div.progress-bar").css("width",o+"%"),o>100?$("div.progressContent").addClass("hidden"):$("div.progressContent > div.progress > span.status").html(Math.round(o)+"%")}}function t(){$("div.progressContent").removeClass("hidden"),$("div.progressContent > div.progress > div.progress-bar").attr("aria-valuenow",0),$("div.progressContent > div.progress > div.progress-bar").css("width","0%"),$("div.progressContent > div.progress > span.status").html("")}$("body").on("submit","form.frmDocAddFile",function(t){var i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),s=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type"),o="form#"+i+"_"+s+"_frmDocUpload",a=$(o).data("upload-type"),r=new FormData($(o)[0]);$(o).data("savetype");r.append("docRelationType",s),r.append("relationId",i),r.append("docType",a),melisCoreTool.pending(".btn"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComDocument/saveDocument",data:r,processData:!1,cache:!1,contentType:!1,dataType:"json",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",e,!1),t}}).done(function(e){if(e&&e.success){var t=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type"),o=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id");$("div.modal").modal("hide"),"file"==e.type?melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_file_attachments_lists","meliscommerce_documents_file_attachments_lists",{docRelationType:t,docRelationId:o}):"image"==e.type&&melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_image_lists","meliscommerce_documents_image_lists",{docRelationType:t,docRelationId:o}),melisCommerce.setUniqueId(melisCommerce.getUniqueId()),melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,i+"_"+s+"_frmDocUpload"),$("div.progressContent").addClass("hidden");melisCoreTool.done(".btn"),melisCore.flashMessenger()}).error(function(){melisCoreTool.done(".btn"),melisHelper.melisKoNotification(translations.tr_meliscommerce_documents_Documents,translations.tr_meliscommerce_documents_save_fail,[],"closeByButtonOnly")}).error(function(){$("div.modal").modal("hide"),melisCoreTool.done(".btn"),"file"==a?melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_file_attachments_lists","meliscommerce_documents_file_attachments_lists"):"image"==a&&melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_image_lists","meliscommerce_documents_image_lists"),melisCore.flashMessenger()}),t.preventDefault()}),$("body").on("click",".deleteFileImageDocument",function(e){var t=$(this).data("doc-id"),i=$(this).data("type"),s=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),o=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type");if("image"==i)var a=translations.tr_meliscommerce_documents_delete_image_title,r=translations.tr_meliscommerce_documents_delete_image_msg_confirm;else if("file"==i)var a=translations.tr_meliscommerce_documents_delete_file_title,r=translations.tr_meliscommerce_documents_delete_file_msg_confirm;melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,a,r,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComDocument/delete",data:{id:t,docType:i,formType:o,uniqueId:s},dataType:"json",encode:!0}).success(function(e){melisCoreTool.pending(".btn"),e&&e.success?("file"==i?melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_file_attachments_lists","meliscommerce_documents_file_attachments_lists",{docRelationType:o,docRelationId:s}):"image"==i&&melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_image_lists","meliscommerce_documents_image_lists",{docRelationType:o,docRelationId:s}),melisCore.flashMessenger(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.done(".btn")}).error(function(){$("div.modal").modal("hide"),melisCoreTool.done(".btn"),"file"==i?melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_file_attachments_lists","meliscommerce_documents_file_attachments_lists"):"image"==i&&melisHelper.zoneReload(activeTabId+" #id_meliscommerce_documents_image_lists","meliscommerce_documents_image_lists"),melisCore.flashMessenger()})})}),$("body").on("click",".collapseAddImageType",function(){var e=$("div.addImageType");$("form.frmDocAddFile");e.slideToggle(),$(".collapseAddImageType").find("i[data-class='iconAddImageType']").toggleClass("fa-angle-down")}),$("body").on("click",".btnDocAddImageType",function(){var e=$("form.frmDocAddImageType").serialize(),t=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type"),s=$("form.frmDocAddImageType").data("upload-type"),o=$(this).parent().prev().parent().find("form.frmDocAddFile").serialize(),a=$(this).parent().prev().parent().find("img.imgDocThumbnail").attr("src");melisCommerce.postSave("melis/MelisCommerce/MelisComDocument/addImageType?typeUpload="+s,e,function(e){e.success?(melisHelper.zoneReload("id_meliscommerce_documents_modal_form","meliscommerce_documents_modal_form",{typeUpload:"image",saveType:s,docRelationId:t,docRelationType:i}),melisHelper.melisOkNotification(e.textTitle,e.textMessage),setTimeout(function(){$(".btnDocAddImageType").parent().prev().parent().find("img.imgDocThumbnail").attr("src",a),$.each(o.split("&"),function(e,t){var i=t.split("=");$("[name='"+i[0]+"']").val(i[1])})},2e3)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"frmDocAddImageType")),melisCore.flashMessenger()})}),$("body").on("click",".btnDocAddFileType",function(){
var e=$("form.frmDocAddImageType").serialize(),t=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type"),s=$("form.frmDocAddImageType").data("upload-type"),o=$(this).parent().prev().parent().find("form.frmDocAddFile").serialize();melisCommerce.postSave("melis/MelisCommerce/MelisComDocument/addFileType?typeUpload="+s,e,function(e){e.success?(melisHelper.zoneReload("id_meliscommerce_documents_modal_form","meliscommerce_documents_modal_form",{typeUpload:"file",saveType:s,docRelationId:t,docRelationType:i}),melisHelper.melisOkNotification(e.textTitle,e.textMessage),setTimeout(function(){$.each(o.split("&"),function(e,t){var i=t.split("=");$("[name='"+i[0]+"']").val(i[1])})},2e3)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"frmDocAddImageType")),melisCore.flashMessenger()})}),$("body").on("click",".updateFileDocument",function(){var e=$(this).data("doc-id"),t=($(this).data("type"),$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id")),i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type");melisHelper.createModal("id_meliscommerce_documents_modal_form","meliscommerce_documents_modal_form",!1,{typeUpload:"file",docId:e,saveType:"updatefile",docRelationId:t,docRelationType:i},"/melis/MelisCommerce/MelisComDocument/renderDocumentGenericModalContainer")}),$("body").on("click",".editImageDocumentModal",function(){var e=$(this).data("doc-id"),t=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type");melisHelper.createModal("id_meliscommerce_documents_modal_form","meliscommerce_documents_modal_form",!1,{typeUpload:"image",docId:e,saveType:"editimage",docRelationId:t,docRelationType:i},"/melis/MelisCommerce/MelisComDocument/renderDocumentGenericModalContainer")}),$("body").on("click",".addFileImageDocument",function(e){melisCoreTool.pending(this);var t=$(this).data("type"),i=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-id"),s=$("#"+activeTabId+" div.ecom-doc-container").data("doc-relation-type");melisHelper.createModal("id_meliscommerce_documents_modal_form","meliscommerce_documents_modal_form",!1,{typeUpload:t,docRelationId:i,docRelationType:s},"/melis/MelisCommerce/MelisComDocument/renderDocumentGenericModalContainer",function(){melisCoreTool.done(".addFileImageDocument")})}),$("body").on("click","#btnDocFileAdd",function(e){var t=$(this),i="#"+t.attr("form");$(i).trigger("submit"),e.preventDefault()})}),window.initImageDocuments=function(e){var t=$.support.touch?"touchstart":"click",i=$(e).find("div.imageDocumentContainer");i.imagesLoaded(function(){i.isotope({itemSelector:".image"})}),filters={},$("body").on(t,".filter-div-country .filter-key-values li a",function(){var e=$(this).data("text");$(".filter-div-country .filter-dropdown").attr("data-value",e),$(".filter-div-country span.filter-key").text(e)}),$("body").on(t,".filter-div-file-type .filter-key-values li a",function(){var e=$(this).data("text");$(".filter-div-file-type .filter-dropdown").attr("data-value",e),$(".filter-div-file-type span.filter-key").text(e)}),$(".documentImageFilter a").on(t,function(){$(".documentImageFilter .current").removeClass("current"),$(this).addClass("current");var e=$(this).parents(".documentImageFilter");e.find(".selected").removeClass("selected"),$(this).addClass("selected");var t=e.attr("data-filter-group");filters[t]=$(this).attr("data-filter-value");var s=[];for(var o in filters)s.push(filters[o]);var a=s.join("");$grid=i.isotope({filter:a,animationOptions:{duration:750,easing:"linear",queue:!1}}),$grid.on("arrangeComplete",function(e,t){$(".viewImageDocument").attr("data-lightbox","deselected-images"),$.each(t,function(){$selectedImgElem=$(this.element).find(".viewImageDocument"),$selectedImgElem.attr("data-lightbox","selected-images")})}),lightbox.option({resizeDuration:200,wrapAround:!0})}),$(".documentImageFilter a").on(t,function(){$(".documentImageFilter .current").removeClass("current"),$(this).addClass("current");var e=$(this).parents(".documentImageFilter");e.find(".selected").removeClass("selected"),$(this).addClass("selected");var t=e.attr("data-filter-group");filters[t]=$(this).attr("data-filter-value");var s=[];for(var o in filters)s.push(filters[o]);var a=s.join("");$grid=i.isotope({filter:a,animationOptions:{duration:750,easing:"linear",queue:!1}}),$grid.on("arrangeComplete",function(e,t){$(".viewImageDocument").attr("data-lightbox","deselected-images"),$.each(t,function(){$selectedImgElem=$(this.element).find(".viewImageDocument"),$selectedImgElem.attr("data-lightbox","selected-images")})}),lightbox.option({resizeDuration:200,wrapAround:!0})}),lightbox.option({resizeDuration:200,wrapAround:!0})},window.updateFormId=function(){var e=$("form.frmDocAddFile");melisCommerce.getUniqueId()&&e.attr("id",melisCommerce.getUniqueId()+"_frmDocUpload")},window.imagePreview=function(e,t){if(t.files&&t.files[0]){var i=new FileReader;i.onload=function(t){$(e).attr("src",t.target.result)},i.readAsDataURL(t.files[0])}},function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var i,s,o=0,a=!1,r=!1,n=!1,l=[],c=e("script:last").attr("src"),d=window.document,h=d.createElement("LI");h.setAttribute("role","treeitem"),i=d.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),h.appendChild(i),i=d.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),s=d.createElement("I"),s.className="jstree-icon jstree-themeicon",s.setAttribute("role","presentation"),i.appendChild(s),h.appendChild(i),i=s=null,e.jstree={version:"3.3.2",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var s=new e.jstree.core(++o),a=i;return i=e.extend(!0,{},e.jstree.defaults,i),a&&a.plugins&&(i.plugins=a.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(s=s.plugin(t,i[t]))}),e(t).data("jstree",s),s.init(t,i),s},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(d).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var i=null,s=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!s||!s.length)try{s=e(t)}catch(e){}if(!s||!s.length)try{s=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return s&&s.length&&(s=s.closest(".jstree")).length&&(s=s.data("jstree"))?i=s:e(".jstree").each(function(){var s=e(this).data("jstree");return s&&s._model.data[t]?(i=s,!1):void 0}),i},e.fn.jstree=function(i){var s="string"==typeof i,o=Array.prototype.slice.call(arguments,1),a=null;return!(!0===i&&!this.length)&&(this.each(function(){var r=e.jstree.reference(this),n=s&&r?r[i]:null;return a=s&&n?n.apply(r,o):null,r||s||i!==t&&!e.isPlainObject(i)||e.jstree.create(this,i),(r&&!s||!0===i)&&(a=r||!1),(null===a||a===t)&&void 0}),null!==a&&a!==t?a:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,i){var s=e.jstree.plugins[t];return s?(this._data[t]={},s.prototype=this,new s(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",i=null,s=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(d.selection&&d.selection.empty)d.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),s=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==d.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget))&&i.id!==e.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus();break;case 38:t.preventDefault(),(i=this.get_prev_dom(t.currentTarget))&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0])&&e(this._firstChild(i)).children(".jstree-anchor").focus();break;case 40:t.preventDefault(),(i=this.get_next_dom(t.currentTarget))&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),(i=this._firstChild(this.get_container_ul()[0]))&&e(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:t.preventDefault(),this.edit(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,i){i.status&&(i.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,i,s=[];for(t=0,i=this._data.core.selected.length;i>t;t++)s=s.concat(this._model.data[this._data.core.selected[t]].parents);for(s=e.vakata.array_unique(s),t=0,i=s.length;i>t;t++)this.open_node(s[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(s){if(s.target.tagName&&"input"===s.target.tagName.toLowerCase())return!0;i&&clearTimeout(i),i=setTimeout(function(){t=""},500);var o=String.fromCharCode(s.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),r=a.index(d.activeElement)||0,n=!1;if(t+=o,t.length>1){if(a.slice(r).each(e.proxy(function(i,s){return 0===e(s).text().toLowerCase().indexOf(t)?(e(s).focus(),n=!0,!1):void 0},this)),n)return;if(a.slice(0,r).each(e.proxy(function(i,s){return 0===e(s).text().toLowerCase().indexOf(t)?(e(s).focus(),n=!0,!1):void 0},this)),n)return}if(new RegExp("^"+o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(a.slice(r+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===o?(e(i).focus(),n=!0,!1):void 0},this)),n)return;if(a.slice(0,r+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===o?(e(i).focus(),n=!0,!1):void 0},this)),n)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-s>500&&!this._data.core.focused){s=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(d).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return e.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,i){t&&t.id&&(t=t.id);var s;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(s=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[s.closest(".jstree-node").attr("id")])t=this._model.data[s.closest(".jstree-node").attr("id")];else if((s=e(t,this.element)).length&&this._model.data[s.closest(".jstree-node").attr("id")])t=this._model.data[s.closest(".jstree-node").attr("id")];else{if(!(s=e(t,this.element)).length||!s.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return i&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,i,s){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var o,a,r=[];for(r.push(s?t.id:t.text),o=0,a=t.parents.length;a>o;o++)r.push(s?t.parents[o]:this.get_text(t.parents[o]));return r=r.reverse().slice(1),i?r.join(i):r},get_next_dom:function(t,i){var s;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(s=this._firstChild(this.get_container_ul()[0]);s&&0===s.offsetHeight;)s=this._nextSibling(s);return!!s&&e(s)}if(!t||!t.length)return!1;if(i){s=t[0];do{s=this._nextSibling(s)}while(s&&0===s.offsetHeight);return!!s&&e(s)}if(t.hasClass("jstree-open")){for(s=this._firstChild(t.children(".jstree-children")[0]);s&&0===s.offsetHeight;)s=this._nextSibling(s);if(null!==s)return e(s)}s=t[0];do{s=this._nextSibling(s)}while(s&&0===s.offsetHeight);return null!==s?e(s):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var s;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(s=this.get_container_ul()[0].lastChild;s&&0===s.offsetHeight;)s=this._previousSibling(s);return!!s&&e(s)}if(!t||!t.length)return!1;if(i){s=t[0];do{s=this._previousSibling(s)}while(s&&0===s.offsetHeight);return!!s&&e(s)}s=t[0];do{s=this._previousSibling(s)}while(s&&0===s.offsetHeight);if(null!==s){for(t=e(s);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return!(!(s=t[0].parentNode.parentNode)||!s.className||-1===s.className.indexOf("jstree-node"))&&e(s)},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||e.children.length>0)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var s,o,a,r,n;if(e.isArray(t))return this._load_nodes(t.slice(),i),!0;if(!(t=this.get_node(t)))return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,a=0,r=t.parents.length;r>a;a++)this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(i){return-1===e.inArray(i,t.children_d)});for(s=0,o=t.children_d.length;o>s;s++)this._model.data[t.children_d[s]].state.selected&&(n=!0),delete this._model.data[t.children_d[s]];n&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(i){return-1===e.inArray(i,t.children_d)})),t.children=[],t.children_d=[],n&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var s=this.get_node(t,!0),o=0,a=0,r=this._model.data,n=!1;for(o=0,a=t.children.length;a>o;o++)if(r[t.children[o]]&&!r[t.children[o]].state.hidden){n=!0;break}t.state.loaded&&s&&s.length&&(s.removeClass("jstree-closed jstree-open jstree-leaf"),n?"#"!==t.id&&s.addClass(t.state.opened?"jstree-open":"jstree-closed"):s.addClass("jstree-leaf")),s.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),i&&i.call(this,t,e)},this)),!0},_load_nodes:function(e,t,i,s){var o,a,r=!0,n=function(){this._load_nodes(e,t,!0)},l=this._model.data,c=[];for(o=0,a=e.length;a>o;o++)l[e[o]]&&(!l[e[o]].state.loaded&&!l[e[o]].state.failed||!i&&s)&&(this.is_loading(e[o])||this.load_node(e[o],n),r=!1);if(r){for(o=0,a=e.length;a>o;o++)l[e[o]]&&l[e[o]].state.loaded&&c.push(e[o]);t&&!t.done&&(t.call(this,c),t.done=!0)}},load_all:function(t,i){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var s,o,a=[],r=this._model.data,n=r[t.id].children_d;for(t.state&&!t.state.loaded&&a.push(t.id),s=0,o=n.length;o>s;s++)r[n[s]]&&r[n[s]].state&&!r[n[s]].state.loaded&&a.push(n[s]);a.length?this._load_nodes(a,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var s,o=this.settings.core.data,a=function(){return 3!==this.nodeType&&8!==this.nodeType};return o?e.isFunction(o)?o.call(this,t,e.proxy(function(s){!1===s?i.call(this,!1):this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(a):s,function(e){i.call(this,e)})},this)):"object"==typeof o?o.url?(o=e.extend(!0,{},o),e.isFunction(o.url)&&(o.url=o.url.call(this,t)),e.isFunction(o.data)&&(o.data=o.data.call(this,t)),e.ajax(o).done(e.proxy(function(s,o,r){var n=r.getResponseHeader("Content-Type");return n&&-1!==n.indexOf("json")||"object"==typeof s?this._append_json_data(t,s,function(e){i.call(this,e)}):n&&-1!==n.indexOf("html")||"string"==typeof s?this._append_html_data(t,e(e.parseHTML(s)).filter(a),function(e){i.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:r})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(e.proxy(function(e){i.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(s=e.isArray(o)||e.isPlainObject(o)?JSON.parse(JSON.stringify(o)):o,t.id===e.jstree.root?this._append_json_data(t,s,function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof o?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(o)).filter(a),function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)}):i.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&this._model.changed.push(e.id)},_append_html_data:function(t,i,s){t=this.get_node(t),t.children=[],t.children_d=[];var o,a,r,n=i.is("ul")?i.children():i,l=t.id,c=[],d=[],h=this._model.data,m=h[l],u=this._data.core.selected.length;for(n.each(e.proxy(function(t,i){(o=this._parse_model_from_html(e(i),l,m.parents.concat()))&&(c.push(o),d.push(o),h[o].children_d.length&&(d=d.concat(h[o].children_d)))},this)),m.children=c,m.children_d=d,a=0,r=m.parents.length;r>a;a++)h[m.parents[a]].children_d=h[m.parents[a]].children_d.concat(d);this.trigger("model",{nodes:d,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==u&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),s.call(this,!0)},_append_json_data:function(t,i,s,o){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],i.d&&"string"==typeof(i=i.d)&&(i=JSON.parse(i)),e.isArray(i)||(i=[i]);var a=null,r={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},n=function(e,t){e.data&&(e=e.data);var i,s,o,a,r=e.dat,n=e.par,l=[],c=[],d=[],h=e.df,m=e.t_id,u=e.t_cnt,p=e.m,_=p[n],f=e.sel,g=function(e,i,s){s=s?s.concat():[],i&&s.unshift(i);var o,a,r,n,l=e.id.toString(),c={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:s,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(c.state[o]=h[o]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),(c.icon===t||null===c.icon||""===c.icon)&&(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(o in e.data.jstree)e.data.jstree.hasOwnProperty(o)&&(c.state[o]=e.data.jstree[o]);if(e&&"object"==typeof e.state)for(o in e.state)e.state.hasOwnProperty(o)&&(c.state[o]=e.state[o]);if(e&&"object"==typeof e.li_attr)for(o in e.li_attr)e.li_attr.hasOwnProperty(o)&&(c.li_attr[o]=e.li_attr[o]);if(c.li_attr.id||(c.li_attr.id=l),e&&"object"==typeof e.a_attr)for(o in e.a_attr)e.a_attr.hasOwnProperty(o)&&(c.a_attr[o]=e.a_attr[o]);for(e&&e.children&&!0===e.children&&(c.state.loaded=!1,c.children=[],c.children_d=[]),p[c.id]=c,o=0,a=c.children.length;a>o;o++)r=g(p[c.children[o]],c.id,s),n=p[r],c.children_d.push(r),n.children_d.length&&(c.children_d=c.children_d.concat(n.children_d));return delete e.data,delete e.children,p[c.id].original=e,c.state.selected&&d.push(c.id),c.id},v=function(e,i,s){s=s?s.concat():[],i&&s.unshift(i);var o,a,r,n,l,c=!1;do{c="j"+m+"_"+ ++u}while(p[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(l.state[o]=h[o]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),(l.icon===t||null===l.icon||""===l.icon)&&(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(o in e.data.jstree)e.data.jstree.hasOwnProperty(o)&&(l.state[o]=e.data.jstree[o]);if(e&&"object"==typeof e.state)for(o in e.state)e.state.hasOwnProperty(o)&&(l.state[o]=e.state[o]);if(e&&"object"==typeof e.li_attr)for(o in e.li_attr)e.li_attr.hasOwnProperty(o)&&(l.li_attr[o]=e.li_attr[o]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(o in e.a_attr)e.a_attr.hasOwnProperty(o)&&(l.a_attr[o]=e.a_attr[o]);if(e&&e.children&&e.children.length){for(o=0,a=e.children.length;a>o;o++)r=v(e.children[o],l.id,s),n=p[r],l.children.push(r),n.children_d.length&&(l.children_d=l.children_d.concat(n.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,p[l.id]=l,l.state.selected&&d.push(l.id),l.id};if(r.length&&r[0].id!==t&&r[0].parent!==t){for(s=0,o=r.length;o>s;s++)r[s].children||(r[s].children=[]),p[r[s].id.toString()]=r[s];for(s=0,o=r.length;o>s;s++)p[r[s].parent.toString()].children.push(r[s].id.toString()),_.children_d.push(r[s].id.toString());for(s=0,o=_.children.length;o>s;s++)i=g(p[_.children[s]],n,_.parents.concat()),c.push(i),p[i].children_d.length&&(c=c.concat(p[i].children_d));for(s=0,o=_.parents.length;o>s;s++)p[_.parents[s]].children_d=p[_.parents[s]].children_d.concat(c);a={cnt:u,mod:p,sel:f,par:n,dpc:c,add:d}}else{for(s=0,o=r.length;o>s;s++)(i=v(r[s],n,_.parents.concat()))&&(l.push(i),c.push(i),p[i].children_d.length&&(c=c.concat(p[i].children_d)));for(_.children=l,_.children_d=c,s=0,o=_.parents.length;o>s;s++)p[_.parents[s]].children_d=p[_.parents[s]].children_d.concat(c);a={cnt:u,mod:p,sel:f,par:n,dpc:c,add:d}}return"undefined"!=typeof window&&void 0!==window.document?a:void postMessage(a)},l=function(t,i){if(null!==this.element){this._cnt=t.cnt;var o,a=this._model.data;for(o in a)a.hasOwnProperty(o)&&a[o].state&&a[o].state.loading&&t.mod[o]&&(t.mod[o].state.loading=!0);if(this._model.data=t.mod,i){var r,n=t.add,l=t.sel,c=this._data.core.selected.slice();if(a=this._model.data,l.length!==c.length||e.vakata.array_unique(l.concat(c)).length!==l.length){for(o=0,r=l.length;r>o;o++)-1===e.inArray(l[o],n)&&-1===e.inArray(l[o],c)&&(a[l[o]].state.selected=!1);for(o=0,r=c.length;r>o;o++)-1===e.inArray(c[o],l)&&(a[c[o]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),s.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+n.toString()],{type:"text/javascript"}))),!this._data.core.working||o?(this._data.core.working=!0,a=new window.Worker(this._wrk),a.onmessage=e.proxy(function(e){l.call(this,e.data,!0);try{a.terminate(),a=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),r.par?a.postMessage(r):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,s,!0])}catch(e){l.call(this,n(r),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else l.call(this,n(r),!1)}},_parse_model_from_html:function(i,s,o){o=o?[].concat(o):[],s&&o.unshift(s);var a,r,n,l,c,d=this._model.data,h={id:!1,text:!1,icon:!0,parent:s,parents:o,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in this._model.default_state)this._model.default_state.hasOwnProperty(n)&&(h.state[n]=this._model.default_state[n]);if(l=e.vakata.attributes(i,!0),e.each(l,function(t,i){return i=e.trim(i),!i.length||(h.li_attr[t]=i,void("id"===t&&(h.id=i.toString())))}),l=i.children("a").first(),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,i){i=e.trim(i),i.length&&(h.a_attr[t]=i)})),l=i.children("a").first().length?i.children("a").first().clone():i.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),h.text=this.settings.core.force_text?l.text():l.html(),l=i.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=i.hasClass("jstree-open"),h.state.selected=i.children("a").hasClass("jstree-clicked"),h.state.disabled=i.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(n in h.data.jstree)h.data.jstree.hasOwnProperty(n)&&(h.state[n]=h.data.jstree[n]);l=i.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),l=i.children("ul").children("li");do{c="j"+this._id+"_"+ ++this._cnt}while(d[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,
l.length?(l.each(e.proxy(function(t,i){a=this._parse_model_from_html(e(i),h.id,o),r=this._model.data[a],h.children.push(a),r.children_d.length&&(h.children_d=h.children_d.concat(r.children_d))},this)),h.children_d=h.children_d.concat(h.children)):i.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr.class&&(h.li_attr.class=h.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),h.a_attr.class&&(h.a_attr.class=h.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),d[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,i,s){s=s?s.concat():[],i&&s.unshift(i);var o,a,r,n,l=e.id.toString(),c=this._model.data,d=this._model.default_state,h={id:l,text:e.text||"",icon:e.icon===t||e.icon,parent:i,parents:s,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in d)d.hasOwnProperty(o)&&(h.state[o]=d[o]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(o in e.data.jstree)e.data.jstree.hasOwnProperty(o)&&(h.state[o]=e.data.jstree[o]);if(e&&"object"==typeof e.state)for(o in e.state)e.state.hasOwnProperty(o)&&(h.state[o]=e.state[o]);if(e&&"object"==typeof e.li_attr)for(o in e.li_attr)e.li_attr.hasOwnProperty(o)&&(h.li_attr[o]=e.li_attr[o]);if(h.li_attr.id||(h.li_attr.id=l),e&&"object"==typeof e.a_attr)for(o in e.a_attr)e.a_attr.hasOwnProperty(o)&&(h.a_attr[o]=e.a_attr[o]);for(e&&e.children&&!0===e.children&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,o=0,a=h.children.length;a>o;o++)r=this._parse_model_from_flat_json(c[h.children[o]],h.id,s),n=c[r],h.children_d.push(r),n.children_d.length&&(h.children_d=h.children_d.concat(n.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,i,s){s=s?s.concat():[],i&&s.unshift(i);var o,a,r,n,l,c=!1,d=this._model.data,h=this._model.default_state;do{c="j"+this._id+"_"+ ++this._cnt}while(d[c]);l={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:i,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(l.state[o]=h[o]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.text&&(l.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),(l.icon===t||null===l.icon||""===l.icon)&&(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(o in e.data.jstree)e.data.jstree.hasOwnProperty(o)&&(l.state[o]=e.data.jstree[o]);if(e&&"object"==typeof e.state)for(o in e.state)e.state.hasOwnProperty(o)&&(l.state[o]=e.state[o]);if(e&&"object"==typeof e.li_attr)for(o in e.li_attr)e.li_attr.hasOwnProperty(o)&&(l.li_attr[o]=e.li_attr[o]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(o in e.a_attr)e.a_attr.hasOwnProperty(o)&&(l.a_attr[o]=e.a_attr[o]);if(e&&e.children&&e.children.length){for(o=0,a=e.children.length;a>o;o++)r=this._parse_model_from_json(e.children[o],l.id,s),n=d[r],l.children.push(r),n.children_d.length&&(l.children_d=l.children_d.concat(n.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,d[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var t,i,s,o=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),a=d.createElement("UL"),r=this._data.core.focused;for(i=0,s=o.length;s>i;i++)(t=this.redraw_node(o[i],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&a.appendChild(t);this._model.force_full_redraw&&(a.className=this.get_container_ul()[0].className,a.setAttribute("role","group"),this.element.empty().append(a)),null!==r&&(t=this.get_node(r,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==d.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:o})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var i=this.get_node(t),s=!1,o=!1,a=!1,r=d;if(!i)return!1;if(i.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],i.children.length&&i.state.loaded){for(a=r.createElement("UL"),a.setAttribute("role","group"),a.className="jstree-children",s=0,o=i.children.length;o>s;s++)a.appendChild(this.redraw_node(i.children[s],!0,!0));t.appendChild(a)}},redraw_node:function(t,i,s,o){var a=this.get_node(t),r=!1,n=!1,l=!1,c=!1,m=!1,u=!1,p="",_=d,f=this._model.data,g=!1,v=null,y=0,b=0,C=!1,k=!1;if(!a)return!1;if(a.id===e.jstree.root)return this.redraw(!0);if(i=i||0===a.children.length,t=d.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(a.id[0])?"\\3"+a.id[0]+" "+a.id.substr(1).replace(e.jstree.idregex,"\\$&"):a.id.replace(e.jstree.idregex,"\\$&"))):d.getElementById(a.id))t=e(t),s||(r=t.parent().parent()[0],r===this.element[0]&&(r=null),n=t.index()),i||!a.children.length||t.children(".jstree-children").length||(i=!0),i||(l=t.children(".jstree-children")[0]),g=t.children(".jstree-anchor")[0]===d.activeElement,t.remove();else if(i=!0,!s){if(!(null===(r=a.parent!==e.jstree.root?e("#"+a.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||r&&f[a.parent].state.opened))return!1;n=e.inArray(a.id,null===r?f[e.jstree.root].children:f[a.parent].children)}t=h.cloneNode(!0),p="jstree-node ";for(c in a.li_attr)if(a.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,a.li_attr[c]):p+=a.li_attr[c]}for(a.a_attr.id||(a.a_attr.id=a.id+"_anchor"),t.setAttribute("aria-selected",!!a.state.selected),t.setAttribute("aria-level",a.parents.length),t.setAttribute("aria-labelledby",a.a_attr.id),a.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,m=a.children.length;m>c;c++)if(!f[a.children[c]].state.hidden){C=!0;break}if(null!==a.parent&&f[a.parent]&&!a.state.hidden&&(c=e.inArray(a.id,f[a.parent].children),k=a.id,-1!==c))for(c++,m=f[a.parent].children.length;m>c&&(f[f[a.parent].children[c]].state.hidden||(k=f[a.parent].children[c]),k===a.id);c++);a.state.hidden&&(p+=" jstree-hidden"),a.state.loaded&&!C?p+=" jstree-leaf":(p+=a.state.opened&&a.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",a.state.opened&&a.state.loaded)),k===a.id&&(p+=" jstree-last"),t.id=a.id,t.className=p,p=(a.state.selected?" jstree-clicked":"")+(a.state.disabled?" jstree-disabled":"");for(m in a.a_attr)if(a.a_attr.hasOwnProperty(m)){if("href"===m&&"#"===a.a_attr[m])continue;"class"!==m?t.childNodes[1].setAttribute(m,a.a_attr[m]):p+=" "+a.a_attr[m]}if(p.length&&(t.childNodes[1].className="jstree-anchor "+p),(a.icon&&!0!==a.icon||!1===a.icon)&&(!1===a.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===a.icon.indexOf("/")&&-1===a.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+a.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+a.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(_.createTextNode(a.text)):t.childNodes[1].innerHTML+=a.text,i&&a.children.length&&(a.state.opened||o)&&a.state.loaded){for(u=_.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,m=a.children.length;m>c;c++)u.appendChild(this.redraw_node(a.children[c],i,!0));t.appendChild(u)}if(l&&t.appendChild(l),!s){for(r||(r=this.element[0]),c=0,m=r.childNodes.length;m>c;c++)if(r.childNodes[c]&&r.childNodes[c].className&&-1!==r.childNodes[c].className.indexOf("jstree-children")){v=r.childNodes[c];break}v||(v=_.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",r.appendChild(v)),r=v,n<r.childNodes.length?r.insertBefore(t,r.childNodes[n]):r.appendChild(t),g&&(y=this.element[0].scrollTop,b=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=y,this.element[0].scrollLeft=b)}return a.state.opened&&!a.state.loaded&&(a.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(a.id,!1,0)},this),0)),t},open_node:function(i,s,o){var a,r,n,l;if(e.isArray(i)){for(i=i.slice(),a=0,r=i.length;r>a;a++)this.open_node(i[a],s,o);return!0}return!(!(i=this.get_node(i))||i.id===e.jstree.root)&&(o=o===t?this.settings.core.animation:o,this.is_closed(i)?this.is_loaded(i)?(n=this.get_node(i,!0),l=this,n.length&&(o&&n.children(".jstree-children").length&&n.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(n.children(".jstree-children")[0])&&this.draw_children(i),o?(this.trigger("before_open",{node:i}),n.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(o,function(){this.style.display="",l.element&&l.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),n[0].className=n[0].className.replace("jstree-closed","jstree-open"),n[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,s&&s.call(this,i,!0),n.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),o&&n.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(e.proxy(function(){this.open_node(i,s,o)},this),500):void this.load_node(i,function(e,t){return t?this.open_node(e,s,o):!!s&&s.call(this,e,!1)}):(s&&s.call(this,i,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i,s,o=t.parents;for(i=0,s=o.length;s>i;i+=1)i!==e.jstree.root&&this.open_node(o[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,s){var o,a,r,n;if(e.isArray(i)){for(i=i.slice(),o=0,a=i.length;a>o;o++)this.close_node(i[o],s);return!0}return!(!(i=this.get_node(i))||i.id===e.jstree.root)&&(!this.is_closed(i)&&(s=s===t?this.settings.core.animation:s,r=this,n=this.get_node(i,!0),i.state.opened=!1,this.trigger("close_node",{node:i}),void(n.length?s?n.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(s,function(){this.style.display="",n.children(".jstree-children").remove(),r.element&&r.trigger("after_close",{node:i})}):(n[0].className=n[0].className.replace("jstree-open","jstree-closed"),n.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:i})):this.trigger("after_close",{node:i}))))},toggle_node:function(t){var i,s;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,s){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var o,a,r,n=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!n.length){for(o=0,a=t.children_d.length;a>o;o++)this.is_closed(this._model.data[t.children_d[o]])&&(this._model.data[t.children_d[o]].state.opened=!0);return this.trigger("open_all",{node:t})}s=s||n,r=this,n=this.is_closed(t)?n.find(".jstree-closed").addBack():n.find(".jstree-closed"),n.each(function(){r.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,s)},i||0)}),0===s.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(s)})},close_all:function(t,i){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var s,o,a=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),r=this;for(a.length&&(a=this.is_open(t)?a.find(".jstree-open").addBack():a.find(".jstree-open"),e(a.get().reverse()).each(function(){r.close_node(this,i||0)})),s=0,o=t.children_d.length;o>s;s++)this._model.data[t.children_d[s]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var i,s;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.enable_node(t[i]);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t}))},disable_node:function(t){var i,s;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.disable_node(t[i]);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t}))},is_hidden:function(e){return e=this.get_node(e),!0===e.state.hidden},hide_node:function(t,i){var s,o;if(e.isArray(t)){for(t=t.slice(),s=0,o=t.length;o>s;s++)this.hide_node(t[s],!0);return i||this.redraw(),!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t})))},show_node:function(t,i){var s,o;if(e.isArray(t)){for(t=t.slice(),s=0,o=t.length;o>s;s++)this.show_node(t[s],!0);return i||this.redraw(),!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t})))},hide_all:function(t){var i,s=this._model.data,o=[];for(i in s)s.hasOwnProperty(i)&&i!==e.jstree.root&&!s[i].state.hidden&&(s[i].state.hidden=!0,o.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:o}),o},show_all:function(t){var i,s=this._model.data,o=[];for(i in s)s.hasOwnProperty(i)&&i!==e.jstree.root&&s[i].state.hidden&&(s[i].state.hidden=!1,o.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:o}),o},activate_node:function(e,i){if(this.is_disabled(e))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(i.shiftKey){var s,o,a=this.get_node(e).id,r=this._data.core.last_clicked.id,n=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(s=0,o=n.length;o>s;s+=1)n[s]===a&&(l=!l),n[s]===r&&(l=!l),this.is_disabled(n[s])||!l&&n[s]!==a&&n[s]!==r?this.deselect_node(n[s],!0,i):this.is_hidden(n[s])||this.select_node(n[s],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):this.select_node(e,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):(this.deselect_all(!0),this.select_node(e,!1,!1,i),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return!!((e=this.get_node(e,!0))&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(t,i,s,o){var a,r,n;if(e.isArray(t)){for(t=t.slice(),r=0,n=t.length;n>r;r++)this.select_node(t[r],i,s,o);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),s||(a=this._open_to(t)),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:o}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:o}))))},deselect_node:function(t,i,s){var o,a,r;if(e.isArray(t)){for(t=t.slice(),o=0,a=t.length;a>o;o++)this.deselect_node(t[o],i,s);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(r=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),r.length&&r.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:s}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:s}))))},select_all:function(t){var i,s,o=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),i=0,s=this._data.core.selected.length;s>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:o})},deselect_all:function(e){var t,i,s=this._data.core.selected.concat([]);for(t=0,i=this._data.core.selected.length;i>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:s}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:s})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i,s,o,a,r=this.get_selected(!0),n={};for(i=0,s=r.length;s>i;i++)n[r[i].id]=r[i];for(i=0,s=r.length;s>i;i++)for(o=0,a=r[i].children_d.length;a>o;o++)n[r[i].children_d[o]]&&delete n[r[i].children_d[o]];r=[];for(i in n)n.hasOwnProperty(i)&&r.push(i);return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},get_bottom_selected:function(t){var i,s,o=this.get_selected(!0),a=[];for(i=0,s=o.length;s>i;i++)o[i].children.length||a.push(o[i].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_state:function(){var t,i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,s){if(i){if(i.core){var o,a;if(i.core.open)return e.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(e){this.open_node(e,!1,0),delete i.core.open,this.set_state(i,s)}):(delete i.core.open,this.set_state(i,s)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,s),!1;if(i.core.selected)return o=this,this.deselect_all(),e.each(i.core.selected,function(e,t){o.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,s),!1;for(a in i)i.hasOwnProperty(a)&&"core"!==a&&-1===e.inArray(a,this.settings.plugins)&&delete i[a];if(e.isEmptyObject(i.core))return delete i.core,this.set_state(i,s),!1}return!e.isEmptyObject(i)||(i=null,s&&s.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,i){this._data.core.state=!0===i?{}:this.get_state(),i&&e.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var s=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+s+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=s,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i=[],s=[],o=this._data.core.selected.concat([]);s.push(t.id),!0===t.state.opened&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){s.push(this.id),i.push(this.id)}),this._load_nodes(s,e.proxy(function(e){this.open_node(i,!1,0),this.select_node(o),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,i){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var s,o,a=this._model.data,r=t.id;for(i=i.toString(),a[t.parent].children[e.inArray(t.id,a[t.parent].children)]=i,s=0,o=t.parents.length;o>s;s++)a[t.parents[s]].children_d[e.inArray(t.id,a[t.parents[s]].children_d)]=i;for(s=0,o=t.children.length;o>s;s++)a[t.children[s]].parent=i;for(s=0,o=t.children_d.length;o>s;s++)a[t.children_d[s]].parents[e.inArray(t.id,a[t.children_d[s]].parents)]=i;return s=e.inArray(t.id,this._data.core.selected),-1!==s&&(this._data.core.selected[s]=i),s=this.get_node(t.id,!0),s&&(s.attr("id",i),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete a[t.id],t.id=i,t.li_attr.id=i,a[i]=t,this.trigger("set_id",{node:t,new:t.id,old:r}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,i){var s,o;if(e.isArray(t)){for(t=t.slice(),s=0,o=t.length;o>s;s++)this.set_text(t[s],i);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0)},get_json:function(t,i,s){if(!(t=this.get_node(t||e.jstree.root)))return!1;i&&i.flat&&!s&&(s=[]);var o,a,r={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!i||!i.no_data)&&e.extend(!0,{},t.data)};if(i&&i.flat?r.parent=t.parent:r.children=[],i&&i.no_state)delete r.state;else for(o in t.state)t.state.hasOwnProperty(o)&&(r.state[o]=t.state[o]);if(i&&i.no_li_attr&&delete r.li_attr,i&&i.no_a_attr&&delete r.a_attr,i&&i.no_id&&(delete r.id,r.li_attr&&r.li_attr.id&&delete r.li_attr.id,r.a_attr&&r.a_attr.id&&delete r.a_attr.id),i&&i.flat&&t.id!==e.jstree.root&&s.push(r),!i||!i.no_children)for(o=0,a=t.children.length;a>o;o++)i&&i.flat?this.get_json(t.children[o],i,s):r.children.push(this.get_json(t.children[o],i));return i&&i.flat?s:t.id===e.jstree.root?r.children:r},create_node:function(i,s,o,a,r){if(null===i&&(i=e.jstree.root),!(i=this.get_node(i)))return!1;if(o=o===t?"last":o,!o.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,s,o,a,!0)});s||(s={text:this.get_string("New node")}),"string"==typeof s&&(s={text:s}),s.text===t&&(s.text=this.get_string("New node"));var n,l,c,d;switch(i.id===e.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":n=this.get_node(i.parent),o=e.inArray(i.id,n.children),i=n;break;case"after":n=this.get_node(i.parent),o=e.inArray(i.id,n.children)+1,i=n;break;case"inside":case"first":o=0;break;case"last":o=i.children.length;break;default:o||(o=0)}if(o>i.children.length&&(o=i.children.length),s.id||(s.id=!0),!this.check("create_node",s,i,o))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===s.id&&delete s.id,!(s=this._parse_model_from_json(s,i.id,i.parents.concat())))return!1;for(n=this.get_node(s),l=[],l.push(s),l=l.concat(n.children_d),this.trigger("model",{nodes:l,parent:i.id}),i.children_d=i.children_d.concat(l),c=0,d=i.parents.length;d>c;c++)this._model.data[i.parents[c]].children_d=this._model.data[i.parents[c]].children_d.concat(l);for(s=n,n=[],c=0,d=i.children.length;d>c;c++)n[c>=o?c+1:c]=i.children[c];return n[o]=s.id,i.children=n,this.redraw_node(i,!0),a&&a.call(this,this.get_node(s)),this.trigger("create_node",{node:this.get_node(s),parent:i.id,position:o}),s.id},rename_node:function(t,i){var s,o,a;if(e.isArray(t)){for(t=t.slice(),s=0,o=t.length;o>s;s++)this.rename_node(t[s],i);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(a=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:a}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var i,s,o,a,r,n,l,c,d,h,m,u;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.delete_node(t[i]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(o=this.get_node(t.parent),a=e.inArray(t.id,o.children),h=!1,!this.check("delete_node",t,o,a))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==a&&(o.children=e.vakata.array_remove(o.children,a)),r=t.children_d.concat([]),r.push(t.id),n=0,l=t.parents.length;l>n;n++)this._model.data[t.parents[n]].children_d=e.vakata.array_filter(this._model.data[t.parents[n]].children_d,function(t){return-1===e.inArray(t,r)});for(c=0,d=r.length;d>c;c++)if(this._model.data[r[c]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,r)})),this.trigger("delete_node",{node:t,parent:o.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:o.id}),c=0,d=r.length;d>c;c++)delete this._model.data[r[c]];return-1!==e.inArray(this._data.core.focused,r)&&(this._data.core.focused=null,m=this.element[0].scrollTop,u=this.element[0].scrollLeft,o.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(o,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=m,this.element[0].scrollLeft=u),this.redraw_node(o,!0),!0},check:function(t,i,s,o,a){i=i&&i.id?i:this.get_node(i),s=s&&s.id?s:this.get_node(s);var r=t.match(/^move_node|copy_node|create_node$/i)?s:i,n=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||a&&a.is_multi||i.id!==s.id&&("move_node"!==t||e.inArray(i.id,s.children)!==o)&&-1===e.inArray(s.id,i.children_d)?(r&&r.data&&(r=r.data),r&&r.functions&&(!1===r.functions[t]||!0===r.functions[t])?(!1===r.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})}),r.functions[t]):!(!1===n||e.isFunction(n)&&!1===n.call(this,t,i,s,o,a)||n&&!1===n[t])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(i,s,o,a,r,n,l){var c,d,h,m,u,p,_,f,g,v,y,b,C,k;if(s=this.get_node(s),o=o===t?0:o,!s)return!1;if(!o.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(s))return this.load_node(s,function(){this.move_node(i,s,o,a,!0,!1,l)});if(e.isArray(i)){if(1!==i.length){for(c=0,d=i.length;d>c;c++)(g=this.move_node(i[c],s,o,a,r,!1,l))&&(s=g,o="after");return this.redraw(),!0}i=i[0]}if(!(i=i&&i.id?i:this.get_node(i))||i.id===e.jstree.root)return!1;if(h=(i.parent||e.jstree.root).toString(),u=o.toString().match(/^(before|after)$/)&&s.id!==e.jstree.root?this.get_node(s.parent):s,p=l||(this._model.data[i.id]?this:e.jstree.reference(i.id)),_=!p||!p._id||this._id!==p._id,m=p&&p._id&&h&&p._model.data[h]&&p._model.data[h].children?e.inArray(i.id,p._model.data[h].children):-1,p&&p._id&&(i=p._model.data[i.id]),_)return!!(g=this.copy_node(i,s,o,a,r,!1,l))&&(p&&p.delete_node(i),g);switch(s.id===e.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":o=e.inArray(s.id,u.children);break;case"after":o=e.inArray(s.id,u.children)+1;break;case"inside":case"first":o=0;break;case"last":o=u.children.length;break;default:o||(o=0)}if(o>u.children.length&&(o=u.children.length),!this.check("move_node",i,u,o,{core:!0,origin:l,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===u.id){for(f=u.children.concat(),g=e.inArray(i.id,f),-1!==g&&(f=e.vakata.array_remove(f,g),o>g&&o--),g=[],v=0,y=f.length;y>v;v++)g[v>=o?v+1:v]=f[v];g[o]=i.id,u.children=g,this._node_changed(u.id),this.redraw(u.id===e.jstree.root)}else{for(g=i.children_d.concat(),g.push(i.id),v=0,y=i.parents.length;y>v;v++){for(f=[],k=p._model.data[i.parents[v]].children_d,b=0,C=k.length;C>b;b++)-1===e.inArray(k[b],g)&&f.push(k[b]);p._model.data[i.parents[v]].children_d=f}for(p._model.data[h].children=e.vakata.array_remove_item(p._model.data[h].children,i.id),v=0,y=u.parents.length;y>v;v++)this._model.data[u.parents[v]].children_d=this._model.data[u.parents[v]].children_d.concat(g);for(f=[],v=0,y=u.children.length;y>v;v++)f[v>=o?v+1:v]=u.children[v];for(f[o]=i.id,u.children=f,u.children_d.push(i.id),u.children_d=u.children_d.concat(i.children_d),i.parent=u.id,g=u.parents.concat(),g.unshift(u.id),k=i.parents.length,i.parents=g,g=g.concat(),v=0,y=i.children_d.length;y>v;v++)this._model.data[i.children_d[v]].parents=this._model.data[i.children_d[v]].parents.slice(0,-1*k),Array.prototype.push.apply(this._model.data[i.children_d[v]].parents,g);(h===e.jstree.root||u.id===e.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(u.id)),n||this.redraw()}return a&&a.call(this,i,u,o),this.trigger("move_node",{node:i,parent:u.id,position:o,old_parent:h,old_position:m,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),i.id},copy_node:function(i,s,o,a,r,n,l){var c,d,h,m,u,p,_,f,g,v;if(s=this.get_node(s),o=o===t?0:o,!s)return!1;if(!o.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(s))return this.load_node(s,function(){
this.copy_node(i,s,o,a,!0,!1,l)});if(e.isArray(i)){if(1!==i.length){for(c=0,d=i.length;d>c;c++)(m=this.copy_node(i[c],s,o,a,r,!0,l))&&(s=m,o="after");return this.redraw(),!0}i=i[0]}if(!(i=i&&i.id?i:this.get_node(i))||i.id===e.jstree.root)return!1;switch(f=(i.parent||e.jstree.root).toString(),g=o.toString().match(/^(before|after)$/)&&s.id!==e.jstree.root?this.get_node(s.parent):s,v=l||(this._model.data[i.id]?this:e.jstree.reference(i.id)),!v||!v._id||this._id!==v._id,v&&v._id&&(i=v._model.data[i.id]),s.id===e.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":o=e.inArray(s.id,g.children);break;case"after":o=e.inArray(s.id,g.children)+1;break;case"inside":case"first":o=0;break;case"last":o=g.children.length;break;default:o||(o=0)}if(o>g.children.length&&(o=g.children.length),!this.check("copy_node",i,g,o,{core:!0,origin:l,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(_=v?v.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i))return!1;if(!0===_.id&&delete _.id,!(_=this._parse_model_from_json(_,g.id,g.parents.concat())))return!1;for(m=this.get_node(_),i&&i.state&&!1===i.state.loaded&&(m.state.loaded=!1),h=[],h.push(_),h=h.concat(m.children_d),this.trigger("model",{nodes:h,parent:g.id}),u=0,p=g.parents.length;p>u;u++)this._model.data[g.parents[u]].children_d=this._model.data[g.parents[u]].children_d.concat(h);for(h=[],u=0,p=g.children.length;p>u;u++)h[u>=o?u+1:u]=g.children[u];return h[o]=m.id,g.children=h,g.children_d.push(m.id),g.children_d=g.children_d.concat(m.children_d),g.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(g.id),n||this.redraw(g.id===e.jstree.root),a&&a.call(this,m,g,o),this.trigger("copy_node",{node:m,original:i,parent:g.id,position:o,old_parent:f,old_position:v&&v._id&&f&&v._model.data[f]&&v._model.data[f].children?e.inArray(i.id,v._model.data[f].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),m.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,s,o,l=[];for(s=0,o=t.length;o>s;s++)(i=this.get_node(t[s]))&&i.id&&i.id!==e.jstree.root&&l.push(i);return!!l.length&&(a=l,n=this,r="move_node",void this.trigger("cut",{node:t}))},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,s,o,l=[];for(s=0,o=t.length;o>s;s++)(i=this.get_node(t[s]))&&i.id&&i.id!==e.jstree.root&&l.push(i);return!!l.length&&(a=l,n=this,r="copy_node",void this.trigger("copy",{node:t}))},get_buffer:function(){return{mode:r,node:a,inst:n}},can_paste:function(){return!1!==r&&!1!==a},paste:function(e,t){return!!((e=this.get_node(e))&&r&&r.match(/^(copy_node|move_node)$/)&&a)&&(this[r](a,e,t,!1,!1,!1,n)&&this.trigger("paste",{parent:e.id,node:a,mode:r}),a=!1,r=!1,void(n=!1))},clear_buffer:function(){a=!1,r=!1,n=!1,this.trigger("clear_buffer")},edit:function(t,i,s){var o,a,r,n,l,c,h,m,u,p=!1;return!!(t=this.get_node(t))&&(!1===this.settings.core.check_callback?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(u=t,i="string"==typeof i?i:t.text,this.set_text(t,""),t=this._open_to(t),u.text=i,o=this._data.core.rtl,a=this.element.width(),this._data.core.focused=u.id,r=t.children(".jstree-anchor").focus(),n=e("<span>"),l=i,c=e("<div />",{css:{position:"absolute",top:"-200px",left:o?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=e("<input />",{value:l,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation(),i.preventDefault();var o,a=n.children(".jstree-rename-input"),d=a.val(),m=this.settings.core.force_text;""===d&&(d=l),c.remove(),n.replaceWith(r),n.remove(),l=m?l:e("<div></div>").append(e.parseHTML(l)).html(),this.set_text(t,l),o=!!this.rename_node(t,m?e("<div></div>").text(d).text():e("<div></div>").append(e.parseHTML(d)).html()),o||this.set_text(t,l),this._data.core.focused=u.id,setTimeout(e.proxy(function(){var e=this.get_node(u.id,!0);e.length&&(this._data.core.focused=u.id,e.children(".jstree-anchor").focus())},this),0),s&&s.call(this,u,o,p),h=null},this),keydown:function(e){var t=e.which;27===t&&(p=!0,this.value=l),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(c.text("pW"+this.value).width(),a))},keypress:function(e){return 13!==e.which&&void 0}}),m={fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||""},n.attr("class",r.attr("class")).append(r.contents().clone()).append(h),r.replaceWith(n),c.css(m),h.css(m).width(Math.min(c.text("pW"+h[0].value).width(),a))[0].select(),void e(d).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})))},set_theme:function(t,i){if(!t)return!1;if(!0===i){var s=this.settings.core.themes.dir;s||(s=e.jstree.path+"/themes"),i=s+"/"+t+"/style.css"}i&&-1===e.inArray(i,l)&&(e("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),l.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,s){var o,a,r,n;if(e.isArray(i)){for(i=i.slice(),o=0,a=i.length;a>o;o++)this.set_icon(i[o],s);return!0}return!(!(i=this.get_node(i))||i.id===e.jstree.root)&&(n=i.icon,i.icon=!0===s||null===s||s===t||""===s||s,r=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===s?this.hide_icon(i):!0===s||null===s||s===t||""===s?(r.removeClass("jstree-themeicon-custom "+n).css("background","").removeAttr("rel"),!1===n&&this.show_icon(i)):-1===s.indexOf("/")&&-1===s.indexOf(".")?(r.removeClass(n).css("background",""),r.addClass(s+" jstree-themeicon-custom").attr("rel",s),!1===n&&this.show_icon(i)):(r.removeClass(n).css("background",""),r.addClass("jstree-themeicon-custom").css("background","url('"+s+"') center center no-repeat").attr("rel",s),!1===n&&this.show_icon(i)),!0)},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var i,s;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.hide_icon(t[i]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var i,s,o;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.show_icon(t[i]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(o=this.get_node(t,!0),t.icon=!o.length||o.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),o.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,i){t=e(t)[0];var s=i?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,o){-1===e.inArray(o.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==o.value&&""!==e.trim(o.value)&&(i?s[o.name]=o.value:s.push(o.name))}),s},e.vakata.array_unique=function(e){var i,s,o=[],a={};for(i=0,s=e.length;s>i;i++)a[e[i]]===t&&(o.push(e[i]),a[e[i]]=!0);return o},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,i){var s=e.inArray(i,t);return-1!==s?e.vakata.array_remove(t,s):t},e.vakata.array_filter=function(e,t,i,s,o){if(e.filter)return e.filter(t,i);s=[];for(o in e)~~o+""==o+""&&o>=0&&t.call(i,e[o],+o,e)&&s.push(e[o]);return s},e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,s){var o,a;if(s||(s={}),"changed"===e.replace(".jstree","")){s.changed={selected:[],deselected:[]};var r={};for(o=0,a=i.length;a>o;o++)r[i[o]]=1;for(o=0,a=s.selected.length;a>o;o++)r[s.selected[o]]?r[s.selected[o]]=2:s.changed.selected.push(s.selected[o]);for(o=0,a=i.length;a>o;o++)1===r[i[o]]&&s.changed.deselected.push(i[o]);i=s.selected.slice()}t.trigger.call(this,e,s)},this.refresh=function(e,s){return i=[],t.refresh.apply(this,arguments)}};var m=d.createElement("I");m.className="jstree-icon jstree-checkbox",m.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(i,s){this.bind=function(){s.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var i,s,o=this._model.data,a=(o[t.parent],t.nodes);for(i=0,s=a.length;s>i;i++)o[a[i]].state.checked=o[a[i]].state.checked||o[a[i]].original&&o[a[i]].original.state&&o[a[i]].original.state.checked,o[a[i]].state.checked&&this._data.checkbox.selected.push(a[i])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,i){var s,o,a,r,n,l,c=this._model.data,d=c[i.parent],h=i.nodes,m=[],u=this.settings.checkbox.cascade,p=this.settings.checkbox.tie_selection;if(-1!==u.indexOf("down"))if(d.state[p?"selected":"checked"]){for(o=0,a=h.length;a>o;o++)c[h[o]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(h)}else for(o=0,a=h.length;a>o;o++)if(c[h[o]].state[p?"selected":"checked"]){for(r=0,n=c[h[o]].children_d.length;n>r;r++)c[c[h[o]].children_d[r]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(c[h[o]].children_d)}if(-1!==u.indexOf("up")){for(o=0,a=d.children_d.length;a>o;o++)c[d.children_d[o]].children.length||m.push(c[d.children_d[o]].parent);for(m=e.vakata.array_unique(m),r=0,n=m.length;n>r;r++)for(d=c[m[r]];d&&d.id!==e.jstree.root;){for(s=0,o=0,a=d.children.length;a>o;o++)s+=c[d.children[o]].state[p?"selected":"checked"];if(s!==a)break;d.state[p?"selected":"checked"]=!0,this._data[p?"core":"checkbox"].selected.push(d.id),l=this.get_node(d,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(p?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}}this._data[p?"core":"checkbox"].selected=e.vakata.array_unique(this._data[p?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var s,o,a,r,n=i.node,l=this._model.data,c=this.get_node(n.parent),d=this.get_node(n,!0),h=this.settings.checkbox.cascade,m=this.settings.checkbox.tie_selection,u={},p=this._data[m?"core":"checkbox"].selected;for(s=0,o=p.length;o>s;s++)u[p[s]]=!0;if(-1!==h.indexOf("down"))for(s=0,o=n.children_d.length;o>s;s++)u[n.children_d[s]]=!0,r=l[n.children_d[s]],r.state[m?"selected":"checked"]=!0,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&c.id!==e.jstree.root;){for(a=0,s=0,o=c.children.length;o>s;s++)a+=l[c.children[s]].state[m?"selected":"checked"];if(a!==o)break;c.state[m?"selected":"checked"]=!0,u[c.id]=!0,r=this.get_node(c,!0),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}p=[];for(s in u)u.hasOwnProperty(s)&&p.push(s);this._data[m?"core":"checkbox"].selected=p,-1!==h.indexOf("down")&&d.length&&d.find(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var s,o,a,r=this.get_node(e.jstree.root),n=this._model.data;for(s=0,o=r.children_d.length;o>s;s++)(a=n[r.children_d[s]])&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var s,o,a,r=i.node,n=this.get_node(r,!0),l=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection,d=this._data[c?"core":"checkbox"].selected,h={};if(r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1),-1!==l.indexOf("down"))for(s=0,o=r.children_d.length;o>s;s++)a=this._model.data[r.children_d[s]],a.state[c?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(-1!==l.indexOf("up"))for(s=0,o=r.parents.length;o>s;s++)a=this._model.data[r.parents[s]],a.state[c?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),(a=this.get_node(r.parents[s],!0))&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(h={},s=0,o=d.length;o>s;s++)-1!==l.indexOf("down")&&-1!==e.inArray(d[s],r.children_d)||-1!==l.indexOf("up")&&-1!==e.inArray(d[s],r.parents)||(h[d[s]]=!0);d=[];for(s in h)h.hasOwnProperty(s)&&d.push(s);this._data[c?"core":"checkbox"].selected=d,-1!==l.indexOf("down")&&n.length&&n.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,i){for(var s,o,a,r,n=this.get_node(i.parent),l=this._model.data,c=this.settings.checkbox.tie_selection;n&&n.id!==e.jstree.root&&!n.state[c?"selected":"checked"];){for(a=0,s=0,o=n.children.length;o>s;s++)a+=l[n.children[s]].state[c?"selected":"checked"];if(!(o>0&&a===o))break;n.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(n.id),r=this.get_node(n,!0),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var s,o,a,r,n,l=i.is_multi,c=i.old_parent,d=this.get_node(i.parent),h=this._model.data,m=this.settings.checkbox.tie_selection;if(!l)for(s=this.get_node(c);s&&s.id!==e.jstree.root&&!s.state[m?"selected":"checked"];){for(o=0,a=0,r=s.children.length;r>a;a++)o+=h[s.children[a]].state[m?"selected":"checked"];if(!(r>0&&o===r))break;s.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(s.id),n=this.get_node(s,!0),n&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),s=this.get_node(s.parent)}for(s=d;s&&s.id!==e.jstree.root;){for(o=0,a=0,r=s.children.length;r>a;a++)o+=h[s.children[a]].state[m?"selected":"checked"];if(o===r)s.state[m?"selected":"checked"]||(s.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(s.id),(n=this.get_node(s,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"));else{if(!s.state[m?"selected":"checked"])break;s.state[m?"selected":"checked"]=!1,this._data[m?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[m?"core":"checkbox"].selected,s.id),(n=this.get_node(s,!0))&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(m?"jstree-clicked":"jstree-checked")}s=this.get_node(s.parent)}},this))},this._undetermined=function(){if(null!==this.element){var i,s,o,a,r={},n=this._model.data,l=this.settings.checkbox.tie_selection,c=this._data[l?"core":"checkbox"].selected,d=[],h=this;for(i=0,s=c.length;s>i;i++)if(n[c[i]]&&n[c[i]].parents)for(o=0,a=n[c[i]].parents.length;a>o&&r[n[c[i]].parents[o]]===t;o++)n[c[i]].parents[o]!==e.jstree.root&&(r[n[c[i]].parents[o]]=!0,d.push(n[c[i]].parents[o]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var l,c=h.get_node(this);if(c.state.loaded){for(i=0,s=c.children_d.length;s>i;i++)if(l=n[c.children_d[i]],!l.state.loaded&&l.original&&l.original.state&&l.original.state.undetermined&&!0===l.original.state.undetermined)for(r[l.id]===t&&l.id!==e.jstree.root&&(r[l.id]=!0,d.push(l.id)),o=0,a=l.parents.length;a>o;o++)r[l.parents[o]]===t&&l.parents[o]!==e.jstree.root&&(r[l.parents[o]]=!0,d.push(l.parents[o]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&!0===c.original.state.undetermined)for(r[c.id]===t&&c.id!==e.jstree.root&&(r[c.id]=!0,d.push(c.id)),o=0,a=c.parents.length;a>o;o++)r[c.parents[o]]===t&&c.parents[o]!==e.jstree.root&&(r[c.parents[o]]=!0,d.push(c.parents[o]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,s=d.length;s>i;i++)n[d[i]].state[l?"selected":"checked"]||(c=this.get_node(d[i],!0))&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,i,o,a){if(t=s.redraw_node.apply(this,arguments)){var r,n,l=null,c=null;for(r=0,n=t.childNodes.length;n>r;r++)if(t.childNodes[r]&&t.childNodes[r].className&&-1!==t.childNodes[r].className.indexOf("jstree-anchor")){l=t.childNodes[r];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(l.className+=" jstree-checked"),c=m.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),l.insertBefore(c,l.childNodes[0]))}return o||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var i,s,o=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection,r=this._data[a?"core":"checkbox"].selected,n=this._model.data;if(!t||!0===t.state[a?"selected":"checked"]||-1===o.indexOf("undetermined")||-1===o.indexOf("down")&&-1===o.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(i=0,s=t.children_d.length;s>i;i++)if(-1!==e.inArray(t.children_d[i],r)||!n[t.children_d[i]].state.loaded&&n[t.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var i,s,o;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.disable_checkbox(t[i]);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(o=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,o&&o.length&&o.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))))},this.enable_checkbox=function(t){var i,s,o;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;s>i;i++)this.enable_checkbox(t[i]);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(o=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,o&&o.length&&o.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))))},this.activate_node=function(t,i){return!e(i.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")?s.activate_node.call(this,t,i):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var s,o,a;if(e.isArray(t)){for(t=t.slice(),o=0,a=t.length;a>o;o++)this.check_node(t[o],i);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),s&&s.length&&s.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var s,o,a;if(e.isArray(t)){for(t=t.slice(),s=0,o=t.length;o>s;s++)this.uncheck_node(t[s],i);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,i;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,i=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var i,s,o,a,r=this.get_checked(!0),n={};for(i=0,s=r.length;s>i;i++)n[r[i].id]=r[i];for(i=0,s=r.length;s>i;i++)for(o=0,a=r[i].children_d.length;a>o;o++)n[r[i].children_d[o]]&&delete n[r[i].children_d[o]];r=[];for(i in n)n.hasOwnProperty(i)&&r.push(i);return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var i,s,o=this.get_checked(!0),a=[];for(i=0,s=o.length;s>i;i++)o[i].children.length||a.push(o[i].id);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.load_node=function(t,i){var o,a,r;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(r=this.get_node(t))&&r.state.loaded)for(o=0,a=r.children_d.length;a>o;o++)this._model.data[r.children_d[o]].state.checked&&(!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,r.children_d[o]));return s.load_node.apply(this,arguments)},this.get_state=function(){var e=s.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,i){var o=s.set_state.apply(this,arguments);if(o&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var a=this;e.each(t.checkbox,function(e,t){a.check_node(t)})}return delete t.checkbox,this.set_state(t,i),!1}return o},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),s.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){this.settings.conditionalselect.call(this,this.get_node(e),i)&&t.activate_node.call(this,e,i)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.create_node(s,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.edit(s)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.is_selected(s)?i.delete_node(i.get_selected()):i.delete_node(s)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.is_selected(s)?i.cut(i.get_top_selected()):i.cut(s)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.is_selected(s)?i.copy(i.get_top_selected()):i.copy(s)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),s=i.get_node(t.reference);i.paste(s)}}}}}}},e.jstree.plugins.contextmenu=function(i,s){this.bind=function(){s.bind.call(this);var t,i,o=0,a=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),o=e.ctrlKey?+new Date:0,(t||a)&&(o=+new Date+1e4),a&&clearTimeout(a),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!o||+new Date-o>250)&&e.vakata.context.hide(),o=0},this)).on("touchstart.jstree",".jstree-anchor",function(s){s.originalEvent&&s.originalEvent.changedTouches&&s.originalEvent.changedTouches[0]&&(t=s.originalEvent.changedTouches[0].clientX,i=s.originalEvent.changedTouches[0].clientY,a=setTimeout(function(){e(s.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){a&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.originalEvent.changedTouches[0].clientX)>50||Math.abs(i-e.originalEvent.changedTouches[0].clientY)>50)&&clearTimeout(a)}).on("touchend.vakata.jstree",function(e){a&&clearTimeout(a)}),e(d).on("context_hide.vakata.jstree",e.proxy(function(t,i){this._data.contextmenu.visible=!1,e(i.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),s.teardown.call(this)},this.show_contextmenu=function(i,s,o,a){if(!(i=this.get_node(i))||i.id===e.jstree.root)return!1;var r=this.settings.contextmenu,n=this.get_node(i,!0),l=n.children(".jstree-anchor"),c=!1,d=!1;(r.show_at_node||s===t||o===t)&&(c=l.offset(),s=c.left,o=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,a),d=r.items,e.isFunction(d)&&(d=d.call(this,i,e.proxy(function(e){this._show_contextmenu(i,s,o,e)},this))),e.isPlainObject(d)&&this._show_contextmenu(i,s,o,d)},this._show_contextmenu=function(t,i,s,o){var a=this.get_node(t,!0),r=a.children(".jstree-anchor");e(d).one("context_show.vakata.jstree",e.proxy(function(t,i){var s="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(s),r.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(r,{x:i,y:s},o),this.trigger("show_contextmenu",{node:t,x:i,y:s})}},function(e){var t=!1,i={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(d).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){return!(!(t=i.items[t])||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:i.reference,element:i.element}))||!t.action)&&t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_parse:function(t,s){if(!t)return!1;s||(i.html="",i.items=[]);var o,a="",r=!1;return s&&(a+="<ul>"),e.each(t,function(t,s){return!s||(i.items.push(s),!r&&s.separator_before&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),r=!1,a+="<li class='"+(s._class||"")+(!0===s._disabled||e.isFunction(s._disabled)&&s._disabled({item:s,reference:i.reference,
element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(s.shortcut?" data-shortcut='"+s.shortcut+"' ":"")+">",a+="<a href='#' rel='"+(i.items.length-1)+"' "+(s.title?"title='"+s.title+"'":"")+">",e.vakata.context.settings.icons&&(a+="<i ",s.icon&&(a+=-1!==s.icon.indexOf("/")||-1!==s.icon.indexOf(".")?" style='background:url(\""+s.icon+"\") center center no-repeat' ":" class='"+s.icon+"' "),a+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),a+=(e.isFunction(s.label)?s.label({item:t,reference:i.reference,element:i.element}):s.label)+(s.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+s.shortcut+'">'+(s.shortcut_label||"")+"</span>":"")+"</a>",s.submenu&&(o=e.vakata.context._parse(s.submenu,!0))&&(a+=o),a+="</li>",void(s.separator_after&&(a+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",r=!0)))}),a=a.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),s&&(a+="</ul>"),s||(i.html=a,e.vakata.context._trigger("parse")),a.length>10&&a},_show_submenu:function(i){if(i=e(i),i.length&&i.children("ul").length){var s=i.children("ul"),o=i.offset().left,a=o+i.outerWidth(),r=i.offset().top,n=s.width(),l=s.height(),c=e(window).width()+e(window).scrollLeft(),d=e(window).height()+e(window).scrollTop();t?i[a-(n+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):i[a+n>c&&o>c-a?"addClass":"removeClass"]("vakata-context-right"),r+l+10>d&&s.css("bottom","-1px"),i.hasClass("vakata-context-right")?n>o&&s.css("margin-right",o-n):n>c-a&&s.css("margin-left",c-a-n),s.show()}},show:function(s,o,a){var r,n,l,c,d,h,m,u;switch(i.element&&i.element.length&&i.element.width(""),!0){case!o&&!s:return!1;case!!o&&!!s:i.reference=s,i.position_x=o.x,i.position_y=o.y;break;case!o&&!!s:i.reference=s,r=s.offset(),i.position_x=r.left+s.outerHeight(),i.position_y=r.top;break;case!!o&&!s:i.position_x=o.x,i.position_y=o.y}s&&!a&&e(s).data("vakata_contextmenu")&&(a=e(s).data("vakata_contextmenu")),e.vakata.context._parse(a)&&i.element.html(i.html),i.items.length&&(i.element.appendTo("body"),n=i.element,l=i.position_x,c=i.position_y,d=n.width(),h=n.height(),m=e(window).width()+e(window).scrollLeft(),u=e(window).height()+e(window).scrollTop(),t&&(l-=n.outerWidth()-e(s).outerWidth())<e(window).scrollLeft()+20&&(l=e(window).scrollLeft()+20),l+d+20>m&&(l=m-(d+20)),c+h+20>u&&(c=u-(h+20)),i.element.css({left:l,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),i.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){i.is_visible&&(i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),i.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var s=!1;i.element=e("<ul class='vakata-context'></ul>"),i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(s&&clearTimeout(s),i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(s=setTimeout(function(t){return function(){e.vakata.context.hide()}}(),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||!1===e.vakata.context._execute(e(this).attr("rel"))||e.vakata.context.hide()}).on("keydown","a",function(t){var s=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:i.is_visible&&(i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:i.is_visible&&(s=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),s.length||(s=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),s.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:i.is_visible&&(i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:i.is_visible&&(s=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),s.length||(s=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),s.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(d).on("mousedown.vakata.jstree",function(t){i.is_visible&&!e.contains(i.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,s){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&i.element.addClass("vakata-context-rtl").css("direction","rtl"),i.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var u,p;e.jstree.plugins.dnd=function(t,i){this.init=function(e,t){i.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in d.createElement("span")},this.bind=function(){i.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),s=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,o=s>1?s+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(o=e.vakata.html.escape(o)),i&&i.id&&i.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,s>1?this.get_top_selected(!0):[i],t))){if(u={jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:s>1?this.get_top_selected():[i.id]},p=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,u,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+o+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:p,data:u})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:p,data:u}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:p,data:u}),!1},this))},this.redraw_node=function(e,t,s,o){if((e=i.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var a,r,n=null;for(a=0,r=e.childNodes.length;r>a;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){n=e.childNodes[a];break}n&&n.setAttribute("draggable",!0)}return e}},e(function(){var i=!1,s=!1,o=!1,a=!1,r=e('<div id="jstree-marker">&#160;</div>').hide();e(d).on("dnd_start.vakata.jstree",function(e,t){i=!1,o=!1,t&&t.data&&t.data.jstree&&r.appendTo("body")}).on("dnd_move.vakata.jstree",function(n,l){if(a&&(l.event&&"dragover"===l.event.type&&l.event.target===o.target||clearTimeout(a)),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){o=l.event;var c,d,h,m,u,p,_,f,g,v,y,b,C,k,w,x,$=e.jstree.reference(l.event.target),T=!1,j=!1,I=!1;if($&&$._data&&$._data.dnd)if(r.attr("class","jstree-"+$.get_theme()+($.settings.core.themes.responsive?" jstree-dnd-responsive":"")),w=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+$.get_theme()+" jstree-"+$.get_theme()+"-"+$.get_theme_variant()+" "+($.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[w?"show":"hide"](),l.event.target!==$.element[0]&&l.event.target!==$.get_container_ul()[0]||0!==$.get_container_ul().children().length){if((T=$.settings.dnd.large_drop_target?e(l.event.target).closest(".jstree-node").children(".jstree-anchor"):e(l.event.target).closest(".jstree-anchor"))&&T.length&&T.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(j=T.offset(),I=(l.event.pageY!==t?l.event.pageY:l.event.originalEvent.pageY)-j.top,h=T.outerHeight(),p=h/3>I?["b","i","a"]:I>h-h/3?["a","i","b"]:I>h/2?["i","a","b"]:["i","b","a"],e.each(p,function(t,o){switch(o){case"b":c=j.left-6,d=j.top,m=$.get_parent(T),u=T.parent().index();break;case"i":C=$.settings.dnd.inside_pos,k=$.get_node(T.parent()),c=j.left-2,d=j.top+h/2+1,m=k.id,u="first"===C?0:"last"===C?k.children.length:Math.min(C,k.children.length);break;case"a":c=j.left-6,d=j.top+h,m=$.get_parent(T),u=T.parent().index()+1}for(_=!0,f=0,g=l.data.nodes.length;g>f;f++)if(v=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",y=u,"move_node"===v&&"a"===o&&l.data.origin&&l.data.origin===$&&m===$.get_parent(l.data.nodes[f])&&(b=$.get_node(m),y>e.inArray(l.data.nodes[f],b.children)&&(y-=1)),!(_=_&&($&&$.settings&&$.settings.dnd&&!1===$.settings.dnd.check_while_dragging||$.check(v,l.data.origin&&l.data.origin!==$?l.data.origin.get_node(l.data.nodes[f]):l.data.nodes[f],m,y,{dnd:!0,ref:$.get_node(T.parent()),pos:o,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==$,is_foreign:!l.data.origin})))){$&&$.last_error&&(s=$.last_error());break}return"i"===o&&T.parent().is(".jstree-closed")&&$.settings.dnd.open_timeout&&(a=setTimeout(function(e,t){return function(){e.open_node(t)}}($,T),$.settings.dnd.open_timeout)),_?(x=$.get_node(m,!0),x.hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),x.addClass("jstree-dnd-parent")),i={ins:$,par:m,pos:"i"!==o||"last"!==C||0!==u||$.is_loaded(k)?u:"last"},r.css({left:c+"px",top:d+"px"}).show(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=w?"copy":"move"),s={},p=!0,!1):void 0}),!0===p))return}else{for(_=!0,f=0,g=l.data.nodes.length;g>f&&(_=_&&$.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==$?l.data.origin.get_node(l.data.nodes[f]):l.data.nodes[f],e.jstree.root,"last",{dnd:!0,ref:$.get_node(e.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==$,is_foreign:!l.data.origin}));f++);if(_)return i={ins:$,par:e.jstree.root,pos:"last"},r.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=w?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),i=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect="none"),r.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(r.hide(),i=!1,o=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,n){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),a&&clearTimeout(a),n&&n.data&&n.data.jstree){r.hide().detach();var l,c,d=[];if(i){for(l=0,c=n.data.nodes.length;c>l;l++)d[l]=n.data.origin?n.data.origin.get_node(n.data.nodes[l]):n.data.nodes[l];i.ins[n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(n.event.metaKey||n.event.ctrlKey))?"copy_node":"move_node"](d,i.par,i.pos,!1,!1,!1,n.data.origin)}else l=e(n.event.target).closest(".jstree"),l.length&&s&&s.error&&"check"===s.error&&(l=l.jstree(!0))&&l.settings.core.error.call(this,s);o=!1,i=!1}}).on("keyup.jstree keydown.jstree",function(t,n){(n=e.vakata.dnd._get())&&n.data&&n.data.jstree&&("keyup"===t.type&&27===t.which?(a&&clearTimeout(a),i=!1,s=!1,o=!1,a=!1,r.hide().detach(),e.vakata.dnd._clean()):(n.helper.find(".jstree-copy").first()[n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),o&&(o.metaKey=t.metaKey,o.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",o))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var i={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(i,s,o){o===t&&(o=e.vakata.dnd._get()),o.event=s,e(d).triggerHandler("dnd_"+i+".vakata",o)},_get:function(){return{data:i.data,element:i.element,helper:i.helper}},_clean:function(){i.helper&&i.helper.remove(),i.scroll_i&&(clearInterval(i.scroll_i),i.scroll_i=!1),i={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(d).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!i.scroll_e||!i.scroll_l&&!i.scroll_t)return i.scroll_i&&(clearInterval(i.scroll_i),i.scroll_i=!1),!1;if(!i.scroll_i)return i.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===t)return!1;var s=i.scroll_e.scrollTop(),o=i.scroll_e.scrollLeft();i.scroll_e.scrollTop(s+i.scroll_t*e.vakata.dnd.settings.scroll_speed),i.scroll_e.scrollLeft(o+i.scroll_l*e.vakata.dnd.settings.scroll_speed),(s!==i.scroll_e.scrollTop()||o!==i.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",i.scroll_e)},start:function(t,s,o){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),i.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return i.init_x=t.pageX,i.init_y=t.pageY,i.data=s,i.is_down=!0,i.element=t.currentTarget,i.target=t.target,i.is_touch="touchstart"===t.type,!1!==o&&(i.helper=e("<div id='vakata-dnd'></div>").html(o).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(d).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),i.is_down){if(!i.is_drag){if(!(Math.abs(t.pageX-i.init_x)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-i.init_y)>(i.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;i.helper&&(i.helper.appendTo("body"),i.helper_w=i.helper.outerWidth()),i.is_drag=!0,e(i.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var s=!1,o=!1,a=!1,r=!1,n=!1,l=!1,c=!1,h=!1,m=!1,u=!1;return i.scroll_t=0,i.scroll_l=0,i.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var s=e(this),o=s.offset();return this.scrollHeight>this.offsetHeight&&(o.top+s.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=1),t.pageY-o.top<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(o.left+s.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=1),t.pageX-o.left<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=-1)),i.scroll_t||i.scroll_l?(i.scroll_e=e(this),!1):void 0}),i.scroll_e||(s=e(d),o=e(window),a=s.height(),r=o.height(),n=s.width(),l=o.width(),c=s.scrollTop(),h=s.scrollLeft(),a>r&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=-1),a>r&&r-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_t=1),n>l&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=-1),n>l&&l-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(i.scroll_l=1),(i.scroll_t||i.scroll_l)&&(i.scroll_e=s)),i.scroll_e&&e.vakata.dnd._scroll(!0),i.helper&&(m=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),u=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),a&&m+25>a&&(m=a-50),n&&u+i.helper_w>n&&(u=n-(i.helper_w+2)),i.helper.css({left:u+"px",top:m+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),i.is_drag)t.target!==i.target&&e(i.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===i.target){var s=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){s&&clearTimeout(s)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,i){this.init=function(e,t){this._data.massload={},i.init.call(this,e,t)},this._load_nodes=function(t,s,o,a){var r,n,l,c=this.settings.massload,d=(JSON.stringify(t),[]),h=this._model.data;if(!o){for(r=0,n=t.length;n>r;r++)(!h[t[r]]||!h[t[r]].state.loaded&&!h[t[r]].state.failed||a)&&(d.push(t[r]),(l=this.get_node(t[r],!0))&&l.length&&l.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},d.length){if(e.isFunction(c))return c.call(this,d,e.proxy(function(e){var r,n;if(e)for(r in e)e.hasOwnProperty(r)&&(this._data.massload[r]=e[r]);for(r=0,n=t.length;n>r;r++)(l=this.get_node(t[r],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,s,o,a)},this));if("object"==typeof c&&c&&c.url)return c=e.extend(!0,{},c),e.isFunction(c.url)&&(c.url=c.url.call(this,d)),e.isFunction(c.data)&&(c.data=c.data.call(this,d)),e.ajax(c).done(e.proxy(function(e,r,n){var c,d;if(e)for(c in e)e.hasOwnProperty(c)&&(this._data.massload[c]=e[c]);for(c=0,d=t.length;d>c;c++)(l=this.get_node(t[c],!0))&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,s,o,a)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,s,o,a)},this))}}return i._load_nodes.call(this,t,s,o,a)},this._load_node=function(t,s){var o,a=this._data.massload[t.id],r=null;return a?(r=this["string"==typeof a?"_append_html_data":"_append_json_data"](t,"string"==typeof a?e(e.parseHTML(a)).filter(function(){return 3!==this.nodeType}):a,function(e){s.call(this,e)}),o=this.get_node(t.id,!0),o&&o.length&&o.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],r):i._load_node.call(this,t,s)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(i,s){this.bind=function(){s.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var s,o,a,r,n=this._model.data,l=[];for(s=0,o=i.res.length;o>s;s++)if(n[i.res[s]]&&!n[i.res[s]].state.hidden&&(l.push(i.res[s]),l=l.concat(n[i.res[s]].parents),this._data.search.smc))for(a=0,r=n[i.res[s]].children_d.length;r>a;a++)n[n[i.res[s]].children_d[a]]&&!n[n[i.res[s]].children_d[a]].state.hidden&&l.push(n[i.res[s]].children_d[a]);l=e.vakata.array_remove_item(e.vakata.array_unique(l),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(i,s,o,a,r,n){if(!1===i||""===e.trim(i.toString()))return this.clear_search();a=this.get_node(a),a=a&&a.id?a.id:null,i=i.toString();var l,c,d=this.settings.search,h=!!d.ajax&&d.ajax,m=this._model.data,u=null,p=[],_=[];if(this._data.search.res.length&&!r&&this.clear_search(),o===t&&(o=d.show_only_matches),n===t&&(n=d.show_only_matches_children),!s&&!1!==h)return e.isFunction(h)?h.call(this,i,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,o,a,r)})},this),a):(h=e.extend({},h),h.data||(h.data={}),h.data.str=i,a&&(h.data.inside=a),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,o,a,r)})},this)));if(r||(this._data.search.str=i,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=o,this._data.search.smc=n),u=new e.vakata.search(i,!0,{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy}),e.each(m[a||e.jstree.root].children_d,function(e,t){var s=m[t];s.text&&!s.state.hidden&&(!d.search_leaves_only||s.state.loaded&&0===s.children.length)&&(d.search_callback&&d.search_callback.call(this,i,s)||!d.search_callback&&u.search(s.text).isMatch)&&(p.push(t),_=_.concat(s.parents))}),p.length){for(_=e.vakata.array_unique(_),l=0,c=_.length;c>l;l++)_[l]!==e.jstree.root&&m[_[l]]&&!0===this.open_node(_[l],null,0)&&this._data.search.opn.push(_[l]);r?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(p))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=p),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:o})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,i,o,a){if((t=s.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){var r,n,l=null;for(r=0,n=t.childNodes.length;n>r;r++)if(t.childNodes[r]&&t.childNodes[r].className&&-1!==t.childNodes[r].className.indexOf("jstree-anchor")){l=t.childNodes[r];break}l&&(l.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,i,s){s=s||{},s=e.extend({},e.vakata.search.defaults,s),!1!==s.fuzzy&&(s.fuzzy=!0),t=s.caseSensitive?t:t.toLowerCase();var o,a,r,n,l=s.location,c=s.distance,d=s.threshold,h=t.length;return h>32&&(s.fuzzy=!1),s.fuzzy&&(o=1<<h-1,a=function(){var e={},i=0;for(i=0;h>i;i++)e[t.charAt(i)]=0;for(i=0;h>i;i++)e[t.charAt(i)]|=1<<h-i-1;return e}(),r=function(e,t){var i=e/h,s=Math.abs(l-t);return c?i+s/c:s?1:i}),n=function(e){if(e=s.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!s.fuzzy)return{isMatch:!1,score:1};var i,n,c,m,u,p,_,f,g,v=e.length,y=d,b=e.indexOf(t,l),C=h+v,k=1,w=[];for(-1!==b&&(y=Math.min(r(0,b),y),-1!==(b=e.lastIndexOf(t,l+h))&&(y=Math.min(r(0,b),y))),b=-1,i=0;h>i;i++){for(c=0,m=C;m>c;)r(i,l+m)<=y?c=m:C=m,m=Math.floor((C-c)/2+c);for(C=m,p=Math.max(1,l-m+1),_=Math.min(l+m,v)+h,f=new Array(_+2),f[_+1]=(1<<i)-1,n=_;n>=p;n--)if(g=a[e.charAt(n-1)],f[n]=0===i?(f[n+1]<<1|1)&g:(f[n+1]<<1|1)&g|(u[n+1]|u[n])<<1|1|u[n+1],f[n]&o&&(k=r(i,n-1),y>=k)){if(y=k,b=n-1,w.push(b),!(b>l))break;p=Math.max(1,2*l-b)}if(r(i+1,l)>y)break;u=f}return{isMatch:b>=0,score:k}},!0===i?{search:n}:n(i)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,i){var s,o;if((t=this.get_node(t))&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),i))for(s=0,o=t.children_d.length;o>s;s++)this.sort(t.children_d[s],!1)}};var _=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){_&&clearTimeout(_),_=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(i,s){s.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(i,s){this.init=function(i,o){var a,r;if(o&&o.types&&o.types.default)for(a in o.types)if("default"!==a&&a!==e.jstree.root&&o.types.hasOwnProperty(a))for(r in o.types.default)o.types.default.hasOwnProperty(r)&&o.types[a][r]===t&&(o.types[a][r]=o.types.default[r]);s.init.call(this,i,o),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,i){s.refresh.call(this,t,i),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,s){var o,a,r,n=this._model.data,l=s.nodes,c=this.settings.types,d="default";for(o=0,a=l.length;a>o;o++){if(d="default",n[l[o]].original&&n[l[o]].original.type&&c[n[l[o]].original.type]&&(d=n[l[o]].original.type),n[l[o]].data&&n[l[o]].data.jstree&&n[l[o]].data.jstree.type&&c[n[l[o]].data.jstree.type]&&(d=n[l[o]].data.jstree.type),n[l[o]].type=d,!0===n[l[o]].icon&&c[d].icon!==t&&(n[l[o]].icon=c[d].icon),c[d].li_attr!==t&&"object"==typeof c[d].li_attr)for(r in c[d].li_attr)if(c[d].li_attr.hasOwnProperty(r)){if("id"===r)continue;n[l[o]].li_attr[r]===t?n[l[o]].li_attr[r]=c[d].li_attr[r]:"class"===r&&(n[l[o]].li_attr.class=c[d].li_attr.class+" "+n[l[o]].li_attr.class)}if(c[d].a_attr!==t&&"object"==typeof c[d].a_attr)for(r in c[d].a_attr)if(c[d].a_attr.hasOwnProperty(r)){if("id"===r)continue;n[l[o]].a_attr[r]===t?n[l[o]].a_attr[r]=c[d].a_attr[r]:"href"===r&&"#"===n[l[o]].a_attr[r]?n[l[o]].a_attr.href=c[d].a_attr.href:"class"===r&&(n[l[o]].a_attr.class=c[d].a_attr.class+" "+n[l[o]].a_attr.class)}}n[e.jstree.root].type=e.jstree.root},this)),s.bind.call(this)},this.get_json=function(t,i,o){var a,r,n=this._model.data,l=i?e.extend(!0,{},i,{no_id:!1}):{},c=s.get_json.call(this,t,l,o);if(!1===c)return!1;if(e.isArray(c))for(a=0,r=c.length;r>a;a++)c[a].type=c[a].id&&n[c[a].id]&&n[c[a].id].type?n[c[a].id].type:"default",i&&i.no_id&&(delete c[a].id,c[a].li_attr&&c[a].li_attr.id&&delete c[a].li_attr.id,c[a].a_attr&&c[a].a_attr.id&&delete c[a].a_attr.id);else c.type=c.id&&n[c.id]&&n[c.id].type?n[c.id].type:"default",i&&i.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){
if(e.isArray(t)){for(var i=0,s=t.length;s>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(i,o,a,r,n){if(!1===s.check.call(this,i,o,a,r,n))return!1;o=o&&o.id?o:this.get_node(o),a=a&&a.id?a:this.get_node(a);var l,c,d,h,m=o&&o.id?n&&n.origin?n.origin:e.jstree.reference(o.id):null;switch(m=m&&m._model&&m._model.data?m._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===e.inArray(o.id,a.children)){if(l=this.get_rules(a),l.max_children!==t&&-1!==l.max_children&&l.max_children===a.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!o||!o.id)&&o.id,par:!(!a||!a.id)&&a.id})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(o.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!o||!o.id)&&o.id,par:!(!a||!a.id)&&a.id})},!1;if(m&&o.children_d&&o.parents){for(c=0,d=0,h=o.children_d.length;h>d;d++)c=Math.max(c,m[o.children_d[d]].parents.length);c=c-o.parents.length+1}(0>=c||c===t)&&(c=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&l.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:r,obj:!(!o||!o.id)&&o.id,par:!(!a||!a.id)&&a.id})},!1;a=this.get_node(a.parent),l=this.get_rules(a),c++}while(a)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var i=this.get_type(e,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i},this.get_type=function(t,i){return!!(t=this.get_node(t))&&(i?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(i,s){var o,a,r,n,l,c,d,h,m=this._model.data;if(e.isArray(i)){for(i=i.slice(),a=0,r=i.length;r>a;a++)this.set_type(i[a],s);return!0}if(o=this.settings.types,i=this.get_node(i),!o[s]||!i)return!1;if(d=this.get_node(i,!0),d&&d.length&&(h=d.children(".jstree-anchor")),n=i.type,l=this.get_icon(i),i.type=s,(!0===l||o[n]&&o[n].icon!==t&&l===o[n].icon)&&this.set_icon(i,o[s].icon===t||o[s].icon),o[n].li_attr!==t&&"object"==typeof o[n].li_attr)for(c in o[n].li_attr)if(o[n].li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(m[i.id].li_attr.class=(m[i.id].li_attr.class||"").replace(o[n].li_attr[c],""),d&&d.removeClass(o[n].li_attr[c])):m[i.id].li_attr[c]===o[n].li_attr[c]&&(m[i.id].li_attr[c]=null,d&&d.removeAttr(c))}if(o[n].a_attr!==t&&"object"==typeof o[n].a_attr)for(c in o[n].a_attr)if(o[n].a_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(m[i.id].a_attr.class=(m[i.id].a_attr.class||"").replace(o[n].a_attr[c],""),h&&h.removeClass(o[n].a_attr[c])):m[i.id].a_attr[c]===o[n].a_attr[c]&&("href"===c?(m[i.id].a_attr[c]="#",h&&h.attr("href","#")):(delete m[i.id].a_attr[c],h&&h.removeAttr(c)))}if(o[s].li_attr!==t&&"object"==typeof o[s].li_attr)for(c in o[s].li_attr)if(o[s].li_attr.hasOwnProperty(c)){if("id"===c)continue;m[i.id].li_attr[c]===t?(m[i.id].li_attr[c]=o[s].li_attr[c],d&&("class"===c?d.addClass(o[s].li_attr[c]):d.attr(c,o[s].li_attr[c]))):"class"===c&&(m[i.id].li_attr.class=o[s].li_attr[c]+" "+m[i.id].li_attr.class,d&&d.addClass(o[s].li_attr[c]))}if(o[s].a_attr!==t&&"object"==typeof o[s].a_attr)for(c in o[s].a_attr)if(o[s].a_attr.hasOwnProperty(c)){if("id"===c)continue;m[i.id].a_attr[c]===t?(m[i.id].a_attr[c]=o[s].a_attr[c],h&&("class"===c?h.addClass(o[s].a_attr[c]):h.attr(c,o[s].a_attr[c]))):"href"===c&&"#"===m[i.id].a_attr[c]?(m[i.id].a_attr.href=o[s].a_attr.href,h&&h.attr("href",o[s].a_attr.href)):"class"===c&&(m[i.id].a_attr.class=o[s].a_attr.class+" "+m[i.id].a_attr.class,h&&h.addClass(o[s].a_attr[c]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(i,s){this.check=function(t,i,o,a,r){if(!1===s.check.call(this,t,i,o,a,r))return!1;if(i=i&&i.id?i:this.get_node(i),!(o=o&&o.id?o:this.get_node(o))||!o.children)return!0;var n,l,c="rename_node"===t?a:i.text,d=[],h=this.settings.unique.case_sensitive,m=this._model.data;for(n=0,l=o.children.length;l>n;n++)d.push(h?m[o.children[n]].text:m[o.children[n]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return n=-1===e.inArray(c,d)||i.text&&i.text[h?"toString":"toLowerCase"]()===c,n||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!o||!o.id)&&o.id})}),n;case"create_node":return n=-1===e.inArray(c,d),n||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!o||!o.id)&&o.id})}),n;case"copy_node":return n=-1===e.inArray(c,d),n||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!o||!o.id)&&o.id})}),n;case"move_node":return n=i.parent===o.id&&(!r||!r.is_multi)||-1===e.inArray(c,d),n||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!i||!i.id)&&i.id,par:!(!o||!o.id)&&o.id})}),n}return!0},this.create_node=function(i,o,a,r,n){if(!o||o.text===t){if(null===i&&(i=e.jstree.root),!(i=this.get_node(i)))return s.create_node.call(this,i,o,a,r,n);if(a=a===t?"last":a,!a.toString().match(/^(before|after)$/)&&!n&&!this.is_loaded(i))return s.create_node.call(this,i,o,a,r,n);o||(o={});var l,c,d,h,m,u=this._model.data,p=this.settings.unique.case_sensitive,_=this.settings.unique.duplicate;for(c=l=this.get_string("New node"),d=[],h=0,m=i.children.length;m>h;h++)d.push(p?u[i.children[h]].text:u[i.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(p?c:c.toLowerCase(),d);)c=_.call(this,l,++h).toString();o.text=c}return s.create_node.call(this,i,o,a,r,n)}};var f=d.createElement("DIV");if(f.setAttribute("unselectable","on"),f.setAttribute("role","presentation"),f.className="jstree-wholerow",f.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,s,o=!1;for(i=0,s=t.selected.length;s>i;i++)(o=this.get_node(t.selected[i],!0))&&o.length&&o.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,s,o,a){if(t=i.redraw_node.apply(this,arguments)){var r=f.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(r.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(r.className+=" jstree-wholerow-hovered"),t.insertBefore(r,t.childNodes[0])}return t}},d.registerElement&&Object&&Object.create){var g=Object.create(HTMLElement.prototype);g.createdCallback=function(){var t,i={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(i)};try{d.registerElement("vakata-jstree",{prototype:g})}catch(e){}}}}),function(e){"use strict";e.fn.bootstrapSwitch=function(t){var i='input[type!="hidden"]',s={init:function(){return this.each(function(){var t,s,o,a,r,n,l=e(this),c=l.closest("form"),d="",h=l.attr("class"),m="ON",u="OFF",p=!1,_=!1;e.each(["switch-mini","switch-small","switch-large"],function(e,t){h.indexOf(t)>=0&&(d=t)}),l.addClass("has-switch"),void 0!==l.data("on")&&(r="switch-"+l.data("on")),void 0!==l.data("on-label")&&(m=l.data("on-label")),void 0!==l.data("off-label")&&(u=l.data("off-label")),void 0!==l.data("label-icon")&&(p=l.data("label-icon")),void 0!==l.data("text-label")&&(_=l.data("text-label")),s=e("<span>").addClass("switch-left").addClass(d).addClass(r).html(m),r="",void 0!==l.data("off")&&(r="switch-"+l.data("off")),o=e("<span>").addClass("switch-right").addClass(d).addClass(r).html(u),a=e("<label>").html("&nbsp;").addClass(d).attr("for",l.find(i).attr("id")),p&&a.html('<i class="icon '+p+'"></i>'),_&&a.html(""+_),t=l.find(i).wrap(e("<div>")).parent().data("animated",!1),!1!==l.data("animated")&&t.addClass("switch-animate").data("animated",!0),t.append(s).append(a).append(o),l.find(">div").addClass(l.find(i).is(":checked")?"switch-on":"switch-off"),l.find(i).is(":disabled")&&e(this).addClass("deactivate");var f=function(e){l.parent("label").is(".label-change-switch")||e.siblings("label").trigger("mousedown").trigger("mouseup").trigger("click")};l.on("keydown",function(t){32===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),f(e(t.target).find("span:first")))}),s.on("click",function(t){f(e(this))}),o.on("click",function(t){f(e(this))}),l.find(i).on("change",function(t,i){var s=e(this),o=s.parent(),a=s.is(":checked"),r=o.is(".switch-off");if(t.preventDefault(),o.css("left",""),r===a){if(a?o.removeClass("switch-off").addClass("switch-on"):o.removeClass("switch-on").addClass("switch-off"),!1!==o.data("animated")&&o.addClass("switch-animate"),"boolean"==typeof i&&i)return;o.parent().trigger("switch-change",{el:s,value:a})}}),l.find("label").on("mousedown touchstart",function(t){var i=e(this);n=!1,t.preventDefault(),t.stopImmediatePropagation(),i.closest("div").removeClass("switch-animate"),i.closest(".has-switch").is(".deactivate")?i.unbind("click"):i.closest(".switch-on").parent().is(".radio-no-uncheck")?i.unbind("click"):(i.on("mousemove touchmove",function(t){var i=e(this).closest(".make-switch"),s=(t.pageX||t.originalEvent.targetTouches[0].pageX)-i.offset().left,o=s/i.width()*100;n=!0,o<25?o=25:o>75&&(o=75),i.find(">div").css("left",o-75+"%")}),i.on("click touchend",function(t){var i=e(this),s=e(t.target),o=s.siblings("input");t.stopImmediatePropagation(),t.preventDefault(),i.unbind("mouseleave"),n?o.prop("checked",!(parseInt(i.parent().css("left"))<-25)):o.prop("checked",!o.is(":checked")),n=!1,o.trigger("change")}),i.on("mouseleave",function(t){var i=e(this),s=i.siblings("input");t.preventDefault(),t.stopImmediatePropagation(),i.unbind("mouseleave"),i.trigger("mouseup"),s.prop("checked",!(parseInt(i.parent().css("left"))<-25)).trigger("change")}),i.on("mouseup",function(t){t.stopImmediatePropagation(),t.preventDefault(),e(this).unbind("mousemove")}))}),"injected"!==c.data("bootstrapSwitch")&&(c.bind("reset",function(){setTimeout(function(){c.find(".make-switch").each(function(){var t=e(this).find(i);t.prop("checked",t.is(":checked")).trigger("change")})},1)}),c.data("bootstrapSwitch","injected"))})},toggleActivation:function(){var t=e(this);t.toggleClass("deactivate"),t.find(i).prop("disabled",t.is(".deactivate"))},isActive:function(){return!e(this).hasClass("deactivate")},setActive:function(t){var s=e(this);t?(s.removeClass("deactivate"),s.find(i).removeAttr("disabled")):(s.addClass("deactivate"),s.find(i).attr("disabled","disabled"))},toggleState:function(t){var i=e(this).find(":checkbox");i.prop("checked",!i.is(":checked")).trigger("change",t)},toggleRadioState:function(t){var i=e(this).find(":radio");i.not(":checked").prop("checked",!i.is(":checked")).trigger("change",t)},toggleRadioStateAllowUncheck:function(t,i){var s=e(this).find(":radio");t?s.not(":checked").trigger("change",i):s.not(":checked").prop("checked",!s.is(":checked")).trigger("change",i)},setState:function(t,s){e(this).find(i).prop("checked",t).trigger("change",s)},setOnLabel:function(t){e(this).find(".switch-left").html(t)},setOffLabel:function(t){e(this).find(".switch-right").html(t)},setOnClass:function(t){var i=e(this).find(".switch-left"),s="";void 0!==t&&(void 0!==e(this).attr("data-on")&&(s="switch-"+e(this).attr("data-on")),i.removeClass(s),s="switch-"+t,i.addClass(s))},setOffClass:function(t){var i=e(this).find(".switch-right"),s="";void 0!==t&&(void 0!==e(this).attr("data-off")&&(s="switch-"+e(this).attr("data-off")),i.removeClass(s),s="switch-"+t,i.addClass(s))},setAnimated:function(t){var s=e(this).find(i).parent();void 0===t&&(t=!1),s.data("animated",t),s.attr("data-animated",t),!1!==s.data("animated")?s.addClass("switch-animate"):s.removeClass("switch-animate")},setSizeClass:function(t){var i=e(this),s=i.find(".switch-left"),o=i.find(".switch-right"),a=i.find("label");e.each(["switch-mini","switch-small","switch-large"],function(e,i){i!==t?(s.removeClass(i),o.removeClass(i),a.removeClass(i)):(s.addClass(i),o.addClass(i),a.addClass(i))})},status:function(){return e(this).find(i).is(":checked")},destroy:function(){var t,i=e(this),s=i.find("div"),o=i.closest("form");return s.find(":not(input)").remove(),t=s.children(),t.unwrap().unwrap(),t.unbind("change"),o&&(o.unbind("reset"),o.removeData("bootstrapSwitch")),t}};return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist!"):s.init.apply(this,arguments)}}(jQuery),melisCore.screenSize>=768&&$(window).on("scroll click resize",function(e){$("#id_meliscommerce_categories_category_header").css("width","100%");var t=$("#"+activeTabId+" #id_meliscommerce_categories_category");if(t.length){t.position().top<$(window).scrollTop()-10?($("#id_meliscommerce_categories_category").addClass("fix-cat"),$("#categoryInfoPanel").css("padding-top","66px"),$("#saveCategory").css("margin-top","10px"),$("#id_meliscommerce_categories_category_header").width($("#id_meliscommerce_categories_list").width())):($("#id_meliscommerce_categories_category").removeClass("fix-cat"),$("#categoryInfoPanel").css("padding-top","0"),$("#saveCategory").css("margin-top","0"))}});var categoryOpeningItemFlag=!0;$(function(){$("body").on("click",".addCategory",function(e){$("#categoryTreeViewPanel").collapse("hide");var t="id_meliscommerce_categories_category",i=$("#categoryTreeView").jstree(!0),s=i.get_selected(),o="";s.length>=1&&(o=parseInt(s[0])),$("#"+t).removeClass("hidden"),melisHelper.zoneReload(t,"meliscommerce_categories_category",{catId:0,catFatherId:o}),melisCommerce.setUniqueId(0)}),$("body").on("click",".addCatalog",function(e){$("#categoryTreeViewPanel").collapse("hide");var t="id_meliscommerce_categories_category";$("#"+t).removeClass("hidden"),melisHelper.zoneReload(t,"meliscommerce_categories_category",{catId:0,catFatherId:-1}),melisCommerce.setUniqueId(0)}),$("body").on("click","#saveCategory",function(){$(this).button("loading");var e=$(this).data("catid"),t=new Array;t=$("#id_meliscommerce_categories_category form").not(".category_"+e+"_seo_form, .cat_trans_form").serializeArray(),t.push({name:"cat_id",value:e}),t=melisCommerceSeo.serializeSeo("category",e,t);var s=$(this).data("catfatherid");t.push({name:"cat_father_cat_id",value:s});var o=0;$('input[name="cat_status"]').is(":checked")&&(o=1),t.push({name:"cat_status",value:o}),$("form.cat_trans_form").each(function(){langLocale=$(this).data("locale"),langId=$(this).data("langid"),catDataString=$(this).serializeArray(),$.each(catDataString,function(){t.push({name:"cat_trans["+langId+"]["+this.name+"]",value:this.value})})}),t=$.param(t),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCategory/saveCategory",data:t,dataType:"json",encode:!0,cache:!1}).done(function(t){if($("#saveCategory").button("reset"),t.success){$("#categoryTreeViewPanel").collapse("show"),$("body").animate({scrollTop:0},1e3),melisCore.flashMessenger(),melisHelper.melisOkNotification(t.textTitle,t.textMessage);var o=$("#categoryTreeView").jstree(!0),a=o.settings.core.data.url,r="";if(0==e){var n=o.get_node(s),l=new Array;if(nodeParentsStr="",l.push(s),"object"==typeof n&&n.parents.length>1)for(i=0;i<n.parents.length-1;i++)l.push(n.parents[i]);nodeParentsStr="&openStateParent="+l.join(),r=t.cat_id}else{var n=o.get_node(e),l=new Array;if(nodeParentsStr="",!1!==n){if(n.parents.length>1){for(i=0;i<n.parents.length-1;i++)l.push(n.parents[i]);nodeParentsStr="&openStateParent="+l.join()}o.get_node(e).state.selected=!0}r=e}o.settings.core.data.url=a+"&selected="+r+nodeParentsStr,o.deselect_all(),$("#categoryTreeView ul li div").removeClass("jstree-wholerow-clicked"),o.refresh(),o.settings.core.data.url=a;melisHelper.zoneReload("id_meliscommerce_categories_category","meliscommerce_categories_category",{catId:r}),melisCommerce.setUniqueId(r),$("#categoryTreeView #"+r+" div").first().addClass("jstree-wholerow-clicked")}else melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,"id_meliscommerce_categories_category_form_transalations");melisCore.flashMessenger()}).fail(function(){$("#saveCategory").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".category-tree-view-lang li a",function(){categoryOpeningItemFlag=!1;var e=$(this).text(),t=$(this).data("locale");$(".cat-tree-view-languages span.filter-key").text(e),$("#categoryTreeView").data("langlocale",t),$("#categoryTreeView").jstree(!0).settings.core.data.data=[{name:"langlocale",value:t}],$("#categoryTreeView").jstree(!0).refresh()}),$("body").on("keyup","#categoryTreeViewSearchInput",function(e){categoryOpeningItemFlag=!1;var t=$(this).val().trim(),i=$("#categoryTreeView").jstree("search",t);setTimeout(function(){0==$(i).find(".jstree-search").length&&""!=t?($("#searchNoResult").removeClass("hidden"),$("#searchNoResult").find("strong").text(t)):$("#searchNoResult").addClass("hidden")},1500)}),$("body").on("keyup keypress","#categoryTreeViewSearchForm",function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1}),$("body").on("click","#clearSearchInputBtn",function(e){categoryOpeningItemFlag=!1;$("#categoryTreeView").jstree(!0);$("#categoryTreeViewSearchInput").val(""),$("#categoryTreeView").jstree("search","")}),$("body").on("click","#expandCategoryTreeViewBtn",function(e){categoryOpeningItemFlag=!1,$("#categoryTreeView").jstree("open_all")}),$("body").on("click","#collapseCategoryTreeViewBtn",function(e){categoryOpeningItemFlag=!1,$("#categoryTreeView").jstree("close_all")}),$("body").on("click","#refreshCategoryTreeView",function(e){categoryOpeningItemFlag=!1;var t=$("#categoryTreeView").jstree(!0);t.deselect_all(),t.refresh(),$("#categoryTreeViewSearchInput").val(""),$("#categoryTreeView").jstree("search","")}),$("body").on("click",".ecom-coutries-checkbox",function(e){$(this).find(".fa").hasClass("fa-check-square-o")?($(this).find(".fa").removeClass("fa-check-square-o"),$(this).find(".fa").addClass("fa-square-o"),$(this).find('input[type="checkbox"]').removeAttr("checked"),$(this).find(".check-all").hasClass("fa-square-o")&&($(".ecom-coutries-checkbox .fa").not(".check-all").addClass("fa-square-o"),$(".ecom-coutries-checkbox .fa").not(".check-all").removeClass("fa-check-square-o"),$(".ecom-coutries-checkbox .fa").not(".check-all").next('input[type="checkbox"]').removeAttr("checked"))):($(this).find(".fa").removeClass("fa-square-o"),$(this).find(".fa").addClass("fa-check-square-o"),$(this).find('input[type="checkbox"]').attr("checked","checked")),$(".ecom-coutries-checkbox .fa").not(".check-all").length==$(".ecom-coutries-checkbox .fa.fa-check-square-o").not(".check-all").next('input[type="checkbox"]:checked').length||$(this).find(".check-all").hasClass("fa-check-square-o")?($(".ecom-coutries-checkbox .fa").not(".check-all").removeClass("fa-square-o"),$(".ecom-coutries-checkbox .fa").not(".check-all").addClass("fa-check-square-o"),$(".ecom-coutries-checkbox .fa").not(".check-all").next('input[type="checkbox"]').removeAttr("checked"),$(".ecom-coutries-checkbox .fa.check-all").removeClass("fa-square-o"),$(".ecom-coutries-checkbox .fa.check-all").addClass("fa-check-square-o"),$(".ecom-coutries-checkbox .fa.check-all").next('input[type="checkbox"]').attr("checked","checked")):($(".ecom-coutries-checkbox .fa.fa-check-square-o").not(".check-all").next('input[type="checkbox"]').attr("checked","checked"),$(".ecom-coutries-checkbox .fa.check-all").addClass("fa-square-o"),$(".ecom-coutries-checkbox .fa.check-all").removeClass("fa-check-square-o"),$(".ecom-coutries-checkbox .fa.check-all").next('input[type="checkbox"]').removeAttr("checked")),e.stopPropagation(),e.preventDefault()}),$("body").on("switch-change","#cat_status",function(e,t){1==t.value?$(this).find('input[type="checkbox"]').attr("checked","checked"):$(this).find('input[type="checkbox"]').removeAttr("checked")}),$("body").on("click",".categoryProductsRefresh",function(e,t){var i=$("#categoryProductListTbl").data("catid");melisHelper.zoneReload("id_meliscommerce_categories_category_tab_products","meliscommerce_categories_category_tab_products",{catId:i,activateTab:!0})}),$("body").on("click",".categoryProductsRemove",function(){var e=$(this).parents("tr").attr("id"),t=$("#categoryProductListTbl").data("catid"),i=$("#saveCategory").data("catfatherid"),s=translations.tr_meliscommerce_categories_category_product_remove,o=translations.tr_meliscommerce_categories_category_product_remove_confirm_msg;"-1"==i&&(s=translations.tr_meliscommerce_categories_catalog_product_remove,o=translations.tr_meliscommerce_categories_catalog_product_remove_confirm_msg),melisCoreTool.confirm(translations.tr_meliscommerce_categories_common_label_yes,translations.tr_meliscommerce_categories_common_label_no,s,o,function(){var s=new Array;s.push({name:"pcat_id",value:e}),s.push({name:"parent_id",value:i}),s.push({name:"cat_id",value:t}),s=$.param(s),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCategory/removeCategoryProduct",data:s,dataType:"json",encode:!0}).done(function(e){e.success?melisHelper.zoneReload("id_meliscommerce_categories_category_tab_products","meliscommerce_categories_category_tab_products",{catId:t,activateTab:!0}):alert(translations.tr_meliscore_error_message),melisCore.flashMessenger(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)}).fail(function(){alert(translations.tr_meliscore_error_message)})})}),$("body").on("click",".categoryProductsView",function(){var e=$(this).closest("tr").data("productid"),t=$(this).closest("tr").data("productname"),i="id_meliscommerce_product_list_container";melisHelper.tabOpen(translations.tr_meliscommerce_products_Products,"fa icon-shippment fa-2x","id_meliscommerce_product_list_container","meliscommerce_product_list_container");var s=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='"+i+"']"),o=setInterval(function(){s.length&&(melisCommerce.openProductPage(e,t,i),melisCommerce.setUniqueId(e),clearInterval(o))},500)}),$("body").on("dblclick",".jstree-node",function(e){$("#categoryTreeViewPanel").collapse("hide");var t=parseInt($(this).attr("id"),10),i="id_meliscommerce_categories_category";$("#"+i).removeClass("hidden"),melisHelper.zoneReload(i,"meliscommerce_categories_category",{catId:t}),$("#categoryTreeView #"+t+" div").first().addClass("jstree-wholerow-clicked"),melisCommerce.setUniqueId(t),e.stopPropagation(),e.preventDefault()}),$("body").on("click",".cat-div .jstree-node .jstree-icon",function(){categoryOpeningItemFlag=!0}),$("body").on("mouseenter mouseout",".toolTipCatHoverEvent",function(e){$(".thClassColId").attr("style","");var t=$(this).data("productid");$.each($("table#catProductTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">Loading...</span><br/></div>').insertAfter("table#catProductTable"+t+" thead");var i=$.ajax({type:"POST",url:"melis/MelisCommerce/MelisComProductList/getToolTip",data:{productId:t},dataType:"json",encode:!0}).success(function(e){$("div.qtipLoader").remove(),0===e.content.length?$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">'+translations.tr_meliscommerce_product_tooltip_no_variants+"</span><br/></div>").insertAfter("table.qtipTable thead"):($.each($("table#catProductTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$.each(e.content.reverse(),function(e,i){$(i).insertAfter("table#catProductTable"+t+" thead")}))});"mouseout"===e.type&&i.abort()})}),window.enableDisableAddCategoryBtn=function(e){var t=$(".addCategory");"enable"==e?(t.attr("disabled",!1),t.attr("title",null)):"disable"==e&&(t.attr("disabled",!0),t.attr("title",translations.tr_meliscommerce_categories_category_no_selected_catalog_category))},window.initCategoryTreeView=function(){$("body").on("click","#categoryTreeView",function(e){$("#categoryTreeView ul li div").removeClass("jstree-wholerow-clicked"),e.stopPropagation(),e.preventDefault()}),$("#categoryTreeView").on("changed.jstree",function(e,t){enableDisableAddCategoryBtn("enable")}).on("refresh.jstree",function(e,t){enableDisableAddCategoryBtn("disable")}).on("loading.jstree",function(e,t){melisCommerce.pendingZoneStart("meliscommerce_categories_list_search_input")}).on("loaded.jstree",function(e,t){melisCommerce.pendingZoneDone("meliscommerce_categories_list_search_input"),$("ul.jstree-container-ul > li > a").each(function(){var e=$(this),t=e.data("fathericon"),i=e.find("i");e.html(i.get(0).outerHTML+"<b>"+t+" "+e.text()+"</b>")})}).on("refresh.jstree",function(e,t){$("ul.jstree-container-ul > li > a").each(function(){var e=$(this),t=e.data("fathericon"),i=e.find("i");e.html(i.get(0).outerHTML+"<b>"+t+" "+e.text()+"</b>")})}).on("ready.jstree",function(e,t){}).on("load_node.jstree",function(e,t){}).on("open_node.jstree",function(e,t){1==categoryOpeningItemFlag&&$(".cat-div").length&&$(".cat-div #"+t.node.id).offset().top+$(".cat-div #"+t.node.id).height()>$(".cat-div").offset().top+$(".cat-div").height()&&($timeOut=setTimeout(function(){var e=$(".cat-div").scrollTop(),i=$(".cat-div #"+t.node.id).innerHeight();$(".cat-div").animate({scrollTop:e+i},"slow")},1e3))}).on("after_open.jstree",function(e,t){$.each(t.node.children_d,function(e,t){var i=$("#"+t+"_anchor").data("textlang"),s=$("#"+t+"_anchor").data("numprods"),o='<span title="'+translations.tr_meliscommerce_categories_list_tree_view_product_num+'">('+s+")</span>",a=$("#"+t+"_anchor").data("seopage");a&&(o=o+' - <span class="fa fa-file-o"></span> '+a),i&&(o=" "+i+o),$("#"+t+"_anchor").hasClass("updatedText")||($("#"+t+"_anchor").append(o),$("#"+t+"_anchor").addClass("updatedText"))})}).on("move_node.jstree",function(e,t){var i=t.node.id,s="#"==t.parent?"-1":t.parent,o="#"==t.old_parent?"-1":t.old_parent,a=t.position+1,r=new Array;r.push({name:"cat_id",value:parseInt(i,10)}),r.push({name:"cat_father_cat_id",value:parseInt(s,10)}),r.push({name:"cat_order",value:a}),r.push({name:"old_parent",value:parseInt(o,10)}),r=$.param(r),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCategoryList/saveCategoryTreeView",data:r,dataType:"json",encode:!0}).done(function(e){e.success?($currentCategoryId=$("#saveCategory").data("catid"),$currentCategoryId==i&&$("#saveCategory").data("catfatherid",s)):alert(translations.tr_meliscore_error_message)}).fail(function(){alert(translations.tr_meliscore_error_message)})}).jstree({contextmenu:{items:function(e){return{Add:{label:translations.tr_meliscommerce_categories_common_btn_add,icon:"fa fa-plus",action:function(t){var i=parseInt(e.id),s=e.children.length+1;$("#categoryTreeViewPanel").collapse("hide");melisHelper.zoneReload("id_meliscommerce_categories_category","meliscommerce_categories_category",{catId:0,catFatherId:i,catOrder:s})}},Update:{label:translations.tr_meliscommerce_categories_common_btn_update,icon:"fa fa-edit",action:function(t){var i=parseInt(e.id,10);melisHelper.zoneReload("id_meliscommerce_categories_category","meliscommerce_categories_category",{catId:i}),$("#categoryTreeViewPanel").collapse("hide")}},Delete:{label:translations.tr_meliscommerce_categories_common_btn_delete,icon:"fa fa-trash-o",action:function(t){var i=new Array,s="#"==e.parent?"-1":parseInt(e.parent,10);i.push({name:"cat_father_cat_id",value:s});var o=parseInt(e.id);i.push({name:"cat_id",value:o}),i=$.param(i);var a=translations.tr_meliscommerce_categories_category_delete,r=translations.tr_meliscommerce_categories_category_delete_confirm_msg;"-1"==s&&(a=translations.tr_meliscommerce_categories_catalog_delete,r=translations.tr_meliscommerce_categories_catalog_delete_confirm_msg),melisCoreTool.confirm(translations.tr_meliscommerce_categories_common_label_yes,translations.tr_meliscommerce_categories_common_label_no,a,r,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCategory/deleteCategory",data:i,dataType:"json",encode:!0}).done(function(e){if(e.success){if($("#categoryTreeView").jstree(!0).delete_node(o+"_categoryId_anchor"),$("#saveCategory").data("catid")==o){melisHelper.zoneReload("id_meliscommerce_categories_category","meliscommerce_categories_category")}melisCore.flashMessenger(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)}).fail(function(){alert(translations.tr_meliscore_error_message)})})}}}}},core:{multiple:!1,check_callback:!0,animation:500,themes:{name:"proton",responsive:!1},dblclick_toggle:!1,data:{cache:!1,url:"/melis/MelisCommerce/MelisComCategoryList/getCategoryTreeView?langlocale="+$("#categoryTreeView").data("langlocale")}},types:{"#":{valid_children:["catalog"]},catalog:{valid_children:["category"]},category:{valid_children:["category"]}},plugins:["contextmenu","changed","dnd","search","types"]}),
$("body").on("click",".categoryProductsExport",function(){melisCoreTool.isTableEmpty("categoryProductListTbl")||melisCoreTool.exportData("/melis/MelisCommerce/MelisComCategory/productsExportToCsv?catId="+$(this).data("catid"))})},window.initCategoryStatus=function(){$("#cat_status").bootstrapSwitch()},window.initCategoryProducts=function(e,t){var i=$("#"+t.sTableId).data("catid");e.catId=i;var s=$("#categoryTreeView").data("langlocale");e.catLangLocale=s,$("#categoryProductListTbl").on("row-reorder.dt",function(e,t,i){for(var s="Reorder started on row: "+i.triggerRow.data()[1]+"<br>",o=0,a=t.length;o<a;o++){s+=$categoryProductListTbl.row(t[o].node).data()[1]+" updated to be in position "+t[o].newData+" (was "+t[o].oldData+")<br>"}if(!$.isEmptyObject(t)){var r=new Array,n=new Array;$.each(t,function(){n.push(this.node.id+"-"+this.newPosition)}),r.push({name:"catPrdOrderData",value:n.join()}),r=$.param(r),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCategory/reOrderCategoryProducts",data:r,dataType:"json",encode:!0}).done(function(e){e.success||alert(translations.tr_meliscore_error_message)}).fail(function(){alert(translations.tr_meliscore_error_message)})}})},window.initCategoryProductsImgs=function(){lightbox.option({resizeDuration:200,wrapAround:!0})},$(function(){$("body").on("keyup keydown change","input[name='eseo_meta_title']",{limit:60},seoCharCounter),$("body").on("keyup keydown change","textarea[name='eseo_meta_description']",{limit:160},seoCharCounter)}),window.preSeoCharCounter=function(){$("form.seoForm").each(function(){var e=$(this),t=e.find("input[name='eseo_meta_title']"),i=e.find("textarea[name='eseo_meta_description']");t.trigger("keyup"),i.trigger("keyup")})},window.seoCharCounter=function(e){var t=$(this).val().length,i=$(this).prev("label"),s=e.data.limit;i.find("span").length?0===t?(i.removeClass("limit"),i.find("span").remove()):(i.find("span").html('<i class="fa fa-text-width"></i>('+t+")"),t>s?(i.addClass("limit"),i.find("span").addClass("limit")):(i.removeClass("limit"),i.find("span").removeClass("limit"))):0!==t&&(i.append("<span class='text-counter-indicator'><i class='fa fa-text-width'></i>("+t+")</span>"),t>s&&(i.addClass("limit"),i.find("span").addClass("limit")))};var melisCommerceSeo=function(e){function t(e,t,i){var s=new Array;return $("form."+e+"_"+t+"_seo_form").each(function(){langId=$(this).data("langid"),s=$(this).serializeArray(),$.each(s,function(){i.push({name:e+"_seo["+langId+"]["+this.name+"]",value:this.value})})}),i}return{serializeSeo:t}}(window);window.initProductSwitch=function(){setOnOff(),allLoaded()},window.initProductCategoryList=function(e,t){if(void 0===t&&(t=melisLangId),$("#"+e+"_productCategoryList").length){var i=$("#"+e+"_productCategoryList");t!==melisLangId&&i.data("langlocale",t),i.jstree("destroy");var s=new Array;s.push({name:"productId",value:e}),s.push({name:"idAndNameOnly",value:!0}),s.push({name:"langlocale",value:i.data("langlocale")}),$("div#"+e+"_product_category_area > span.prod-cat-values").each(function(){s.push({name:"categoriesChecked[]",value:$(this).data("pcat-cat-id")})}),s=$.param(s),i.on("loading.jstree",function(e,t){melisCommerce.pendingZoneStart("productCategorySearchZone")}).on("loaded.jstree",function(e,t){melisCommerce.pendingZoneDone("productCategorySearchZone")}).jstree({types:{default:{icon:"fa fa-circle text-success"},selected:{select_node:!1}},core:{check_callback:!0,animation:500,themes:{name:"proton",responsive:!1},dblclick_toggle:!1,data:{cache:!0,url:"/melis/MelisCommerce/MelisComCategoryList/getCategoryTreeView?"+s}},checkbox:{three_state:!1,whole_node:!1,tie_selection:!1},plugins:["search","changed","types","checkbox"]})}},window.initAttribute=function(e){null!=melisCommerce.getCurrentProductId()&&(e||populateAttribList(e))},window.populateAttribList=function(e){1===$("#"+activeTabId).length&&melisCommerce.enableAllTabs()},window.initProductTextTinyMce=function(e){var t="#"+e+"_id_meliscommerce_products_page textarea.product-text-mce[data-display='true']:not([id])";$(t).length?$(t).each(function(t,i){var s=$(this),o=Math.random().toString(36).substr(2,9),a=o+"_"+e+"_"+i.name;s.attr("id",a);var r={mode:"none",height:"400px",init_instance_callback:productTextTinyMCECallback(s,e),plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste template","textcolor"],toolbar:"undo redo | styleselect | bold italic | link image |  alignleft aligncenter alignright alignjustify | forecolor backcolor | code"};melisTinyMCE.createTinyMCE("tool","#"+a,r)}):$("#"+e+"_id_meliscommerce_products_page .notifTinyMcePreloaInfo").fadeOut("slow")},window.productTextTinyMCECallback=function(e,t){$("#"+e.id).parents("div.form-group").attr("data-tinymce","true"),$("#"+t+"_id_meliscommerce_products_page .notifTinyMcePreloaInfo").fadeOut("slow")},window.allLoaded=function(){melisCommerce.enableAllTabs()},window.reInitProductTextTypeSelect=function(e){var t=[],i=$("#"+e+"_id_meliscommerce_products_page .product-text-forms > .custom-field-type");$.each(i,function(e,i){$.each($(i).find("input#ptt_id"),function(e,i){t.push($(i).val())})});var s=$("form[data-modalform='"+melisCommerce.getCurrentProductId()+"_productTextForm'] select#ptxt_type");$.each(t,function(e,t){s.find("option[value='"+t+"']").remove()})},$(document).ready(function(){var e=$("body");e.on("click",".productCategoryList",function(){var e=$(this),t=e.data("productid");e.attr("disabled",!0),zoneId="id_meliscommerce_products_main_tab_categories_modal",melisKey="meliscommerce_products_main_tab_categories_modal",modalUrl="/melis/MelisCommerce/MelisComProduct/renderProductModal",melisHelper.createModal(zoneId,melisKey,!1,{productId:t},modalUrl,function(){e.attr("disabled",!1)})}),e.on("click",".addProductCategory",function(){var e=$(this),t=e.data("productid"),i=new Array;$.each($("#"+t+"_productCategoryList").jstree().get_checked(!0),function(){i.push(parseInt(this.id))});var s=new Array,o=new Array;$("#"+t+"_product_category_area span[data-pcat-cat-id]").each(function(){var e=parseInt($(this).data("pcat-cat-id"));-1!==i.indexOf(e)?o.push(e):(s.push(e),$("span.prod-cat-values[data-pcat-cat-id='"+e+"']").remove())}),$.each($("#"+t+"_productCategoryList").jstree().get_checked(!0),function(){var e=parseInt(this.id);if(-1===s.indexOf(e)&&-1===o.indexOf(e)){var i=this.text.split(" - ")[1];$.get("/melis/MelisCommerce/MelisComProduct/getProductCategoryLastOrderNum",{catId:e,prodId:t},function(s){$("#"+t+"_product_category_area").append('<span class="prod-cat-values" data-pcat-id="'+s.id+'" data-pcat-cat-id="'+e+'" data-pcat-order="'+s.order+'"><span class="ab-attr">'+i+'<i class="prdDelCat fa fa-times"></i></span></span>')})}}),i.length?$("p#"+t+"_no_categories").hide():$("p#"+t+"_no_categories").show(),$("#id_meliscommerce_products_main_tab_categories_modal_container").modal("hide")}),e.on("click",".product-category-tree-view-lang li a",function(){var e=$(this).text(),t=$(this).data("locale"),i=$(".productCategoryLangDropdown").data("productid");$(".productCategoryLangDropdown span.filter-key").text(e),initProductCategoryList(i,t)}),e.on("click",".productTextForm .deleteTextInput",function(){var e=$(this).parent().attr("data-text-identifier"),t=$(this).parents("form"),i=$("form[data-modalform='"+melisCommerce.getCurrentProductId()+"_productTextForm'] select#ptxt_type");melisCoreTool.pending(".deleteTextInput"),melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscommerce_product_confirm_remove_title,translations.tr_meliscommerce_product_confirm_remove_test,function(){$.each(t,function(e,t){var s=$(t).find("a[data-text-identifier]").attr("data-text-identifier"),o=$(t).find("input#ptt_id").val();i.find("option[value='"+o+"']").length||i.prepend($("<option>",{value:o,text:s}))}),$("#"+activeTabId+" .productTextForm .deleteTextInput").closest("a[data-text-identifier='"+e+"']").closest("form").remove()}),melisCoreTool.done(".deleteTextInput")}),e.on("click",".btnProductListEdit",function(){var e=$(this).parents("tr").attr("id"),t=$(this).parents("tr").find("td span").data("productname"),i="id_meliscommerce_product_list_container";$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_product_list_container']").length>0?(melisCommerce.disableAllTabs(),melisCommerce.openProductPage(e,t,i),melisCommerce.setUniqueId(e)):melisHelper.tabOpen("Products","icon-shipment","id_meliscommerce_product_list_container","meliscommerce_product_list_container","",i,function(){melisCommerce.disableAllTabs(),melisCommerce.openProductPage(e,t,i),melisCommerce.setUniqueId(e)})}),e.on("click","#btnAddProduct",function(){melisCommerce.openProductPage(0,translations.tr_meliscommerce_products_page_new_product,"id_meliscommerce_product_list_container"),melisCommerce.setUniqueId(0)}),e.on("click","#addProdTextType",function(){var e=($(this).data("productid"),$("form#productTextTypeForm").serialize()),t=$(this).closest(".panel").find(".panel-heading .panel-title a"),i=$(this).closest(".panel").find(".panel-collapse");melisCoreTool.pending("#addProdTextType"),$.ajax({type:"POST",data:e,url:"/melis/MelisCommerce/MelisComProduct/addProductTextType",dataType:"json",encode:!0}).success(function(e){e.success?(melisCoreTool.clearForm("productTextTypeForm"),t.addClass("collapsed"),t.attr("aria-expanded",!1),i.removeClass("in"),i.attr("aria-expanded",!1),melisHelper.zoneReload(melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page_content_tab_product_text_modal_form","meliscommerce_products_page_content_tab_product_text_modal_form",{productId:melisCommerce.getCurrentProductId()})):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"productTextTypeForm")),melisCore.flashMessenger(),melisCoreTool.done("#addProdTextType")})}),e.on("click",".add-product-text",function(){$("div[data-class='addTextFieldNotif']").html("").attr("class","addTextFieldNotif")}),e.on("click",".btnAddText",function(){var e=$(this).data("productid"),t=$("#"+e+"_id_meliscommerce_products_page_content_tab_product_text_modal_form").find("select#ptxt_type");typeId=t.val();var i=$("#"+e+"_id_meliscommerce_products_page_content_tab_product_text_modal_form").find("select#ptxt_type option:selected").text();melisCoreTool.pending(this),$.ajax({type:"GET",url:"/melis/MelisCommerce/MelisComProduct/getEmptyProductTextForm?textTypeId="+typeId+"&text="+i,dataType:"json",encode:!0}).success(function(t){var s=$("#"+e+"_id_meliscommerce_products_page .product-text-forms > .custom-field-type");s.length&&$("#"+e+"_id_meliscommerce_products_page .notifTinyMcePreloaInfo").fadeIn("slow"),$.each(s,function(s,o){var a=$(o).data("lang-id"),r=$("#"+e+"_id_meliscommerce_products_page .product-text-tab li#languageList").length;$("#"+e+"_id_meliscommerce_products_page .productTextForm a[data-text='"+i+"']").length<r?($(o).find(".custom-field-type-area").append(t.content).data("text-lang-id",a),$(o).find("form[name='productTextForm']").attr("data-text-lang-id",a),$(o).find("form[name='productTextForm'] input#ptxt_lang_id").val(a),initProductTextTinyMce(e),$("div[data-modalname='genericProductTextModal']").modal("hide"),$("div[data-class='addTextFieldNotif']").html("").attr("class","")):melisCoreTool.alertDanger("div[data-class='addTextFieldNotif']","",translations.tr_meliscommerce_product_text_add_exists)}),melisCoreTool.done(".btnAddText")})}),e.on("click",".save_product",function(){var e=$(this).data("productid"),t=$("#"+melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page form"),i=[],s=0,o=0,a=$(this).closest(".container-level-a"),r=$(a).find("#"+e+"_id_meliscommerce_settings_tabs_content_main_details_left form"),n=$(a).find(".alert-email-values");Array.prototype.push.apply(i,$(r).serializeArray());var l="",c="",d="";n.each(function(){l=$(this).data("seaid"),c=$(this).data("alertemail"),d=$(this).data("userid"),i.push({name:"recipients["+o+"][sea_id]",value:l}),i.push({name:"recipients["+o+"][sea_email]",value:c}),i.push({name:"recipients["+o+"][sea_user_id]",value:d}),void 0!==e&&i.push({name:"recipients["+o+"][sea_prd_id]",value:e}),o++}),o=0,t.each(function(){var e=$(this).attr("name"),t=$(this).serializeArray();for(s=t.length,j=0;j<s;j++)i.push({name:e+"["+o+"]["+t[j].name+"]",value:t[j].value});o++}),$("#"+e+"_id_meliscommerce_products_page").find(".make-switch div").each(function(){var e=$(this).find("input").attr("name");if(void 0!==e&&!1!==e){var t="product[0]["+$(this).find("input").attr("name")+"]",s=$(this).hasClass("switch-on"),o=0;s&&(o=1),i.push({name:t,value:o})}}),i.push({name:"productId",value:e}),i=melisCommerceSeo.serializeSeo("product",e,i),i.push({name:"product[0][prd_id]",value:e}),o=0,$("div#"+melisCommerce.getCurrentProductId()+"_attribute_area > span.attr-values").each(function(){i.push({name:"attributes["+o+"][patt_id]",value:$(this).data("patt-id")}),i.push({name:"attributes["+o+"][patt_attribute_id]",value:$(this).data("patt-attribute-id")}),o++}),o=0,$("div#"+melisCommerce.getCurrentProductId()+"_product_category_area > span.prod-cat-values").each(function(){i.push({name:"categories["+o+"][pcat_id]",value:$(this).data("pcat-id")}),i.push({name:"categories["+o+"][pcat_cat_id]",value:$(this).data("pcat-cat-id")}),i.push({name:"categories["+o+"][pcat_order]",value:$(this).data("pcat-order")}),o++}),o=0,$("div#"+melisCommerce.getCurrentProductId()+"_deleted_product_category_area > span").each(function(){i.push({name:"delcategories["+o+"][pcat_id]",value:$(this).data("pcat-id")}),o++}),o=0,melisCoreTool.pending(".save_product"),melisCommerce.disableAllTabs(),$.ajax({type:"POST",data:i,url:"/melis/MelisCommerce/MelisComProduct/saveProduct",dataType:"json",encode:!0}).success(function(e){if(e.success){var t=$('.tab-element[data-id="'+e.chunk.productId+'_id_meliscommerce_products_page"]').parent();if(melisCommerce.closeCurrentProductPage(),melisCommerce.openProductPage(e.chunk.productId,e.chunk.prodName,"id_meliscommerce_product_list_container"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_product_list_content","meliscommerce_product_list_content"),melisCommerce.setUniqueId(e.chunk.productId),t.hasClass("has-sub")){var i=t.find(".nav-group-dropdown").prop("outerHTML");$('.tab-element[data-id="'+e.chunk.productId+'_id_meliscommerce_products_page"]').parent().addClass("has-sub").append(i)}}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,activeTabId+" form");melisCoreTool.done(".save_product"),melisCore.flashMessenger(),melisCommerce.enableAllTabs()})}),e.on("click","a[data-meliskey='meliscommerce_products_page_header_save_product_cancel']",function(){melisCommerce.closeCurrentProductPage()}),e.on("click",".add-attribute",function(){var e=$("#"+melisCommerce.getCurrentProductId()+"_prodAttribInput"),t=$("#"+activeTabId+" #select2-"+melisCommerce.getCurrentProductId()+"_prodAttribInput-container"),i=$("#"+activeTabId+" span.select2");$("div#"+activeTabId+" select.dropdown-input"+melisCommerce.getCurrentProductId());if(e.val()){var s=e.val(),o=$("#"+melisCommerce.getCurrentProductId()+"_prodAttribInput option[value='"+s+"']").html(),a=$("#"+melisCommerce.getCurrentProductId()+"_prodAttribInput option[value='"+s+"']");if(0===$("#"+melisCommerce.getCurrentProductId()+"_attribute_area").find("span[data-patt-attribute-id='"+s+"']").length){$("#"+melisCommerce.getCurrentProductId()+"_attribute_area").append('<span class="attr-values" data-patt-attribute-id="'+s+'"><span class="ab-attr"><span class="attrib-value">'+o+'</span><i class="prdDelAttr fa fa-times"></i></span>'),$("p#"+melisCommerce.getCurrentProductId()+"_no_attributes").hide();var r=0,n=new Object;$.each(e.find("option"),function(e,t){s!==$(t).val()&&(n[r]={id:$(t).val(),value:$(t).html()},r++)}),a.remove(),t.html("").attr("title","")}t.css("color","#444"),i.css("border","none")}else t.css("color","#e80e05"),i.css("border","1px solid #e80e05")}),e.on("click",".prdDelAttr",function(){var e=$(this),t=$("#"+melisCommerce.getCurrentProductId()+"_prodAttribInput"),i=e.parent().parent(),s=e.parents("span.attr-values").attr("data-patt-attribute-id"),o=e.parent().find("span.attrib-value").html();$.ajax({type:"GET",url:"/melis/MelisCommerce/MelisComProduct/checkAttributeOnVariant",data:{productId:melisCommerce.getCurrentProductId(),patt_attr_id:s},dataType:"json",encode:!0,beforeSend:function(){e.removeClass("fa-times"),e.addClass("fa-spinner fa-pulse")}}).success(function(a){if(a.attribute_is_used)e.removeClass("fa-spinner fa-pulse"),e.addClass("fa-times"),melisHelper.melisKoNotification(translations.tr_meliscommerce_attribute_delete_product_attr_title,translations.tr_meliscommerce_attribute_delete_product_attr_title_msg);else{var r=$("<option selected></option>");r.val(s),r.text(o),r.val(s),r.text(o),t.append(r),t.val(""),t.select2({placeholder:translations.tr_meliscommerce_products_main_tab_attributes_content_label,val:""}),t.val(""),i.fadeOut("fast").remove();$("#"+activeTabId+" #select2-"+melisCommerce.getCurrentProductId()+"_prodAttribInput-container");setTimeout(function(){},1),setTimeout(function(){melisCoreTool.pending(".prdDelAttr")},1e3),t.css("border","1px solid #e5e5e5"),0===$(".prdDelAttr").length&&$("p#"+melisCommerce.getCurrentProductId()+"_no_attributes").show()}})}),e.on("click",".prdDelCat",function(){var e=$(this).parent().parent();$("#"+melisCommerce.getCurrentProductId()+"_deleted_product_category_area").append('<span data-pcat-id="'+e.data("pcat-id")+'" data-pcat-cat-id="'+e.data("pcat-cat-id")+'"></span>'),e.fadeOut("slow").remove(),0===$(".prdDelCat").length&&$("p#"+melisCommerce.getCurrentProductId()+"_no_categories").show()}),e.on("keyup","#productCategorySearch",function(e){var t=$(this).data("productid"),i=$(this).val();$("#"+t+"_productCategoryList").jstree("search",i)}),e.on("click","#clearPrdCatSearchInputBtn",function(e){var t=$(this).data("productid");categoryOpeningItemFlag=!1;var i=$("#"+t+"_productCategoryList");$("#productCategorySearch").val(""),i.jstree("search","")}),e.on("click","#expandPrdCatTreeViewBtn",function(e){var t=$(this).data("productid");$("#"+t+"_productCategoryList").jstree("open_all")}),e.on("click","#collapsePrdCatTreeViewBtn",function(e){var t=$(this).data("productid");$("#"+t+"_productCategoryList").jstree("close_all")}),e.on("click","#refreshPrdCatTreeView",function(e){var t=$(this).data("productid"),i=$("#"+t+"_productCategoryList");i.jstree(!0).refresh("forget_state",!0),i.jstree("search",""),$("#productCategorySearch").val("")}),e.on("click",".btnProductListDelete",function(){var e=$(this).closest("tr").attr("id");melisCoreTool.pending(".btnProductListDelete"),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_product_remove_title,translations.tr_meliscommerce_product_remove_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComProduct/delete",data:{productId:e},dataType:"json",encode:!0}).success(function(t){t.success&&($("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.tabClose(e+"_id_meliscommerce_products_page"),melisCore.flashMessenger(),melisHelper.melisOkNotification(t.textTitle,t.textMessage))})}),melisCoreTool.done(".btnProductListDelete")}),e.on("click",".toggleformCreateTextTypeContainer",function(){$("div.formCreateTextTypeContainer").slideToggle()}),e.on("mouseenter mouseout",".toolTipHoverEvent",function(e){$(".thClassColId").attr("style","");var t=$(this).data("productid");$.each($("table#productTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">Loading...</span><br/></div>').insertAfter("table#productTable"+t+" thead");var i=$.ajax({type:"POST",url:"melis/MelisCommerce/MelisComProductList/getToolTip",data:{productId:t},dataType:"json",encode:!0}).success(function(e){$("div.qtipLoader").remove(),0===e.content.length?$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">'+translations.tr_meliscommerce_product_tooltip_no_variants+"</span><br/></div>").insertAfter("table.qtipTable thead"):($.each($("table#productTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$.each(e.content.reverse(),function(e,i){$(i).insertAfter("table#productTable"+t+" thead")}))});"mouseout"===e.type&&i.abort()}),e.on("click",".add-product-text",function(){melisHelper.zoneReload(melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page_content_tab_product_text_modal_form_product_type_text","meliscommerce_products_page_content_tab_product_text_modal_form_product_type_text",{productId:melisCommerce.getCurrentProductId()}),reInitProductTextTypeSelect(melisCommerce.getCurrentProductId())}),e.on("click",".openVariant",function(){var e=$(this),t=e.data("product-id"),i=e.data("product-name"),s=t+"_id_meliscommerce_products_page";melisCommerce.openProductPage(t,i,"id_meliscommerce_product_list_container",function(){var i=e.parent().siblings(":first").text(),o=e.parent().parent().find("td:nth-child(4)").text();melisCommerce.disableAllTabs(),melisHelper.tabOpen(o,"icon-tag-2",i+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:i,productId:t},s),melisCommerce.setUniqueId(i),melisCommerce.enableAllTabs()})})}),$(function(){$("body").on("keyup keydown change","input[name='eseo_meta_title']",{limit:60},seoCharCounter),$("body").on("keyup keydown change","textarea[name='eseo_meta_description']",{limit:160},seoCharCounter)}),window.preSeoCharCounter=function(){$("form.seoForm").each(function(){var e=$(this),t=e.find("input[name='eseo_meta_title']"),i=e.find("textarea[name='eseo_meta_description']");t.trigger("keyup"),i.trigger("keyup")})},window.seoCharCounter=function(e){var t=$(this).val().length,i=$(this).prev("label"),s=e.data.limit;i.find("span").length?0===t?(i.removeClass("limit"),i.find("span").remove()):(i.find("span").html('<i class="fa fa-text-width"></i>('+t+")"),t>s?(i.addClass("limit"),i.find("span").addClass("limit")):(i.removeClass("limit"),i.find("span").removeClass("limit"))):0!==t&&(i.append("<span class='text-counter-indicator'><i class='fa fa-text-width'></i>("+t+")</span>"),t>s&&(i.addClass("limit"),i.find("span").addClass("limit")))};var melisCommerceSeo=function(e){function t(e,t,i){var s=new Array;return $("form."+e+"_"+t+"_seo_form").each(function(){langId=$(this).data("langid"),s=$(this).serializeArray(),$.each(s,function(){i.push({name:e+"_seo["+langId+"]["+this.name+"]",value:this.value})})}),i}return{serializeSeo:t}}(window);$(document).ready(function(){var e=$("body");e.on("click",".editvariant",function(){var e=$(this).closest("tr").attr("id"),t=$(this).closest("tr").find("td a").data("variantname"),i=$(this).closest(".container-level-a").attr("id").replace(/[^0-9]/g,""),s=i+"_id_meliscommerce_products_page";melisCommerce.disableAllTabs(),melisHelper.tabOpen(t,"icon-tag-2",e+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:e,productId:i},s),melisCommerce.setUniqueId(e),melisCommerce.enableAllTabs()}),e.on("click",".add-variant",function(){var e=$(this).closest(".container-level-a").attr("id").replace(/[^0-9]/g,""),t=e+"_id_meliscommerce_products_page";melisCoreTool.processing(),melisHelper.tabOpen(translations.tr_meliscommerce_variant_main_information_sku_new,"icon-tag-2","id_meliscommerce_variants_page","meliscommerce_variants_page",{productId:e,page:"newvar"},t),melisCommerce.setUniqueId(0),melisCoreTool.processDone()}),e.on("click",".save-add-variant",function(){$(this).closest(".container-level-a").attr("id")}),e.on("click",".country-price-tab li a",function(){var e=$(this).data("country"),t=$(this).data("symbol");""!=t?$(".cur-symbol").removeClass("fa fa-dollar").text(t).css("font-weight","600"):$(".cur-symbol").hasClass("fa")||$(".cur-symbol").empty().addClass("fa fa-dollar").removeAttr("style"),$(".country-price-label").text(e+" "+translations.tr_meliscommerce_variant_tab_prices_pricing)}),e.on("click",".country-stock-tab li a",function(){var e=$(this).data("country");"fr_FR"==melisLangId?$(".country-stock-label").text(translations.tr_meliscommerce_variant_tab_stocks_header+" "+e):$(".country-stock-label").text(e+" "+translations.tr_meliscommerce_variant_tab_stocks_header)}),e.on("click",".productvariant-refresh",function(){var e=melisCommerce.getCurrentProductId();melisHelper.zoneReload(e+"_id_meliscommerce_products_page_content_tab_variant_content_container","meliscommerce_products_page_content_tab_variant_content_container",{productId:e})}),e.on("click",".deletevariant",function(){var e=this,t=$(e).closest("tr").attr("id"),i=[];i.push({name:"var_id",value:t}),melisCoreTool.pending(e),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_variants_delete_title,translations.tr_meliscommerce_variants_delete_confirm,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComVariant/deleteVariant",i,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page_content_tab_variant_content_container","meliscommerce_products_page_content_tab_variant_content_container",{productId:melisCommerce.getCurrentProductId()}),melisHelper.tabClose(t+"_id_meliscommerce_variants_page")):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()},function(e){console.log(e)})}),melisCoreTool.done(e)}),e.on("click",".save-variant",function(){melisCoreTool.pending(".save-variant");var e,t,i=$(this).closest(".container-level-a").data("prodid"),s=i+"_id_meliscommerce_products_page",o=$(this).closest(".container-level-a").attr("id"),a=isNaN(parseInt(o,10))?"":parseInt(o,10),r=isNaN(parseInt(o,10))?"":parseInt(o,10)+"_",n=$(this).closest(".container-level-a").find("form"),l=[];t=0,n.each(function(){var i=$(this).attr("name"),s=$(this).serializeArray();for(e=s.length,j=0;j<e;j++)l.push({name:i+"["+t+"]["+s[j].name+"]",value:s[j].value});t++}),l.push({name:"variantId",value:a}),l=melisCommerceSeo.serializeSeo("variant",a,l),l.push({name:"variant[0][var_id]",value:a},{name:"variant[0][var_prd_id]",value:i}),$("#"+o).find(".make-switch div").each(function(){var e="variant[0]["+$(this).find("input").attr("name")+"]",t=$(this).hasClass("switch-on"),i=0;t&&(i=1),l.push({name:e,value:i})}),melisCommerce.postSave("melis/MelisCommerce/MelisComVariant/saveVariant",l,function(e){if(e.success)melisHelper.tabClose(r+"id_meliscommerce_variants_page"),melisHelper.tabOpen(e.chunk.varSku,"icon-tag-2",e.chunk.variantId+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:e.chunk.variantId,productId:i},s),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(i+"_id_meliscommerce_products_page_content_tab_variant_content_container","meliscommerce_products_page_content_tab_variant_content_container",{productId:i}),melisCommerce.setUniqueId(e.chunk.variantId),melisCore.flashMessenger();else{melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors);var t="id_meliscommerce_variant_content";e.chunk.variantId&&(t=e.chunk.variantId+"id_meliscommerce_variant_content"),melisCoreTool.highlightErrors(0,e.errors,t)}melisCoreTool.done(".save-variant"),melisCore.flashMessenger()},function(e){console.log(e)})}),e.on("mouseenter mouseleave",".toolTipVarHoverEvent",function(e){var t=$(this).data("variantid"),i=$(this).closest(".container-level-a").attr("id").replace(/[^0-9]/g,"");$.each($("table#variantTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">Loading...</span><br/></div>').insertAfter("table#variantTable"+t+" thead");var s=$.ajax({type:"POST",url:"melis/MelisCommerce/MelisComProductList/getToolTip",data:{variantId:t,productId:i},dataType:"json",encode:!0}).success(function(e){$("div.qtipLoader").remove(),0===e.content.length?$('<div class="qtipLoader"><hr/><span class="text-center col-lg-12">'+translations.tr_meliscommerce_product_tooltip_no_variants+"</span><br/></div>").insertAfter("table.qtipTable thead"):($.each($("table#variantTable"+t+" thead").nextAll(),function(e,t){$(t).remove()}),$.each(e.content.reverse(),function(e,i){$(i).insertAfter("table#variantTable"+t+" thead")}))});"mouseout"===e.type&&s.abort()}),e.on("click",".updateVariantStatus",function(){var e=$(this),t="",i={},s="",o="",a="",r=e.closest("tr").attr("id"),n=e.closest("tr").attr("var_status"),l=e.closest(".container-level-a").attr("id").replace(/[^0-9]/g,"");0==n?(s=1,o="text-success",a="btn-danger",t=translations.tr_meliscommerce_variants_deactivate_status_title):(s=0,o="text-danger",a="btn-success",t=translations.tr_meliscommerce_variants_activate_status_title),i.id=r,i.var_status=s,$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComVariantList/updateVariantStatus",data:$.param(i),beforeSend:function(){e.addClass("disabled").attr("disabled",!0),e.find(".variant-update-icon-rotate").removeClass(function(e,t){return(t.match(/(^|\s)fa-\S+/g)||[]).join(" ")}).addClass("fa-spinner fa-pulse fa-fw")}}).success(function(i){i.success&&(e.closest("tr").attr("var_status",s),e.find(".variant-update-icon-rotate").removeClass(function(e,t){return(t.match(/(^|\s)fa-\S+/g)||[]).join(" ")}).addClass("fa-arrow-circle-up"),e.removeClass(function(e,t){return(t.match(/(^|\s)btn-\S+/g)||[]).join(" ")}).addClass(a),e.closest("tr").find(".var-status-indicator").removeClass(function(e,t){return(t.match(/(^|\s)text-\S+/g)||[]).join(" ")}).addClass(o),e.find(".variant-update-icon-rotate").toggleClass("down"),$("#"+r+"_id_meliscommerce_variant_tab_main_header_container").length&&melisHelper.zoneReload(r+"_id_meliscommerce_variant_tab_main_header_container","meliscommerce_variant_tab_main_header_container",{productId:l,variantId:r}),e.attr("title",t)),e.removeClass("disabled").attr("disabled",!1)})})}),window.initProductVariant=function(e,t){var i=$("#"+t.sTableId).data("prodid");e.prodId=i},window.variantLoaded=function(){var e=$(".tab-pane#"+activeTabId).data("prodid"),t=e+"_id_meliscommerce_products_page";melisCommerce.enableTab(t)},window.checkVarStatus=function(){var e="",t="";e=void 0!=$(".updateVariantStatus").closest(".container-level-a.active").attr("id")?$(".updateVariantStatus").closest(".container-level-a.active").attr("id").replace(/[^0-9]/g,""):$(".save-variant").closest(".container-level-a.active").data("prodid"),$("#"+e+"_tableProductVariantList tbody tr").each(function(){var e=$(this).attr("var_status");if(void 0!=e){var i="btn-danger",s=$(this).find(".variant-update-icon-rotate");0==e?(i="btn-success",t=translations.tr_meliscommerce_variants_activate_status_title):(s.toggleClass("down"),t=translations.tr_meliscommerce_variants_deactivate_status_title),s.closest("a").removeClass(function(e,t){return(t.match(/(^|\s)btn-\S+/g)||[]).join(" ")}).addClass(i).attr("title",t)}})},$(function(){$("body").on("keyup keydown change","input[name='eseo_meta_title']",{limit:60},seoCharCounter),$("body").on("keyup keydown change","textarea[name='eseo_meta_description']",{limit:160},seoCharCounter)}),window.preSeoCharCounter=function(){$("form.seoForm").each(function(){var e=$(this),t=e.find("input[name='eseo_meta_title']"),i=e.find("textarea[name='eseo_meta_description']");t.trigger("keyup"),i.trigger("keyup")})},window.seoCharCounter=function(e){var t=$(this).val().length,i=$(this).prev("label"),s=e.data.limit;i.find("span").length?0===t?(i.removeClass("limit"),i.find("span").remove()):(i.find("span").html('<i class="fa fa-text-width"></i>('+t+")"),t>s?(i.addClass("limit"),
i.find("span").addClass("limit")):(i.removeClass("limit"),i.find("span").removeClass("limit"))):0!==t&&(i.append("<span class='text-counter-indicator'><i class='fa fa-text-width'></i>("+t+")</span>"),t>s&&(i.addClass("limit"),i.find("span").addClass("limit")))};var melisCommerceSeo=function(e){function t(e,t,i){var s=new Array;return $("form."+e+"_"+t+"_seo_form").each(function(){langId=$(this).data("langid"),s=$(this).serializeArray(),$.each(s,function(){i.push({name:e+"_seo["+langId+"]["+this.name+"]",value:this.value})})}),i}return{serializeSeo:t}}(window);$(function(){$("body").on("click",".addNewClient",function(){melisHelper.tabOpen(translations.tr_meliscommerce_clients_add_client,"fa fa-user-plus","0_id_meliscommerce_client_page","meliscommerce_client_page",{clientId:0},"id_meliscommerce_clients_list_page")}),$("body").on("click",function(e){$(e.target).hasClass("modal")&&($("#id_meliscommerce_client_modal_contact_form_container").modal("hide"),$("#id_meliscommerce_client_modal_contact_address_form_container").modal("hide"),$("#id_meliscommerce_client_modal_address_form_container").modal("hide"))}),$("body").on("click",".viewCleintInfo",function(){var e=$(this).parents("tr").attr("id");dataString=new Array,dataString.push({name:"clientId",value:e}),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClient/getClientContactName",data:dataString,dataType:"json",encode:!0,cache:!1}).done(function(t){if($("#saveClientContact").button("reset"),t.success){melisHelper.tabOpen(t.clientContactName,"fa fa-user",e+"_id_meliscommerce_client_page","meliscommerce_client_page",{clientId:e},"id_meliscommerce_clients_list_page")}else melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors)}).fail(function(){$("#saveClientContact").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".addNewContact",function(){var e=$(this).data("clientid");$(".addNewContact").button("loading"),zoneId="id_meliscommerce_client_modal_contact_form",melisKey="meliscommerce_client_modal_contact_form",modalUrl="/melis/MelisCommerce/MelisComClient/renderClientModal",melisHelper.createModal(zoneId,melisKey,!1,{clientId:e},modalUrl,function(){$(".addNewContact").button("reset")})}),$("body").on("click","#saveClientContact",function(){var e=$(this).data("clientid");dataString=$("#melisCommerceClientContactFormModal").serializeArray(),dataString.push({name:"clientId",value:e}),dataString=$.param(dataString),$("#saveClientContact").button("loading"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClient/addClientContact",data:dataString,dataType:"json",encode:!0,cache:!1}).done(function(t){$("#saveClientContact").button("reset"),t.success?($("#"+e+"_client_contact_tab_nav").append(t.clientContactDom.tabNav),$("#"+e+"_client_contact_tab_content").append(t.clientContactDom.tabContent),$("#nav_"+t.clientContactDom.tabId).tab("show"),$("#id_meliscommerce_client_modal_contact_form_container").modal("hide")):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,"melisCommerceClientContactFormModal"))}).fail(function(){$("#saveClientContact").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".addNewContactAddress",function(){var e=$(this).data("clientid"),t=$(this).data("tabid");$(".addNewContactAddress").button("loading"),zoneId="id_meliscommerce_client_modal_contact_address_form",melisKey="meliscommerce_client_modal_contact_address_form",modalUrl="/melis/MelisCommerce/MelisComClient/renderClientModal",melisHelper.createModal(zoneId,melisKey,!1,{clientId:e,tabId:t},modalUrl,function(){$(".addNewContactAddress").button("reset")})}),$("body").on("click","#saveClientContactAddress",function(){var e=$(this).data("clientid"),t=$(this).data("tabid");dataString=$("#melisCommerceClientContactAddressFormModal").serializeArray(),dataString.push({name:"clientId",value:e}),dataString.push({name:"tabId",value:t}),dataString=$.param(dataString),$("#saveClientContactAddress").button("loading"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClient/addClientContactAddress",data:dataString,dataType:"json",encode:!0,cache:!1}).done(function(e){$("#saveClientContactAddress").button("reset"),e.success?($("#"+t+"_contact_address").append(e.clientContactAddressDom.accordionContent),$("#nav_"+e.clientContactAddressDom.contactAddressId).click(),$("#id_meliscommerce_client_modal_contact_address_form_container").modal("hide")):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"melisCommerceClientContactAddressFormModal"))}).fail(function(){$("#saveClientContactAddress").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".addNewAddress",function(){var e=$(this).data("clientid");$(".addNewAddress").button("loading"),zoneId="id_meliscommerce_client_modal_address_form",melisKey="meliscommerce_client_modal_address_form",modalUrl="/melis/MelisCommerce/MelisComClient/renderClientModal",melisHelper.createModal(zoneId,melisKey,!1,{clientId:e},modalUrl,function(){$(".addNewAddress").button("reset")})}),$("body").on("click","#saveClientAddress",function(){var e=$(this).data("clientid");dataString=$("#melisCommerceClientAddressFormModal").serializeArray(),dataString.push({name:"clientId",value:e}),dataString=$.param(dataString),$("#saveClientAddress").button("loading"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClient/addClientAddress",data:dataString,dataType:"json",encode:!0}).done(function(t){$("#saveClientAddress").button("reset"),t.success?($("#"+e+"_client_address_tab_nav").append(t.clientAddressDom.tabNav),$("#"+e+"_client_address_tab_content").append(t.clientAddressDom.tabContent),$("#nav_add_"+t.clientAddressDom.addressId).tab("show"),$("#id_meliscommerce_client_modal_address_form_container").modal("hide")):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,"melisCommerceClientAddressFormModal"))}).fail(function(){$("#saveClientAddress").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".deleteClientCotactAddress",function(){var e=$(this).data("addressid"),t=$(this).data("addressaccordionid"),i=$(this).data("isnewadded");melisCoreTool.confirm(translations.tr_meliscommerce_clients_common_label_yes,translations.tr_meliscommerce_clients_common_label_no,translations.tr_meliscommerce_client_delete_address,translations.tr_meliscommerce_client_delete_address_confirm_msg,function(){0==i&&$("#deletedClientAddress").append("<input name='deletedaddresses[]' value='"+e+"'>"),$("#"+t+"_contact_address_content").remove()})}),$("body").on("click",".deleteClientAddress",function(){var e=$(this).data("addressid"),t=$(this).data("tabclass"),i=$(this).data("isnewadded");melisCoreTool.confirm(translations.tr_meliscommerce_clients_common_label_yes,translations.tr_meliscommerce_clients_common_label_no,translations.tr_meliscommerce_client_delete_address,translations.tr_meliscommerce_client_delete_address_confirm_msg,function(){0==i&&$("#deletedClientAddress").append("<input name='deletedaddresses[]' value='"+e+"'>"),$("."+t+":first").hasClass("active")&&($("."+t+":first").next().find("a").length?$("."+t+":first").next().find("a").tab("show"):$("."+t+":first").prev().find("a")&&$("."+t+":first").prev().find("a").tab("show")),$("."+t).remove()})}),$("body").on("click",".clientMainContact",function(){var e=$(this).data("clientid"),t=$(this).data("tabid");$(this).hasClass("fa-star-o")?($("#"+e+"_client_contact_tab_content .clientMainContact").removeClass("fa-star"),$("#"+e+"_client_contact_tab_content .clientMainContact").addClass("fa-star-o"),$(this).addClass("fa-star"),$(this).removeClass("fa-star-o"),$("#"+e+"_client_contact_tab_content").find('form input[name="cper_is_main_person"]').val(0),$("#"+t).find("form input[name='cper_is_main_person']").val(1)):($(this).removeClass("fa-star"),$(this).addClass("fa-star-o"),$("#"+t).find("form input[name='cper_is_main_person']").val(0))}),$("body").on("switch-change",".clientContactStatus",function(){var e=($(this).data("clientid"),$(this).data("tabid"));$(this).find(".switch-animate").hasClass("switch-on")?($(this).find(".switch-animate").removeClass("switch-off").addClass("switch-on"),$("#"+e).find("form input[name='cper_status']").val(1)):$("#"+e).find("form input[name='cper_status']").val(0)}),$("body").on("switch-change",".modalClientContactStatus",function(){$(this).data("clientid");$(this).find(".switch-animate").hasClass("switch-on")?($(this).find(".switch-animate").removeClass("switch-off").addClass("switch-on"),$("#melisCommerceClientContactFormModal").find("input[name='cper_status']").val(1)):$("#melisCommerceClientContactFormModal").find("input[name='cper_status']").val(0)}),$("body").on("click",".deleteClientContactAddress",function(){var e=$(this).data("tabclass");melisCoreTool.confirm(translations.tr_meliscommerce_clients_common_label_yes,translations.tr_meliscommerce_clients_common_label_no,translations.tr_meliscommerce_client_delete_new_contact,translations.tr_meliscommerce_client_delete_new_contact_confirm_msg,function(){$("."+e+"_client_contact:first").hasClass("active")&&($("."+e+"_client_contact:first").next().find("a").length?$("."+e+"_client_contact:first").next().find("a").tab("show"):$("."+e+"_client_contact:first").prev().find("a")&&$("."+e+"_client_contact:first").prev().find("a").tab("show")),$("."+e+"_client_contact").remove()})}),$("body").on("click",".saveClientInfo",function(){var e=$(this).data("clientid"),t=new Array;t=$("#"+e+"_id_meliscommerce_client_page form").not(".clientContactForm, .clientContactAddressForm, .clientAddressForm").serializeArray(),$("#"+e+"_id_meliscommerce_client_page form.clientContactForm").addClass(e+"_clientContactForm"),$("."+e+"_clientContactForm").each(function(){var e=$(this).data("tabid"),i=$(this).serializeArray();$.each(i,function(){t.push({name:"clientContacts["+e+"]["+this.name+"]",value:this.value})}),$("#"+e+"_contact_address form").each(function(){var i=$(this).data("contactaddressid"),s=$(this).serializeArray();$.each(s,function(){t.push({name:"clientContacts["+e+"][contact_address]["+i+"]["+this.name+"]",value:this.value})})})}),$("#"+e+"_id_meliscommerce_client_page form.clientAddressForm").addClass(e+"_clientAddressForm"),$("."+e+"_clientAddressForm").each(function(){var e=$(this).data("addressid"),i=$(this).serializeArray();$.each(i,function(){t.push({name:"clientAddresses["+e+"]["+this.name+"]",value:this.value})})}),t.push({name:"clientId",value:e});var i=0;$("#"+e+"_cli_status input").is(":checked")&&(i=1),t.push({name:"cli_status",value:i}),$(this).button("loading"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClient/saveClient",data:t,dataType:"json",encode:!0}).done(function(t){if($(".saveClientInfo").button("reset"),t.success){melisHelper.tabClose(e+"_id_meliscommerce_client_page"),melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.tabOpen(t.clientContactName,"fa fa-user",t.clientId+"_id_meliscommerce_client_page","meliscommerce_client_page",{clientId:t.clientId},"id_meliscommerce_clients_list_page"),melisHelper.zoneReload("id_meliscommerce_clients_list_content","meliscommerce_clients_list_content")}else melisClientKoNotification(t.textTitle,t.textMessage,t.errors),clientHighlightErrors(t.success,t.errors,activeTabId+" form");melisCore.flashMessenger()}).fail(function(){$(".saveClientInfo").button("reset"),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".clientOrderView",function(){var e=$(this).closest("tr").attr("id"),t=$(this).closest("tr").find("td:nth-child(2)").text();melisHelper.tabOpen(translations.tr_meliscommerce_orders_Orders,"fa fa fa-cart-plus fa-2x","id_meliscommerce_order_list_page","meliscommerce_order_list_page");var i=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_order_list_page']"),s=setInterval(function(){i.length&&(melisHelper.tabOpen(t,"fa fa fa-cart-plus fa-2x",e+"_id_meliscommerce_orders_page","meliscommerce_orders_page",{orderId:e},"id_meliscommerce_order_list_page"),clearInterval(s))},500)}),$("body").on("click",".clientOrderListRefresh",function(){var e=$(this).data("clientid");melisHelper.zoneReload(e+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:e,activateTab:!0})}),$("body").on("click",".clientsExport",function(){melisCoreTool.isTableEmpty("clientListTbl")||(zoneId="id_meliscommerce_client_list_content_export_form",melisKey="meliscommerce_client_list_content_export_form",modalUrl="/melis/MelisCommerce/MelisComClientList/renderClientListModal",melisHelper.createModal(zoneId,melisKey,!1,{},modalUrl,function(){melisCoreTool.done(this)}))}),$("body").on("click","#exportClients",function(){var e=$(this),t=e.closest("#id_meliscommerce_client_list_content_export_form").find("form").serializeArray();melisCoreTool.pending(e),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComClientList/clientsExportValidate",data:t,dataType:"json",encode:!0}).done(function(e){e.success?(melisCoreTool.exportData("/melis/MelisCommerce/MelisComClientList/clientsExportToCsv"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(0,e.errors,"id_meliscommerce_client_list_content_export_form"),$(".date_start").prev("label").css("color","#686868"),$(".date_end").prev("label").css("color","#686868"),$.each(e.errors,function(e,t){"date_start"==e&&$(".date_start").prev("label").css("color","red"),"date_end"==e&&$(".date_end").prev("label").css("color","red")}))}),melisCoreTool.done(e)})}),window.clientHighlightErrors=function(e,t,i){0===e?(""!==i&&$("#"+i+" .form-group label").css("color","#686868"),$.each(t,function(e,t){"form"in t?$.each(this.form,function(t,i){$("#"+i+" .form-control[name='"+e+"']").prev("label").css("color","red")}):""!==i&&$("#"+i+" .form-control[name='"+e+"']").prev("label").css("color","red")})):$("#"+i+" .form-group label").css("color","#686868")},window.initClientStatus=function(){$("#cli_status").bootstrapSwitch()},window.initClientOrderList=function(e,t){clientId=$("#"+t.sTableId).data("clientid"),e.clientId=clientId,e.osta_id=$("#"+clientId+"_id_meliscommerce_client_page_tab_orders .orderFilterStatus").val(),e.startDate=$("#"+clientId+"_tableClientOrderList").data("dStartDate"),e.endDate=$("#"+clientId+"_tableClientOrderList").data("dEndDate");t.iDraw>1&&(dateSelectionContent=translations.tr_meliscore_datepicker_select_date+"<i class=\"glyphicon glyphicon-calendar fa fa-calendar\"></i> <span class='sdate'>"+dStartDate+" - "+dEndDate+'</span> <b class="caret"></b>',$("#"+clientId+"_tableClientOrderList_wrapper .dt_orderdatepicker .dt_dateInfo").html(dateSelectionContent)),dStartDate="",dEndDate=""},window.initClientListTitle=function(){$("#"+clientId+"_tableClientOrderList .icon-shippment").parent("th").attr("title",translations.tr_meliscommerce_clients_list_col_products),$("#"+clientId+"_tableClientOrderList .fa-usd").parent("th").attr("title",translations.tr_meliscommerce_clients_list_col_price_title)},window.initClientContactAddressForm=function(){var e=$("#saveClientContactAddress").data("tabid");$("#melisCommerceClientContactAddressFormModal").find("#cadd_civility").val($("#"+e+"_contact_form").find("#cper_civility").val()),$("#melisCommerceClientContactAddressFormModal").find("#cadd_firstname").val($("#"+e+"_contact_form").find("#cper_firstname").val()),$("#melisCommerceClientContactAddressFormModal").find("#cadd_name").val($("#"+e+"_contact_form").find("#cper_name").val()),$("#melisCommerceClientContactAddressFormModal").find("#cadd_middle_name").val($("#"+e+"_contact_form").find("#cper_middle_name").val())},$(document).ready(function(){function e(e,t){melisHelper.tabOpen(e,"fa fa fa-cart-plus fa-2x",t+"_id_meliscommerce_orders_page","meliscommerce_orders_page",{orderId:t},"id_meliscommerce_order_list_page")}var t=$("body");t.on("click",function(e){$(e.target).hasClass("modal")&&($("#id_meliscommerce_order_list_content_status_form_container").modal("hide"),$("#id_meliscommerce_order_modal_content_shipping_form_container").modal("hide"))}),t.on("click",".orderInfo",function(t){var i=$(this),s=i.closest("tr").attr("id"),o=i.closest("tr").find("td:nth-child(2)").text(),a="";i[0].classList[2];a=o.length>0?o:s,melisHelper.tabOpen(translations.tr_meliscommerce_orders_Orders,"fa fa fa-cart-plus fa-2x","id_meliscommerce_order_list_page","meliscommerce_order_list_page");var r=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_order_list_page']"),n=setInterval(function(){r.length&&(e(translations.tr_meliscommerce_orders_Order+" "+a,s),clearInterval(n))},500)}),t.on("click",".addMessage",function(){$(this).closest(".container-level-a").find(".add-message").slideToggle()}),t.on("click",".orderListRefresh",function(){if(melisHelper.zoneReload("id_meliscommerce_order_list_page","meliscommerce_order_list_page"),"coupon"==$("#"+activeTabId).data("pageid")){var e=activeTabId.split("_")[0];melisHelper.zoneReload(e+"_id_meliscommerce_coupon_tabs_content_orders_details_table","meliscommerce_coupon_tabs_content_orders_details_table",{couponId:e})}}),t.on("click",".orderStatusRefresh",function(){melisHelper.zoneReload("id_meliscommerce_order_status_content_table","meliscommerce_order_status_content_table")}),t.on("click",".addNewOrderStatus",function(){var e=$(this).closest("tr").attr("id");zoneId="id_meliscommerce_order_status_form",melisKey="meliscommerce_order_status_form",modalUrl="/melis/MelisCommerce/MelisComOrderStatus/renderOrderStatusModal",melisHelper.createModal(zoneId,melisKey,!1,{ostaId:e},modalUrl,function(){})}),t.on("click",".orderBasketRefresh",function(){var e=$(this).closest(".container-level-a").attr("id"),t=isNaN(parseInt(e,10))?"":parseInt(e,10);melisHelper.zoneReload(t+"_id_meliscommerce_orders_content_tabs_content_baskets_details_list","meliscommerce_orders_content_tabs_content_baskets_details_list",{orderId:t})}),t.on("click",".orderList",function(){melisHelper.tabOpen(translations.tr_meliscommerce_orders_Orders,"fa fa fa-cart-plus fa-2x","id_meliscommerce_order_list_page","meliscommerce_order_list_page")}),t.on("click",".saveOrder",function(){melisCoreTool.pending(".saveOrder");var t,i="melis/MelisCommerce/MelisComOrder/saveOrder",s=$(this).closest(".container-level-a").attr("id"),o=isNaN(parseInt(s,10))?"":parseInt(s,10),a=$(this).closest(".container-level-a").find("form"),r=[],n=0,l=$(this).closest(".container-level-a").find(".selectedStatus").data("statusid"),c=$(this).closest(".container-level-a").find("input[name=ord_reference]").val(),d=$(this).data("orderstatus");a.each(function(){var e=$(this).attr("name"),i=$(this).serializeArray();for(t=i.length,j=0;j<t;j++)r.push({name:e+"["+n+"]["+i[j].name+"]",value:i[j].value});n++}),r.push({name:"orderId",value:o}),r.push({name:"order[0][ord_status]",value:l}),r.push({name:"lastStatus",value:d}),5==l&&5!=d?melisCoreTool.confirm(translations.tr_meliscommerce_order_common_label_yes,translations.tr_meliscommerce_order_common_label_no,c,translations.tr_meliscommerce_order_save_status_canceled_confirm,function(){melisCommerce.postSave(i,r,function(t){t.success?(melisHelper.tabClose(o+"_id_meliscommerce_orders_page"),e(translations.tr_meliscommerce_orders_Order+" "+t.chunk.order.ord_reference,t.chunk.order.ord_id),melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.zoneReload("id_meliscommerce_order_list_page","meliscommerce_order_list_page"),melisCore.flashMessenger(),t.clientId+"_id_meliscommerce_client_page_tab_orders".length&&melisHelper.zoneReload(t.clientId+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:t.clientId,activateTab:!0})):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,o+"_id_meliscommerce_orders_page"))},function(e){console.log(e)})}):melisCommerce.postSave(i,r,function(t){t.success?(melisHelper.tabClose(o+"_id_meliscommerce_orders_page"),e(translations.tr_meliscommerce_orders_Order+" "+t.chunk.order.ord_reference,t.chunk.order.ord_id),melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.zoneReload("id_meliscommerce_order_list_page","meliscommerce_order_list_page"),melisCore.flashMessenger(),t.clientId+"_id_meliscommerce_client_page_tab_orders".length&&melisHelper.zoneReload(t.clientId+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:t.clientId,activateTab:!0})):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,o+"_id_meliscommerce_orders_page"))},function(e){console.log(e)}),melisCoreTool.done(".saveOrder")}),t.on("click",".add-order-message",function(){var e=$(this).closest(".container-level-a").attr("id"),t=isNaN(parseInt(e,10))?"":parseInt(e,10),i=$(this).closest("div").find("form").serializeArray();i.push({name:"orderId",value:t}),melisCoreTool.pending(this),melisCommerce.postSave("melis/MelisCommerce/MelisComOrder/saveOrderMessage",i,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(t+"_id_meliscommerce_orders_content_tabs_content_messages_details","meliscommerce_orders_content_tabs_content_messages_details",{orderId:t})):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,t+"_id_meliscommerce_orders_page"))},function(e){console.log(e)}),melisCoreTool.done(this)}),t.on("click",".updateListStatus",function(){var e=$(this).data("orderid");melisCoreTool.pending(this),zoneId="id_meliscommerce_order_list_content_status_form",melisKey="meliscommerce_order_list_content_status_form",modalUrl="/melis/MelisCommerce/MelisComOrderList/renderOrderListModal",melisHelper.createModal(zoneId,melisKey,!1,{orderId:e},modalUrl,function(){melisCoreTool.done(this)})}),t.on("click",".addShipping",function(){var e=$(this).closest("tr").attr("id");melisCoreTool.pending(this),zoneId="id_meliscommerce_order_modal_content_shipping_form",melisKey="meliscommerce_order_modal_content_shipping_form",modalUrl="/melis/MelisCommerce/MelisComOrder/renderOrderModal",melisHelper.createModal(zoneId,melisKey,!1,{orderId:e},modalUrl,function(){}),melisCoreTool.done(this)}),t.on("click","#saveOrderStatus",function(){var e=$(this).closest("#id_meliscommerce_order_list_content_status_form").find("form").serializeArray(),t="melis/MelisCommerce/MelisComOrderList/saveOrderStatus",i=$('#id_meliscommerce_order_list_content_status_form select[name="ord_status"]').val(),s=translations.tr_meliscommerce_orders_Order+" "+$(this).data("reference");melisCoreTool.pending(this),5==i?melisCoreTool.confirm(translations.tr_meliscommerce_order_common_label_yes,translations.tr_meliscommerce_order_common_label_no,s,translations.tr_meliscommerce_order_save_status_canceled_confirm,function(){melisCommerce.postSave(t,e,function(e){if(e.success){if(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_order_list_page","meliscommerce_order_list_page"),e.clientId+"_id_meliscommerce_client_page_tab_orders".length&&melisHelper.zoneReload(e.clientId+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:e.clientId,activateTab:!0}),"coupon"==$("#"+activeTabId).data("pageid")){var t=activeTabId.split("_")[0];melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_orders_details_table","meliscommerce_coupon_tabs_content_orders_details_table",{couponId:t})}melisCore.flashMessenger()}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_order_list_content_status_form")},function(e){console.log(e)})}):melisCommerce.postSave(t,e,function(e){if(e.success){if(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_order_list_page","meliscommerce_order_list_page"),e.clientId+"_id_meliscommerce_client_page_tab_orders".length&&melisHelper.zoneReload(e.clientId+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:e.clientId,activateTab:!0}),"coupon"==$("#"+activeTabId).data("pageid")){var t=activeTabId.split("_")[0];melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_orders_details_table","meliscommerce_coupon_tabs_content_orders_details_table",{couponId:t})}melisCore.flashMessenger()}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_order_list_content_status_form")},function(e){console.log(e)}),melisCoreTool.done(this),$("#id_meliscommerce_order_list_content_status_form_container").modal("hide")}),t.on("click","#saveOrderShipping",function(){var e,t=$(this).closest("#id_meliscommerce_order_modal_content_shipping_form").find("form"),i=$("#"+activeTabId+" input[name=ord_reference]").val(),s=$("#"+activeTabId+" .selectedStatus").data("statusid"),o=$("#"+activeTabId).attr("id"),a=isNaN(parseInt(o,10))?"":parseInt(o,10),r=[],n=0;melisCoreTool.pending(this),t.each(function(){var t=$(this).attr("name"),i=$(this).serializeArray();for(e=i.length,j=0;j<e;j++)r.push({name:t+"["+n+"]["+i[j].name+"]",value:i[j].value});n++}),r.push({name:"order[0][ord_id]",value:a}),r.push({name:"order[0][ord_reference]",value:i}),r.push({name:"order[0][ord_status]",value:s}),r.push({name:"orderId",value:a}),melisCommerce.postSave("melis/MelisCommerce/MelisComOrder/saveOrder",r,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),e.clientId+"_id_meliscommerce_client_page_tab_orders".length&&melisHelper.zoneReload(e.clientId+"_id_meliscommerce_client_page_tab_orders","meliscommerce_client_page_tab_orders",{clientId:e.clientId,activateTab:!0}),$("#id_meliscommerce_order_modal_content_shipping_form_container").modal("hide"),melisHelper.zoneReload(a+"_id_meliscommerce_orders_content_tabs_content_shipping_details","meliscommerce_orders_content_tabs_content_shipping_details",{orderId:a}),melisCore.flashMessenger()):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_order_modal_content_shipping_form"),$("#id_meliscommerce_order_modal_content_shipping_form .shippingDate").prev("label").css("color","#686868"),$.each(e.errors,function(e,t){"oship_date_sent"==e&&$("#id_meliscommerce_order_modal_content_shipping_form .shippingDate").prev("label").css("color","red")}))},function(e){console.log(e)}),melisCoreTool.done(this)}),t.on("click",".mainOrderStatus",function(){$(this).parent().find(".mainOrderStatus").each(function(){$(this).removeClass("selectedStatus");var e=$(this).find("span"),t=e.css("border-top-color");e.css("color",t),e.css("background","#fff")}),$(this).addClass("selectedStatus");var e=$(this).find("span"),t=e.css("border-top-color");e.css("color","#fff"),e.css("background",t)}),t.on("apply.daterangepicker",".dt_orderdatepicker",function(e,t){var i=$(this).parents().eq(5).find("table").attr("id");$("#"+i).data("dStartDate",dStartDate),$("#"+i).data("dEndDate",dEndDate),$("#"+i).DataTable().ajax.reload()}),t.on("change",".orderFilterStatus",function(){var e=$(this).parents().eq(6).find("table").attr("id");$("#"+e).DataTable().ajax.reload()}),t.on("click",".variantInfo",function(){var e=$(this),t=e.closest("tr").data("variantid"),i=e.closest("tr").data("sku"),s=e.closest("tr").data("productid"),o=e.closest("tr").find("td:nth-child(3)").text(),a=s+"_id_meliscommerce_products_page",r="id_meliscommerce_product_list_container";$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_product_list_container']").length>0?(melisCommerce.disableAllTabs(),melisCommerce.openProductPage(s,o,r,function(){melisCommerce.setUniqueId(s),melisHelper.tabOpen(i,"icon-tag-2",t+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:t,productId:s},a),melisCommerce.setUniqueId(t),melisCommerce.enableAllTabs()})):melisHelper.tabOpen("Products","icon-shippment","id_meliscommerce_product_list_container","meliscommerce_product_list_container","",r,function(){melisCommerce.disableAllTabs(),melisCommerce.openProductPage(s,o,r,function(){melisCommerce.setUniqueId(s),melisHelper.tabOpen(i,"icon-tag-2",t+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:t,productId:s},a),melisCommerce.setUniqueId(t),melisCommerce.enableAllTabs()})})}),t.on("click",".ordersExport",function(){melisCoreTool.isTableEmpty("tableOrderList")||(zoneId="id_meliscommerce_order_list_content_export_form",melisKey="meliscommerce_order_list_content_export_form",modalUrl="/melis/MelisCommerce/MelisComOrderList/renderOrderListModal",melisHelper.createModal(zoneId,melisKey,!1,{},modalUrl,function(){melisCoreTool.done(this)}))}),t.on("click","#exportOrders",function(){var e=$(this),t=e.closest("#id_meliscommerce_order_list_content_export_form").find("form").serializeArray();melisCoreTool.pending(e),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderList/ordersExportValidate",data:t,dataType:"json",encode:!0}).done(function(e){e.success?(melisCoreTool.exportData("/melis/MelisCommerce/MelisComOrderList/ordersExportToCsv"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(0,e.errors,"id_meliscommerce_order_list_content_export_form"),$(".date_start").prev("label").css("color","#686868"),$(".date_end").prev("label").css("color","#686868"),$.each(e.errors,function(e,t){"date_start"==e&&$(".date_start").prev("label").css("color","red"),"date_end"==e&&$(".date_end").prev("label").css("color","red")}))}),melisCoreTool.done(e)}),t.on("click","#saveOrderStatusForm",function(){var e,t=$(this),i=t.data("statusid"),s=$("#id_meliscommerce_order_status_form_container .make-switch div").hasClass("switch-on"),o=$("#id_meliscommerce_order_status_form_container").find("form"),a=[],r=0,n=0;s&&(n=1),o.each(function(){var t=$(this).attr("name"),i=$(this).serializeArray();for(e=i.length,j=0;j<e;j++)a.push({name:t+"["+r+"]["+i[j].name+"]",value:i[j].value});r++}),a.push({name:"statusId",value:i}),a.push({name:"order_status[0][osta_status]",value:n}),melisCoreTool.pending(this),melisCommerce.postSave("melis/MelisCommerce/MelisComOrderStatus/saveOrderStatus",a,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_order_status_content_table","meliscommerce_order_status_content_table"),$("#id_meliscommerce_order_status_form_container").modal("hide")):(melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_order_status_form_container"),$.each(e.errors,function(e,t){"osta_color_code"==e&&$(".osta_color_code").prev("label").css("color","red")}),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)),melisCore.flashMessenger()},function(e){console.log(e)}),melisCoreTool.done(this)}),t.on("click",".orderStatusDelete",function(){var e=$(this).closest("tr").attr("id"),t=[];t.push({name:"ostaId",value:e}),melisCoreTool.pending(this),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_order_status_tool_leftmenu,translations.tr_meliscommerce_order_status_delete_confirm,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComOrderStatus/deleteOrderStatus",t,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_order_status_content_table","meliscommerce_order_status_content_table"),
melisHelper.tabClose(couponId+"_id_meliscommerce_coupon_page")):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()},function(e){console.log(e)})}),melisCoreTool.done(this)})}),window.initOrderBasket=function(e,t){var i=$("#"+t.sTableId).data("orderid");e.orderId=i},window.hideBasketButton=function(e,t){$(".variantInfo").each(function(){variantId=$(this).closest("tr").data("variantid"),productId=$(this).closest("tr").data("productid"),null!=variantId&&null!=productId||$(this).hide()})},window.initOrderList=function(e,t){e.osta_id=$("#id_meliscommerce_order_list_content_table .orderFilterStatus").val(),e.startDate=$("#tableOrderList").data("dStartDate"),e.endDate=$("#tableOrderList").data("dEndDate");t.iDraw>1&&(dateSelectionContent=translations.tr_meliscore_datepicker_select_date+"<i class=\"glyphicon glyphicon-calendar fa fa-calendar\"></i> <span class='sdate'>"+dStartDate+" - "+dEndDate+'</span> <b class="caret"></b>',$("#tableOrderList_wrapper .dt_orderdatepicker .dt_dateInfo").html(dateSelectionContent)),dStartDate="",dEndDate=""},window.initOrderListTitle=function(){$("#tableOrderList .icon-shippment").parent("th").attr("title",translations.tr_meliscommerce_order_list_col_products),$("#tableOrderList .fa-usd").parent("th").attr("title",translations.tr_meliscommerce_order_list_col_price_title)},window.initCheckPermStatus=function(e){$("tr.primeStatus td").find(".orderStatusDelete").remove()}(function(e,t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):"object"==typeof exports?module.exports=t(require("jquery")):jQuery&&!jQuery.fn.colorpicker&&t(jQuery)}(0,function(e){"use strict";var t=function(i,s,o,a,r){this.fallbackValue=o?o&&void 0!==o.h?o:this.value={h:0,s:0,b:0,a:1}:null,this.fallbackFormat=a||"rgba",this.hexNumberSignPrefix=!0===r,this.value=this.fallbackValue,this.origFormat=null,this.predefinedColors=s||{},this.colors=e.extend({},t.webColors,this.predefinedColors),i&&(void 0!==i.h?this.value=i:this.setColor(String(i))),this.value||(this.value={h:0,s:0,b:0,a:1})};t.webColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32",transparent:"transparent"},t.prototype={constructor:t,colors:{},predefinedColors:{},getValue:function(){return this.value},setValue:function(e){this.value=e},_sanitizeNumber:function(e){return"number"==typeof e?e:isNaN(e)||null===e||""===e||void 0===e?1:""===e?0:void 0!==e.toLowerCase?(e.match(/^\./)&&(e="0"+e),Math.ceil(100*parseFloat(e))/100):1},isTransparent:function(e){return!(!e||!("string"==typeof e||e instanceof String))&&("transparent"===(e=e.toLowerCase().trim())||e.match(/#?00000000/)||e.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(e){return 0===e.r&&0===e.g&&0===e.b&&0===e.a},setColor:function(e){if(e=e.toLowerCase().trim()){if(this.isTransparent(e))return this.value={h:0,s:0,b:0,a:0},!0;var t=this.parse(e);t?(this.value=this.value={h:t.h,s:t.s,b:t.b,a:t.a},this.origFormat||(this.origFormat=t.format)):this.fallbackValue&&(this.value=this.fallbackValue)}return!1},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setBrightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=Math.round(parseInt(100*(1-e),10)/100*100)/100},toRGB:function(e,t,i,s){0===arguments.length&&(e=this.value.h,t=this.value.s,i=this.value.b,s=this.value.a),e*=360;var o,a,r,n,l;return e=e%360/60,l=i*t,n=l*(1-Math.abs(e%2-1)),o=a=r=i-l,e=~~e,o+=[l,n,0,0,n,l][e],a+=[n,l,l,n,0,0][e],r+=[0,0,n,l,l,n][e],{r:Math.round(255*o),g:Math.round(255*a),b:Math.round(255*r),a:s}},toHex:function(e,t,i,s){0===arguments.length&&(e=this.value.h,t=this.value.s,i=this.value.b,s=this.value.a);var o=this.toRGB(e,t,i,s);return this.rgbaIsTransparent(o)?"transparent":(this.hexNumberSignPrefix?"#":"")+((1<<24)+(parseInt(o.r)<<16)+(parseInt(o.g)<<8)+parseInt(o.b)).toString(16).slice(1)},toHSL:function(e,t,i,s){0===arguments.length&&(e=this.value.h,t=this.value.s,i=this.value.b,s=this.value.a);var o=e,a=(2-t)*i,r=t*i;return r/=a>0&&a<=1?a:2-a,a/=2,r>1&&(r=1),{h:isNaN(o)?0:o,s:isNaN(r)?0:r,l:isNaN(a)?0:a,a:isNaN(s)?0:s}},toAlias:function(e,t,i,s){var o,a=0===arguments.length?this.toHex():this.toHex(e,t,i,s),r="alias"===this.origFormat?a:this.toString(this.origFormat,!1);for(var n in this.colors)if((o=this.colors[n].toLowerCase().trim())===a||o===r)return n;return!1},RGBtoHSB:function(e,t,i,s){e/=255,t/=255,i/=255;var o,a,r,n;return r=Math.max(e,t,i),n=r-Math.min(e,t,i),o=0===n?null:r===e?(t-i)/n:r===t?(i-e)/n+2:(e-t)/n+4,o=(o+360)%6*60/360,a=0===n?0:n/r,{h:this._sanitizeNumber(o),s:a,b:r,a:this._sanitizeNumber(s)}},HueToRGB:function(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e},HSLtoRGB:function(e,t,i,s){t<0&&(t=0);var o;o=i<=.5?i*(1+t):i+t-i*t;var a=2*i-o,r=e+1/3,n=e,l=e-1/3;return[Math.round(255*this.HueToRGB(a,o,r)),Math.round(255*this.HueToRGB(a,o,n)),Math.round(255*this.HueToRGB(a,o,l)),this._sanitizeNumber(s)]},parse:function(t){if(0===arguments.length)return!1;var i,s,o=this,a=!1,r=void 0!==this.colors[t];return r&&(t=this.colors[t].toLowerCase().trim()),e.each(this.stringParsers,function(e,n){var l=n.re.exec(t);return!(i=l&&n.parse.apply(o,[l]))||(a={},s=r?"alias":n.format?n.format:o.getValidFallbackFormat(),a=s.match(/hsla?/)?o.RGBtoHSB.apply(o,o.HSLtoRGB.apply(o,i)):o.RGBtoHSB.apply(o,i),a instanceof Object&&(a.format=s),!1)}),a},getValidFallbackFormat:function(){var e=["rgba","rgb","hex","hsla","hsl"];return this.origFormat&&-1!==e.indexOf(this.origFormat)?this.origFormat:this.fallbackFormat&&-1!==e.indexOf(this.fallbackFormat)?this.fallbackFormat:"rgba"},toString:function(e,i){e=e||this.origFormat||this.fallbackFormat,i=i||!1;var s=!1;switch(e){case"rgb":return s=this.toRGB(),this.rgbaIsTransparent(s)?"transparent":"rgb("+s.r+","+s.g+","+s.b+")";case"rgba":return s=this.toRGB(),"rgba("+s.r+","+s.g+","+s.b+","+s.a+")";case"hsl":return s=this.toHSL(),"hsl("+Math.round(360*s.h)+","+Math.round(100*s.s)+"%,"+Math.round(100*s.l)+"%)";case"hsla":return s=this.toHSL(),"hsla("+Math.round(360*s.h)+","+Math.round(100*s.s)+"%,"+Math.round(100*s.l)+"%,"+s.a+")";case"hex":return this.toHex();case"alias":return s=this.toAlias(),!1===s?this.toString(this.getValidFallbackFormat()):i&&!(s in t.webColors)&&s in this.predefinedColors?this.predefinedColors[s]:s;default:return s}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(e){return[e[1],e[2],e[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1]}}],colorNameToHex:function(e){return void 0!==this.colors[e.toLowerCase()]&&this.colors[e.toLowerCase()]}};var i={horizontal:!1,inline:!1,color:!1,format:!1,input:"input",container:!1,component:".add-on, .input-group-addon",fallbackColor:!1,fallbackFormat:"hex",hexNumberSignPrefix:!0,sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:!1},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:!1}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div><div class="colorpicker-selectors"></div></div>',align:"right",customClass:null,colorSelectors:null},s=function(t,s){this.element=e(t).addClass("colorpicker-element"),this.options=e.extend(!0,{},i,this.element.data(),s),this.component=this.options.component,this.component=!1!==this.component&&this.element.find(this.component),this.component&&0===this.component.length&&(this.component=!1),this.container=!0===this.options.container?this.element:this.options.container,this.container=!1!==this.container&&e(this.container),this.input=this.element.is("input")?this.element:!!this.options.input&&this.element.find(this.options.input),this.input&&0===this.input.length&&(this.input=!1),this.color=this.createColor(!1!==this.options.color?this.options.color:this.getValue()),this.format=!1!==this.options.format?this.options.format:this.color.origFormat,!1!==this.options.color&&(this.updateInput(this.color),this.updateData(this.color));var o=this.picker=e(this.options.template);if(this.options.customClass&&o.addClass(this.options.customClass),this.options.inline?o.addClass("colorpicker-inline colorpicker-visible"):o.addClass("colorpicker-hidden"),this.options.horizontal&&o.addClass("colorpicker-horizontal"),-1===["rgba","hsla","alias"].indexOf(this.format)&&!1!==this.options.format&&"transparent"!==this.getValue()||o.addClass("colorpicker-with-alpha"),"right"===this.options.align&&o.addClass("colorpicker-right"),!0===this.options.inline&&o.addClass("colorpicker-no-arrow"),this.options.colorSelectors){var a=this,r=a.picker.find(".colorpicker-selectors");r.length>0&&(e.each(this.options.colorSelectors,function(t,i){var s=e("<i />").addClass("colorpicker-selectors-color").css("background-color",i).data("class",t).data("alias",t);s.on("mousedown.colorpicker touchstart.colorpicker",function(t){t.preventDefault(),a.setValue("alias"===a.format?e(this).data("alias"):e(this).css("background-color"))}),r.append(s)}),r.show().addClass("colorpicker-visible"))}o.on("mousedown.colorpicker touchstart.colorpicker",e.proxy(function(e){e.target===e.currentTarget&&e.preventDefault()},this)),o.find(".colorpicker-saturation, .colorpicker-hue, .colorpicker-alpha").on("mousedown.colorpicker touchstart.colorpicker",e.proxy(this.mousedown,this)),o.appendTo(this.container?this.container:e("body")),!1!==this.input&&(this.input.on({"keyup.colorpicker":e.proxy(this.keyup,this)}),this.input.on({"change.colorpicker":e.proxy(this.change,this)}),!1===this.component&&this.element.on({"focus.colorpicker":e.proxy(this.show,this)}),!1===this.options.inline&&this.element.on({"focusout.colorpicker":e.proxy(this.hide,this)})),!1!==this.component&&this.component.on({"click.colorpicker":e.proxy(this.show,this)}),!1===this.input&&!1===this.component&&this.element.on({"click.colorpicker":e.proxy(this.show,this)}),!1!==this.input&&!1!==this.component&&"color"===this.input.attr("type")&&this.input.on({"click.colorpicker":e.proxy(this.show,this),"focus.colorpicker":e.proxy(this.show,this)}),this.update(),e(e.proxy(function(){this.element.trigger("create")},this))};s.Color=t,s.prototype={constructor:s,destroy:function(){this.picker.remove(),this.element.removeData("colorpicker","color").off(".colorpicker"),!1!==this.input&&this.input.off(".colorpicker"),!1!==this.component&&this.component.off(".colorpicker"),this.element.removeClass("colorpicker-element"),this.element.trigger({type:"destroy"})},reposition:function(){if(!1!==this.options.inline||this.options.container)return!1;var e=this.container&&this.container[0]!==window.document.body?"position":"offset",t=this.component||this.element,i=t[e]();"right"===this.options.align&&(i.left-=this.picker.outerWidth()-t.outerWidth()),this.picker.css({top:i.top+t.outerHeight(),left:i.left})},show:function(t){this.isDisabled()||(this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.reposition(),e(window).on("resize.colorpicker",e.proxy(this.reposition,this)),!t||this.hasInput()&&"color"!==this.input.attr("type")||t.stopPropagation&&t.preventDefault&&(t.stopPropagation(),t.preventDefault()),!this.component&&this.input||!1!==this.options.inline||e(window.document).on({"mousedown.colorpicker":e.proxy(this.hide,this)}),this.element.trigger({type:"showPicker",color:this.color}))},hide:function(t){if(void 0!==t&&t.target&&(e(t.currentTarget).parents(".colorpicker").length>0||e(t.target).parents(".colorpicker").length>0))return!1;this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),e(window).off("resize.colorpicker",this.reposition),e(window.document).off({"mousedown.colorpicker":this.hide}),this.update(),this.element.trigger({type:"hidePicker",color:this.color})},updateData:function(e){return e=e||this.color.toString(this.format,!1),this.element.data("color",e),e},updateInput:function(e){return e=e||this.color.toString(this.format,!1),!1!==this.input&&(this.input.prop("value",e),this.input.trigger("change")),e},updatePicker:function(e){void 0!==e&&(this.color=this.createColor(e));var t=!1===this.options.horizontal?this.options.sliders:this.options.slidersHorz,i=this.picker.find("i");if(0!==i.length)return!1===this.options.horizontal?(t=this.options.sliders,i.eq(1).css("top",t.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",t.alpha.maxTop*(1-this.color.value.a))):(t=this.options.slidersHorz,i.eq(1).css("left",t.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",t.alpha.maxLeft*(1-this.color.value.a))),i.eq(0).css({top:t.saturation.maxTop-this.color.value.b*t.saturation.maxTop,left:this.color.value.s*t.saturation.maxLeft}),this.picker.find(".colorpicker-saturation").css("backgroundColor",(this.options.hexNumberSignPrefix?"":"#")+this.color.toHex(this.color.value.h,1,1,1)),this.picker.find(".colorpicker-alpha").css("backgroundColor",(this.options.hexNumberSignPrefix?"":"#")+this.color.toHex()),this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(this.format,!0)),e},updateComponent:function(e){var t;if(t=void 0!==e?this.createColor(e):this.color,!1!==this.component){var i=this.component.find("i").eq(0);i.length>0?i.css({backgroundColor:t.toString(this.format,!0)}):this.component.css({backgroundColor:t.toString(this.format,!0)})}return t.toString(this.format,!1)},update:function(e){var t;return!1===this.getValue(!1)&&!0!==e||(t=this.updateComponent(),this.updateInput(t),this.updateData(t),this.updatePicker()),t},setValue:function(e){this.color=this.createColor(e),this.update(!0),this.element.trigger({type:"changeColor",color:this.color,value:e})},createColor:function(e){return new t(e||null,this.options.colorSelectors,this.options.fallbackColor?this.options.fallbackColor:this.color,this.options.fallbackFormat,this.options.hexNumberSignPrefix)},getValue:function(e){e=void 0===e?this.options.fallbackColor:e;var t;return t=this.hasInput()?this.input.val():this.element.data("color"),void 0!==t&&""!==t&&null!==t||(t=e),t},hasInput:function(){return!1!==this.input},isDisabled:function(){return!!this.hasInput()&&!0===this.input.prop("disabled")},disable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!0),this.element.trigger({type:"disable",color:this.color,value:this.getValue()}),!0)},enable:function(){return!!this.hasInput()&&(this.input.prop("disabled",!1),this.element.trigger({type:"enable",color:this.color,value:this.getValue()}),!0)},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(t){!t.pageX&&!t.pageY&&t.originalEvent&&t.originalEvent.touches&&(t.pageX=t.originalEvent.touches[0].pageX,t.pageY=t.originalEvent.touches[0].pageY),t.stopPropagation(),t.preventDefault();var i=e(t.target),s=i.closest("div"),o=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!s.is(".colorpicker")){if(s.is(".colorpicker-saturation"))this.currentSlider=e.extend({},o.saturation);else if(s.is(".colorpicker-hue"))this.currentSlider=e.extend({},o.hue);else{if(!s.is(".colorpicker-alpha"))return!1;this.currentSlider=e.extend({},o.alpha)}var a=s.offset();this.currentSlider.guide=s.find("i")[0].style,this.currentSlider.left=t.pageX-a.left,this.currentSlider.top=t.pageY-a.top,this.mousePointer={left:t.pageX,top:t.pageY},e(window.document).on({"mousemove.colorpicker":e.proxy(this.mousemove,this),"touchmove.colorpicker":e.proxy(this.mousemove,this),"mouseup.colorpicker":e.proxy(this.mouseup,this),"touchend.colorpicker":e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches&&(e.pageX=e.originalEvent.touches[0].pageX,e.pageY=e.originalEvent.touches[0].pageY),e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left))),i=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));return this.currentSlider.guide.left=t+"px",this.currentSlider.guide.top=i+"px",this.currentSlider.callLeft&&this.color[this.currentSlider.callLeft].call(this.color,t/this.currentSlider.maxLeft),this.currentSlider.callTop&&this.color[this.currentSlider.callTop].call(this.color,i/this.currentSlider.maxTop),!1!==this.options.format||"setAlpha"!==this.currentSlider.callTop&&"setAlpha"!==this.currentSlider.callLeft||(1!==this.color.value.a?(this.format="rgba",this.color.origFormat="rgba"):(this.format="hex",this.color.origFormat="hex")),this.update(!0),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(window.document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup}),!1},change:function(e){this.keyup(e)},keyup:function(e){38===e.keyCode?(this.color.value.a<1&&(this.color.value.a=Math.round(100*(this.color.value.a+.01))/100),this.update(!0)):40===e.keyCode?(this.color.value.a>0&&(this.color.value.a=Math.round(100*(this.color.value.a-.01))/100),this.update(!0)):(this.color=this.createColor(this.input.val()),this.color.origFormat&&!1===this.options.format&&(this.format=this.color.origFormat),!1!==this.getValue(!1)&&(this.updateData(),this.updateComponent(),this.updatePicker())),this.element.trigger({type:"changeColor",color:this.color,value:this.input.val()})}},e.colorpicker=s,e.fn.colorpicker=function(t){var i=Array.prototype.slice.call(arguments,1),o=1===this.length,a=null,r=this.each(function(){var o=e(this),r=o.data("colorpicker"),n="object"==typeof t?t:{};r||(r=new s(this,n),o.data("colorpicker",r)),"string"==typeof t?e.isFunction(r[t])?a=r[t].apply(r,i):(i.length&&(r[t]=i[0]),a=r[t]):a=o});return o?a:r},e.fn.colorpicker.constructor=s})),$(function(){$("body").on("keyup keydown change","input[name='eseo_meta_title']",{limit:60},seoCharCounter),$("body").on("keyup keydown change","textarea[name='eseo_meta_description']",{limit:160},seoCharCounter)}),window.preSeoCharCounter=function(){$("form.seoForm").each(function(){var e=$(this),t=e.find("input[name='eseo_meta_title']"),i=e.find("textarea[name='eseo_meta_description']");t.trigger("keyup"),i.trigger("keyup")})},window.seoCharCounter=function(e){var t=$(this).val().length,i=$(this).prev("label"),s=e.data.limit;i.find("span").length?0===t?(i.removeClass("limit"),i.find("span").remove()):(i.find("span").html('<i class="fa fa-text-width"></i>('+t+")"),t>s?(i.addClass("limit"),i.find("span").addClass("limit")):(i.removeClass("limit"),i.find("span").removeClass("limit"))):0!==t&&(i.append("<span class='text-counter-indicator'><i class='fa fa-text-width'></i>("+t+")</span>"),t>s&&(i.addClass("limit"),i.find("span").addClass("limit")))};var melisCommerceSeo=function(e){function t(e,t,i){var s=new Array;return $("form."+e+"_"+t+"_seo_form").each(function(){langId=$(this).data("langid"),s=$(this).serializeArray(),$.each(s,function(){i.push({name:e+"_seo["+langId+"]["+this.name+"]",value:this.value})})}),i}return{serializeSeo:t}}(window);$(document).ready(function(){function e(e){var t=activeTabId.split("_")[0];e.push({name:"ccli_coupon_id",value:t}),melisCommerce.postSave("melis/MelisCommerce/MelisComCoupon/couponClientManagement",e,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assign_details","meliscommerce_coupon_tabs_content_assign_details",{couponId:t}),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assigned_details_table","meliscommerce_coupon_tabs_content_assigned_details_table",{couponId:t})):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()},function(e){console.log(e)}),$("#"+t+"_id_meliscommerce_coupon_tabs_content_assign_details").addClass("active")}function t(e,t,i){var s=i;melisHelper.tabOpen(e,"fa fa-ticket",t+"_id_meliscommerce_coupon_page","meliscommerce_coupon_page",{couponId:t},s)}function i(e){var t=activeTabId.split("_")[0];e.push({name:"cprod_coupon_id",value:t}),melisCommerce.postSave("melis/MelisCommerce/MelisComCoupon/couponProductManagement",e,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assign_product_details_table","meliscommerce_coupon_tabs_content_assign_product_details_table",{couponId:t}),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assigned_product_details_table","meliscommerce_coupon_tabs_content_assigned_product_details_table",{couponId:t})):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()},function(e){console.log(e)})}var s=$("body");s.on("click",".orderPaymentCouponLink",function(){var e=$(this).data("couponid"),i=$(this).data("couponname");melisHelper.tabOpen(translations.tr_meliscommerce_coupon_list_page,"fa fa-ticket","id_meliscommerce_coupon_list_page","meliscommerce_coupon_list_page",{},"");var s=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_coupon_list_page']"),o=setInterval(function(){s.length&&(t(i,e,"id_meliscommerce_coupon_list_page"),clearInterval(o))},500)}),s.on("click",".couponListRefresh",function(){melisHelper.zoneReload("id_meliscommerce_coupon_list_content_table","meliscommerce_coupon_list_content_table")}),s.on("click",".couponAssignedClientListRefresh",function(){var e=activeTabId.split("_")[0];melisHelper.zoneReload(e+"_id_meliscommerce_coupon_tabs_content_assigned_details_table","meliscommerce_coupon_tabs_content_assigned_details_table",{couponId:e})}),s.on("click",".couponClientListRefresh",function(){var e=$(this).parents().eq(5).attr("id"),t=$(this).parents().eq(5).data("meliskey"),i=activeTabId.split("_")[0];melisHelper.zoneReload(e,t,{couponId:i})}),s.on("click",".addNewCoupon",function(){melisHelper.tabOpen(translations.tr_meliscommerce_coupon_list_add_coupon,"fa fa-ticket","0_id_meliscommerce_coupon_page","meliscommerce_coupon_page",{},"id_meliscommerce_coupon_list_page")}),s.on("click",".removeCouponFromClient",function(){melisCoreTool.pending(this);var t=$(this).closest("tr").attr("id"),i=[],s=$(this).closest("td").prev().find("a").data("ccli_id");i.push({name:"ccli_client_id",value:t}),i.push({name:"method",value:"remove"}),i.push({name:"ccliId",value:s}),e(i),melisCoreTool.done(this)}),s.on("click",".addCouponToClient",function(){melisCoreTool.pending(this);var t=$(this).closest("tr").attr("id"),i=[];i.push({name:"ccli_client_id",value:t}),i.push({name:"method",value:"add"}),e(i),melisCoreTool.done(this)}),s.on("click",".saveCoupon",function(){melisCoreTool.pending(this);var e,i=activeTabId.split("_")[0],s=$(this).closest(".container-level-a").find("form"),o=[],a=0;s.each(function(){var t=0,i=$(this).attr("name"),s=$(this).serializeArray();for(e=s.length,j=0;j<e;j++)o.push({name:i+"["+t+"]["+s[j].name+"]",value:s[j].value});t++,a++}),o.push({name:"couponId",value:i}),$("#"+activeTabId+" .make-switch div").each(function(){var e="switch["+$(this).find("input").attr("name")+"]",t=$(this).hasClass("switch-on"),i=0;t&&(i=1),o.push({name:e,value:i})}),melisCommerce.postSave("melis/MelisCommerce/MelisComCoupon/saveCouponData",o,function(e){e.success?(melisHelper.tabClose(i+"_id_meliscommerce_coupon_page"),t(translations.tr_meliscommerce_coupon_page+" "+e.chunk.coup_code,e.chunk.couponId,"id_meliscommerce_coupon_list_page"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscommerce_coupon_list_content_table","meliscommerce_coupon_list_content_table")):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,i+"_id_meliscommerce_coupon_page"),$(".couponEnd").prev("label").css("color","#686868"),$.each(e.errors,function(e,t){"coup_date_valid_end"==e&&$(".couponEnd").prev("label").css("color","red"),"values"==e&&($("#"+i+"_id_meliscommerce_coupon_page .form-control[name='coup_percentage']").prev("label").css("color","red"),$("#"+i+"_id_meliscommerce_coupon_page .form-control[name='coup_discount_value']").prev("label").css("color","red"))})),melisCore.flashMessenger()},function(e){console.log(e)}),melisCoreTool.done(this)}),s.on("click",".couponInfo",function(){var e=$(this).closest("tr").attr("id"),i=$(this).closest("tr").find("td:nth-child(3)").text(),s=e;i.length>0&&(s=i),t(translations.tr_meliscommerce_coupon_page+" "+s,e,"id_meliscommerce_coupon_list_page")}),s.on("click",".couponDelete",function(){var e=$(this).closest("tr").attr("id"),t=[];t.push({name:"couponId",value:e}),melisCoreTool.pending(this),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_coupon_list_page_coupon,translations.tr_meliscommerce_coupon_delete_confirm,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComCouponList/deleteCoupon",t,function(t){t.success?(melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.zoneReload("id_meliscommerce_coupon_list_content_table","meliscommerce_coupon_list_content_table"),melisHelper.tabClose(e+"_id_meliscommerce_coupon_page")):melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCore.flashMessenger()},function(e){console.log(e)})}),melisCoreTool.done(this)}),s.on("click",".couponAssignedDelete",function(){var e=$(this).closest("tr").attr("id"),t=$(this).closest("tr").data("couponid"),i=[];i.push({name:"couponId",value:t}),i.push({name:"clientId",value:e}),melisCoreTool.pending(this),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_coupon_list_page_coupon,translations.tr_meliscommerce_coupon_delete_confirm_remove,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComCoupon/deleteAssignedCoupon",i,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assign_details","meliscommerce_coupon_tabs_content_assign_details",{couponId:t}),melisHelper.zoneReload(t+"_id_meliscommerce_coupon_tabs_content_assigned_details_table","meliscommerce_coupon_tabs_content_assigned_details_table",{couponId:t})):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()},function(e){console.log(e)})}),$("#"+t+"_id_meliscommerce_coupon_tabs_content_assign_details").addClass("active"),melisCoreTool.done(this)}),s.on("click",".addCouponToProduct",function(){melisCoreTool.pending(this);var e=$(this).closest("tr").attr("id"),t=[];t.push({name:"cprod_product_id",value:e}),t.push({name:"method",value:"add"}),i(t),melisCoreTool.done(this)}),s.on("click",".couponAssignedProductDelete",function(){melisCoreTool.pending(this);var e=$(this).closest("tr").attr("id"),t=[];t.push({name:"cprod_product_id",value:e}),t.push({name:"method",value:"remove"}),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_coupon_list_page_coupon,translations.tr_meliscommerce_coupon_delete_confirm_remove_product,function(){i(t)}),melisCoreTool.done(this)})}),window.initCouponClient=function(e,t){var i=$("#"+t.sTableId).data("couponid");e.couponId=i},window.initCouponClientTable=function(){$(".couponNoAddButton .addCouponToClient").remove(),$(".couponNoAddButton .assignedClients").show()},window.initCouponProductTable=function(){$(".couponProductNoAddButton .addCouponToProduct").remove(),$(".couponProductNoAddButton .assignedProduct").show()},window.initCouponOrder=function(e,t){var i=$("#"+t.sTableId).data("couponid");e.couponId=i,
e.osta_id=$("#"+i+"_id_meliscommerce_coupon_tabs_content_orders_details_table .orderFilterStatus").val(),e.startDate=$("#"+i+"_couponOrderList").data("dStartDate"),e.endDate=$("#"+i+"_couponOrderList").data("dEndDate");t.iDraw>1&&(dateSelectionContent=translations.tr_meliscore_datepicker_select_date+"<i class=\"glyphicon glyphicon-calendar fa fa-calendar\"></i> <span class='sdate'>"+dStartDate+" - "+dEndDate+'</span> <b class="caret"></b>',$("#"+i+"_couponOrderList_wrapper .dt_orderdatepicker .dt_dateInfo").html(dateSelectionContent)),dStartDate="",dEndDate=""},window.drawCouponClient=function(){},window.initCheckUsedCoupon=function(){$("#tableCouponList tr.couponUsed td").find(".couponDelete").remove(),$(".couponListNoDeleteButton .couponDelete").remove()},window.initCheckClientUsedCoupon=function(e){$("tr.couponAssigned td").find(".couponAssignedDelete").remove()},window.initMelisCommerceCouponTbl=function(){$(".commerce-coupon-percent").attr("title",translations.tr_meliscommerce_coupon_list_col_percent),$(".commerce-coupon-value").attr("title",translations.tr_meliscommerce_coupon_list_col_money)},window.initMelisCouponProduct=function(e,t){var i=$("#"+t.sTableId).data("couponid"),s=$("#"+t.sTableId).data("assign");e.couponId=i,e.assign=s},$(function(){$("body").on("click",".addNewOrder",function(){melisHelper.tabOpen(translations.tr_meliscommerce_order_checkout_title,"fa fa fa-plus fa-2x","id_meliscommerce_order_checkout","meliscommerce_order_checkout","","id_meliscommerce_order_list_page")}),$("body").on("click",".orderCheckoutProduListViewVariant",function(){var e=$(this).closest("tr"),t=$orderCheckoutProductListTbl.row(e),i=e.attr("id");if(t.child.isShown())t.child.hide(),e.removeClass("shown");else{var s=i+"_id_meliscommerce_order_checkout_product_variant_list",o="meliscommerce_order_checkout_product_variant_list",a='<div class="checkout-product-variant-list" id="'+s+'" melisKey="'+o+'"></div>';t.child(a).show(),e.addClass("shown"),$(".checkout-product-variant-list").attr("style","margin-bottom: 10px;"),melisHelper.zoneReload(s,o,{productId:i})}}),$("body").on("change","#orderCheckoutCountries",function(){$countryId=$(this).val();var e=new Array;e.push({name:"countryId",value:$countryId}),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/orderCheckoutSetCountry",data:e,dataType:"json",encode:!0}).done(function(e){if(e.success){melisHelper.zoneReload("id_meliscommerce_order_checkout_content","meliscommerce_order_checkout_content")}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)}).fail(function(){alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".orderCheckoutVariantAddBasket",function(){var e=$(this).data("variantid"),t=new Array;t.push({name:"var_id",value:e}),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/addBasket",data:t,dataType:"json",encode:!0}).done(function(e){if(e.success){melisHelper.zoneReload("id_meliscommerce_order_checkout_product_bakset","meliscommerce_order_checkout_product_bakset"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)}).fail(function(){alert(translations.tr_meliscore_error_message)})}),$("body").on("change",".orderBasketVariantQty",function(){var e=$(this).data("variantid"),t=parseInt($(this).data("quantity")),i=parseInt($(this).val());t<i?updateVariantbasket("add",e,i):updateVariantbasket("deduct",e,i)}),$("body").on("keydown",".orderBasketVariantQty",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),$("body").on("click",".qty-plus",function(){var e=$(this).data("variantid");variantQty=parseInt($("#"+e+"_orderBasketVariantQty").val())+1,$("#"+e+"_orderBasketVariantQty").val(variantQty),updateVariantbasket("add",e,variantQty)}),$("body").on("click",".qty-minus",function(){var e=$(this).data("variantid");$varQty=$("#"+e+"_orderBasketVariantQty").val(),parseInt($varQty)>0&&(variantQty=parseInt($("#"+e+"_orderBasketVariantQty").val())-1,$("#"+e+"_orderBasketVariantQty").val(variantQty),updateVariantbasket("deduct",e,variantQty))}),$("body").on("click",".orderCheckoutFirstStepBtn",function(){$(".orderCheckoutFirstStepBtn").button("loading"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/checkBasket",dataType:"json",encode:!0}).done(function(e){e.success?$($(".orderCheckoutFirstStepBtn").data("tabid")).tab("show"):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),$(".orderCheckoutFirstStepBtn").button("reset")}).fail(function(){alert(translations.tr_meliscore_error_message),$(".#orderCheckoutFirstStepBtn").button("reset")})}),$("body").on("click",".orderCheckoutNextStep",function(){$("html, body").stop().animate({scrollTop:0},"500","swing")}),$("body").on("click",".orderCheckoutPrevStep",function(){$($(this).data("tabid")).tab("show"),"#id_meliscommerce_order_checkout_select_addresses_step_nav"==$(this).data("tabid")&&(melisHelper.zoneReload("id_meliscommerce_order_checkout_billing_address","meliscommerce_order_checkout_billing_address"),melisHelper.zoneReload("id_meliscommerce_order_checkout_delivery_address","meliscommerce_order_checkout_delivery_address")),$("html, body").stop().animate({scrollTop:0},"500","swing")}),$("body").on("click",".orderCheckoutSelectContact",function(){var e=$(this),t=$(this).closest("tr"),i=t.attr("id"),s=$(this).data("tabid");e.attr("disabled",!0);var o=new Array;o.push({name:"contactId",value:i}),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/selectContact",data:o,dataType:"json",encode:!0}).done(function(t){t.success?($(s).tab("show"),setTimeout(function(){melisHelper.zoneReload("id_meliscommerce_order_checkout_product_bakset","meliscommerce_order_checkout_product_bakset"),melisHelper.zoneReload("id_meliscommerce_order_checkout_billing_address","meliscommerce_order_checkout_billing_address"),melisHelper.zoneReload("id_meliscommerce_order_checkout_delivery_address","meliscommerce_order_checkout_delivery_address")},300)):melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),e.attr("disabled",!1)}).fail(function(){alert(translations.tr_meliscore_error_message),e.attr("disabled",!1)})}),$("body").on("click",".orderCheckoutContactListRefresh",function(){melisHelper.zoneReload("id_meliscommerce_order_checkout_choose_contact_step_content","meliscommerce_order_checkout_choose_contact_step_content")}),$("body").on("change","#orderCheckoutBillingSelect",function(){var e=$(this).val();melisHelper.zoneReload("id_meliscommerce_order_checkout_billing_address","meliscommerce_order_checkout_billing_address",{cadd_id:e,action:1})}),$("body").on("change","#order-checkout-billing-address-same",function(){$(this).is(":checked")?$("#order-checkout-billing-form-zone").addClass("hidden"):$("#order-checkout-billing-form-zone").removeClass("hidden")}),$("body").on("change","#orderCheckoutDeliverySelect",function(){var e=$(this).val();melisHelper.zoneReload("id_meliscommerce_order_checkout_delivery_address","meliscommerce_order_checkout_delivery_address",{cadd_id:e})}),$("body").on("click","#orderCheckoutCreateBillingAdd",function(){melisHelper.zoneReload("id_meliscommerce_order_checkout_billing_address","meliscommerce_order_checkout_billing_address",{emptyBillingAddress:1})}),$("body").on("click","#orderCheckoutCreateDeliveryAdd",function(){melisHelper.zoneReload("id_meliscommerce_order_checkout_delivery_address","meliscommerce_order_checkout_delivery_address",{emptyDeliveryAddress:1})}),$("body").on("click",".orderCheckoutValidateAddresses",function(){var e=$(this),t=new Array,i=$(this).data("tabid");$("#id_meliscommerce_order_checkout_delivery_address form").each(function(){var e=$(this).serializeArray();$.each(e,function(){t.push({name:"delivery["+this.name+"]",value:this.value})})}),$("#deliveryAddressOrderCheckoutForm").hasClass("hidden")&&t.push({name:"delivery[noSelected]",value:!0}),$("#id_meliscommerce_order_checkout_billing_address form").each(function(){var e=$(this).serializeArray();$.each(e,function(){t.push({name:"billing["+this.name+"]",value:this.value})})}),$("#billingAddressOrderCheckoutForm").hasClass("hidden")&&t.push({name:"billing[noSelected]",value:!0});var s=0;$("#order-checkout-billing-address-same").is(":checked")&&(s=1),t.push({name:"billing[sameAddress]",value:s}),e.attr("disabled",!0),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/selectAddresses",data:t,dataType:"json",encode:!0}).done(function(t){t.success?($(i).tab("show"),melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_basket","meliscommerce_order_checkout_summary_basket"),melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_billing_address","meliscommerce_order_checkout_summary_billing_address"),melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_delivery_address","meliscommerce_order_checkout_summary_delivery_address")):(melisHelper.melisMultiKoNotification(t.textTitle,t.textMessage,t.errors),melisHelper.highlightMultiErrors(t.success,t.errors,activeTabId+" form")),e.attr("disabled",!1)}).fail(function(){alert(translations.tr_meliscore_error_message),e.attr("disabled",!1)})}),$("body").on("click","#orderCheckoutValidateCoupon",function(){var e=$("#orderCheckoutCouponCode").val();""!=e&&melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_basket","meliscommerce_order_checkout_summary_basket",{couponCode:e})}),$("body").on("click",".orderValidCoupons i",function(){var e=$(this).closest(".orderValidCoupons").data("couponcode");""!=e&&melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_basket","meliscommerce_order_checkout_summary_basket",{removeCoupon:e})}),$("body").on("change",".orderSummaryBasketVariantQty",function(){var e=$(this).data("variantid"),t=parseInt($(this).data("quantity")),i=parseInt($(this).val());t<i?updateSummaryVariantbasket("add",e,i):updateSummaryVariantbasket("deduct",e,i)}),$("body").on("keydown",".orderSummaryBasketVariantQty",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),$("body").on("click",".summary-qty-plus",function(){var e=$(this).data("variantid");variantQty=parseInt($("#"+e+"_orderSummaryBasketVariantQty").val())+1,$("#"+e+"_orderSummaryBasketVariantQty").val(variantQty),updateSummaryVariantbasket("add",e,variantQty)}),$("body").on("click",".summary-qty-minus",function(){var e=$(this).data("variantid");$varQty=$("#"+e+"_orderSummaryBasketVariantQty").val(),parseInt($varQty)>0&&(variantQty=parseInt($("#"+e+"_orderSummaryBasketVariantQty").val())-1,$("#"+e+"_orderSummaryBasketVariantQty").val(variantQty),updateSummaryVariantbasket("deduct",e,variantQty))}),$("body").on("click",".orderCheckoutConfirmSummary",function(){var e=$(this),t=$(this).data("tabid"),i=new Array;i.push({name:"couponCode",value:$("#orderCheckoutCouponCode").length?$("#orderCheckoutCouponCode").val():""}),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/confirmOrderCheckoutSummary",data:i,dataType:"json",encode:!0}).done(function(i){i.success?($(t).tab("show"),melisHelper.zoneReload("id_meliscommerce_order_checkout_payment_step_content","meliscommerce_order_checkout_payment_step_content")):melisHelper.melisMultiKoNotification(i.textTitle,i.textMessage,i.errors),e.attr("disabled",!1)}).fail(function(){alert(translations.tr_meliscore_error_message),e.attr("disabled",!1)})}),$("body").on("click",".orderCheckoutConfirmPayment",function(){var e=($(this),$(this).data("tabid"));$(e).tab("show");melisHelper.zoneReload("id_meliscommerce_order_checkout_confirmation_step","meliscommerce_order_checkout_confirmation_step",{activateTab:!0}),melisHelper.zoneReload("id_meliscommerce_order_list_content_table","meliscommerce_order_list_content_table")}),$("body").on("change","#orderCheckoutCouponCode",function(){""==$(this).val()&&$(this).parent(".input-group").next().fadeOut("slow")})}),window.productNextButtonState=function(){var e=$(".orderCheckoutFirstStepBtn");$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComOrderCheckout/checkBasket",dataType:"json",encode:!0}).done(function(t){t.success?(e.attr("disabled",!1),e.attr("title","")):(e.attr("disabled",!0),e.attr("title",translations.tr_meliscommerce_order_checkout_product_basket_empty))}).fail(function(){})},window.updateSummaryVariantbasket=function(e,t,i){var s=$("#orderCheckoutCouponCode").val();""==s&&(s=null),melisHelper.zoneReload("id_meliscommerce_order_checkout_summary_basket","meliscommerce_order_checkout_summary_basket",{action:e,variantId:t,variantQty:i,couponCode:s}),setTimeout(function(){melisHelper.zoneReload("id_meliscommerce_order_checkout_product_bakset","meliscommerce_order_checkout_product_bakset")},3e3)},window.updateVariantbasket=function(e,t,i){melisHelper.zoneReload("id_meliscommerce_order_checkout_product_bakset","meliscommerce_order_checkout_product_bakset",{action:e,variantId:t,variantQty:i})},window.initCheckoutSelectContactTable=function(){$(".checkoutSelectContactOrderHeader").attr("title",translations.tr_meliscommerce_checkout_tbl_cper_num_orders)},$(function(){var e=$("body"),t="id_meliscommerce_currency_content_modal_form",i="meliscommerce_currency_content_modal_form",s="/melis/MelisCommerce/MelisComCurrency/renderCurrencyModalContainer";e.on("switch-change",".make-switch",function(e,t){if($(this).find("#cur_status").length&&!1===t.value){var i=$(this).closest("form"),s=i.find("#id_cur_id").val(),o=$(".make-switch");o.bootstrapSwitch("setActive",!1),o.bootstrapSwitch("toggleState",!0,!0),melisCoreTool.pending("#btnComSaveCurrency"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCurrency/getCountriesUsingCurrency",data:{currencyId:s},dataType:"json",encode:!0}).success(function(e){if(e.countries.length>0){var t='<ul class="container">';$.each(e.countries,function(e,i){t+="<li>"+i.ctry_name+"</li>"}),t+="</ul>",BootstrapDialog.show({title:translations.tr_meliscommerce_currency,message:translations.tr_meliscommerce_currency_prompt_are_you_sure+"<br><br>"+translations.tr_meliscommerce_currency_prompt_is_used+"<br>"+t,type:BootstrapDialog.TYPE_WARNING,closable:!0,buttons:[{label:translations.tr_meliscore_common_no,cssClass:"btn-danger pull-left",action:function(e){o.bootstrapSwitch("setActive",!0),melisCoreTool.done("#btnComSaveCurrency"),e.close()}},{label:translations.tr_meliscore_common_yes,cssClass:"btn-success",action:function(e){o.bootstrapSwitch("setActive",!0),o.bootstrapSwitch("toggleState",!0,!0),melisCoreTool.done("#btnComSaveCurrency"),e.close()}}]})}else o.bootstrapSwitch("setActive",!0),o.bootstrapSwitch("toggleState",!0,!0),melisCoreTool.done("#btnComSaveCurrency")}).error(function(){o.bootstrapSwitch("setActive",!0),melisCoreTool.done("#btnComSaveCurrency")})}}),e.on("click","#btnComAddCurrency",function(){melisCoreTool.pending("#btnComAddCurrency"),melisHelper.createModal(t,i,!1,{curId:null,saveType:"new"},s,function(){melisCoreTool.done("#btnComAddCurrency")})}),e.on("click",function(e){$(e.target).hasClass("modal")&&$("#id_meliscommerce_currency_content_modal_form_container").modal("hide")}),e.on("click",".btnEditComCurrency",function(){melisCoreTool.pending(".btnEditComCurrency");var e=$(this).parents("tr").attr("id");melisHelper.createModal(t,i,!1,{curId:e,saveType:"edit"},s,function(){melisCoreTool.done(".btnEditComCurrency")})}),e.on("click","#btnComSaveCurrency",function(){var e=$("form#ecomCurrencyForm").serializeArray();saveType=$("form#ecomCurrencyForm").data("savetype");var t=$("#cur_status").parent().hasClass("switch-on"),i=0;t&&(i=1),e.push({name:"cur_status",value:i}),e.push({name:"saveType",value:saveType}),e=$.param(e),melisCoreTool.pending("#btnComSaveCurrency"),melisCommerce.postSave("/melis/MelisCommerce/MelisComCurrency/save",e,function(e){e.success?($("div.modal").modal("hide"),$("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_currency_content_modal_form form#ecomCurrencyForm")),melisCore.flashMessenger(),melisCoreTool.done("#btnComSaveCurrency")},function(){melisCoreTool.done("#btnComSaveCurrency")})}),e.on("click",".btnComCurrencyDelete",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.pending(".btnComCountryDelete"),melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscommerce_currency_delete_currency,translations.tr_meliscommerce_currency_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCurrency/delete",data:{id:e},dataType:"json",encode:!0}).success(function(e){melisCoreTool.pending(".btnComCurrencyDelete"),e.success?($("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.done(".btnComCurrencyDelete"),melisCore.flashMessenger()}).error(function(){alert(translations.tr_meliscore_error_message)})}),melisCoreTool.done(".btnComCurrencyDelete")}),e.on("click",".btnComCurrencyMakeDefault",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.pending(".btnComCurrencyMakeDefault"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCurrency/setDefaultCurrency",data:{id:e},dataType:"json",encode:!0}).success(function(e){e.success?($("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.done(".btnComCurrencyMakeDefault"),melisCore.flashMessenger()}).error(function(){alert(translations.tr_meliscore_error_message),melisCoreTool.done(".btnComCurrencyMakeDefault")})})}),window.reInitTableEcomCurrency=function(){$("tr.defaultEcomCurrency").find(".btnComCurrencyDelete").remove(),$("tr.defaultEcomCurrency").find(".btnComCurrencyMakeDefault").remove()},$(document).ready(function(){function e(e,t){melisHelper.tabOpen(e,"fa fa-cubes",t+"_id_meliscommerce_attribute_page","meliscommerce_attribute_page",{attributeId:t},"id_meliscommerce_attribute_list_page")}var t=$("body");t.on("click",".attributeListRefresh",function(){melisHelper.zoneReload("id_meliscommerce_attribute_list_content_table","meliscommerce_attribute_list_content_table")}),t.on("click",function(e){$(e.target).hasClass("modal")&&$("#id_meliscommerce_attribute_value_modal_value_form_container").modal("hide")}),t.on("click",".attributeValueRefresh",function(){var e=activeTabId.split("_")[0];melisHelper.zoneReload(e+"_id_meliscommerce_attributes_tabs_content_values_details_table","meliscommerce_attributes_tabs_content_values_details_table",{attributeId:e})}),t.on("click",".addNewAttribute",function(){e(translations.tr_meliscommerce_attribute_page_new_attribute,0)}),t.on("click",".attributeInfo",function(){var t=$(this).closest("tr").attr("id"),i=$(this).closest("tr").find("td:nth-child(5)").text(),s=t;i.length>0&&(s=i),e(translations.tr_meliscommerce_attribute_page+" "+s,t)}),t.on("click",".attributeHeading a",function(){melisHelper.tabOpen(translations.tr_meliscommerce_attribute_list_page,"fa fa-cubes","id_meliscommerce_attribute_list_page","meliscommerce_attribute_list_page")}),t.on("click",".addAttributeValue",function(){var e=activeTabId.split("_")[0];melisCoreTool.pending(this),zoneId="id_meliscommerce_attribute_value_modal_value_form",melisKey="meliscommerce_attribute_value_modal_value_form",modalUrl="/melis/MelisCommerce/MelisComAttribute/renderAttributeModal",melisHelper.createModal(zoneId,melisKey,!1,{attributeId:e},modalUrl,function(){}),melisCoreTool.done(this)}),t.on("click",".attributeValueInfo",function(){var e=activeTabId.split("_")[0],t=$(this).closest("tr").attr("id");melisCoreTool.pending(this),zoneId="id_meliscommerce_attribute_value_modal_value_form",melisKey="meliscommerce_attribute_value_modal_value_form",modalUrl="/melis/MelisCommerce/MelisComAttribute/renderAttributeModal",melisHelper.createModal(zoneId,melisKey,!1,{attributeId:e,attributeValueId:t},modalUrl,function(){}),melisCoreTool.done(this)}),t.on("click",".attributeValueDelete",function(){var e=activeTabId.split("_")[0],t=$(this).closest("tr").attr("id"),i=[];i.push({name:"attributeValueId",value:t}),melisCoreTool.pending(this),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_attribute_value_delete_title,translations.tr_meliscommerce_attribute_value_delete_confirm,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComAttribute/deleteAttributeValue",i,function(t){t.success?(melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.zoneReload(e+"_id_meliscommerce_attributes_tabs_content_values_details_table","meliscommerce_attributes_tabs_content_values_details_table",{attributeId:e})):melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCore.flashMessenger()},function(e){console.log(e)})}),melisCoreTool.done(this)}),t.on("click","#saveAttributeValue",function(){var e,t=activeTabId.split("_")[0],i=$(this).closest("#"+t+"_id_meliscommerce_attribute_value_modal_value_form").find("form"),s=[],o=0;i.each(function(){var t=$(this).attr("name"),i=$(this).serializeArray();for(e=i.length,j=0;j<e;j++)s.push({name:t+"["+o+"]["+i[j].name+"]",value:i[j].value});o++}),s.push({name:"attributeId",value:t}),melisCoreTool.pending(this),melisCommerce.postSave("melis/MelisCommerce/MelisComAttribute/saveAttributeValues",s,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload(t+"_id_meliscommerce_attributes_tabs_content_values_details_table","meliscommerce_attributes_tabs_content_values_details_table",{attributeId:t}),$("#id_meliscommerce_attribute_value_modal_value_form_container").modal("hide")):(melisCoreTool.highlightErrors(e.success,e.errors,t+"_id_meliscommerce_attribute_value_modal_value_form"),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)),melisCore.flashMessenger()},function(e){console.log(e)}),melisCoreTool.done(this)}),t.on("click",".attributeSave",function(){melisCoreTool.pending(this);var t,i=activeTabId.split("_")[0],s=$(this).closest(".container-level-a").find("form"),o=[],a=0;s.each(function(){var e=$(this).find(":input:disabled").removeAttr("disabled"),i=$(this).attr("name"),s=$(this).serializeArray();for(t=s.length,j=0;j<t;j++)o.push({name:i+"["+a+"]["+s[j].name+"]",value:s[j].value});e.attr("disabled","disabled"),a++}),o.push({name:"attributeId",value:i}),$("#"+activeTabId+" .make-switch div").each(function(){var e="switch["+$(this).find("input").attr("name")+"]",t=$(this).hasClass("switch-on"),i=0;t&&(i=1),o.push({name:e,value:i})}),melisCommerce.postSave("melis/MelisCommerce/MelisComAttribute/saveAttribute",o,function(t){t.success?(melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisHelper.tabClose(i+"_id_meliscommerce_attribute_page"),e(translations.tr_meliscommerce_attribute_page+" "+t.chunk.tabName,t.chunk.attributeId),melisHelper.zoneReload("id_meliscommerce_attribute_list_content_table","meliscommerce_attribute_list_content_table")):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,i+"_id_meliscommerce_attribute_page")),melisCore.flashMessenger()},function(e){console.log(e)}),melisCoreTool.done(this)}),t.on("click",".attributeDelete",function(){var e=$(this).closest("tr").attr("id"),t=[];t.push({name:"attributeId",value:e}),melisCoreTool.pending(this),melisCoreTool.confirm(translations.tr_meliscommerce_documents_common_label_yes,translations.tr_meliscommerce_documents_common_label_no,translations.tr_meliscommerce_attribute_delete_title,translations.tr_meliscommerce_attribute_delete_confirm,function(){melisCommerce.postSave("melis/MelisCommerce/MelisComAttributeList/deleteAttribute",t,function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisHelper.zoneReload("id_meliscommerce_attribute_list_content_table","meliscommerce_attribute_list_content_table")):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"closeByButtonOnly"),melisCore.flashMessenger()},function(e){console.log(e)})}),melisCoreTool.done(this)})}),window.initAttributeValue=function(e,t){var i=$("#"+t.sTableId).data("attributeid");e.attributeId=i},$(function(){var e=$("body"),t="id_meliscommerce_language_list_page_content_modal_form",i="meliscommerce_language_list_page_content_modal_form",s="/melis/MelisCommerce/MelisComLanguage/renderLanguageListPageModalContainer";e.on("click",function(e){$(e.target).hasClass("modal")&&$("#id_meliscommerce_language_list_page_content_modal_form_container").modal("hide")}),$(document).on("submit","form#ecomlanguageform",function(e){saveType=$(this).data("savetype");var t=new FormData($(this)[0]),i=$("#elang_status").parent().hasClass("switch-on"),s=0;i&&(s=1),t.append("elang_status",s),t.append("saveType",saveType),melisCoreTool.pending("#btnComSaveLang"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComLanguage/save",data:t,processData:!1,cache:!1,contentType:!1,dataType:"json"}).done(function(e){e.success?($("div.modal").modal("hide"),$("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_language_list_page_content_modal_form form#ecomlanguageform")),melisCore.flashMessenger(),melisCoreTool.done("#btnComSaveLang")}).error(function(e){console.log(e),melisCoreTool.done("#btnComSaveLang")}),e.preventDefault()}),e.on("click",".btnEcomLangDelete",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.pending(".btnEcomLangDelete"),melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscommerce_language_delete,translations.tr_meliscore_tool_language_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComLanguage/delete",data:{id:e},dataType:"json",encode:!0}).success(function(e){melisCoreTool.pending(".btnEcomLangDelete"),e.success?($("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.done(".btnEcomLangDelete"),melisCore.flashMessenger()}).error(function(){alert(translations.tr_meliscore_error_message)})}),melisCoreTool.done(".btnEcomLangDelete")}),e.on("click",".btnEditComLang",function(){melisCoreTool.pending(".btnEditComLang");var e=$(this).parents("tr").attr("id");melisHelper.createModal(t,i,!1,{langId:e,saveType:"edit"},s,function(){melisCoreTool.done(".btnEditComLang")})}),e.on("click","#btnComAddLang",function(){melisCoreTool.pending("#btnComAddLang"),melisHelper.createModal(t,i,!1,{langId:null,saveType:"new"},s,function(){melisCoreTool.done("#btnComAddLang")})})}),$(function(){var e=$("body"),t="id_meliscommerce_country_list_page_content_modal_form",i="meliscommerce_country_list_page_content_modal_form",s="/melis/MelisCommerce/MelisComCountry/renderCountryListPageModalContainer";e.on("click","#btnComAddCountry",function(){melisCoreTool.pending("#btnComAddCountry"),melisHelper.createModal(t,i,!1,{ctryId:null,saveType:"new"},s,function(){melisCoreTool.done("#btnComAddCountry")})}),e.on("click",function(e){$(e.target).hasClass("modal")&&$("#id_meliscommerce_country_list_page_content_modal_form_container").modal("hide")}),e.on("click",".btnEditComCountry",function(){melisCoreTool.pending(".btnEditComCountry");var e=$(this).parents("tr").attr("id");melisHelper.createModal(t,i,!1,{ctryId:e,saveType:"edit"},s,function(){melisCoreTool.done(".btnEditComCountry")})}),$(document).on("submit","form#ecomCountryform",function(e){saveType=$(this).data("savetype");var t=new FormData($(this)[0]),i=$("#ctry_status").parent().hasClass("switch-on"),s=0;i&&(s=1),t.append("ctry_status",s),t.append("saveType",saveType),melisCoreTool.pending("#btnComSaveCountry"),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCountry/save",data:t,processData:!1,cache:!1,contentType:!1,dataType:"json"}).done(function(e){e.success?($("div.modal").modal("hide"),$("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_country_list_page_content_modal_form form#ecomCountryform")),melisCore.flashMessenger(),melisCoreTool.done("#btnComSaveCountry")}).error(function(e){melisCoreTool.done("#btnComSaveCountry")}),e.preventDefault()}),e.on("click",".btnComCountryDelete",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.pending(".btnComCountryDelete"),melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscommerce_country_delete_country,translations.tr_meliscommerce_country_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComCountry/delete",data:{id:e},dataType:"json",encode:!0}).success(function(e){melisCoreTool.pending(".btnComCountryDelete"),e.success?($("#"+activeTabId+" .melis-refreshTable").trigger("click"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.done(".btnComCountryDelete"),melisCore.flashMessenger()}).error(function(){alert(translations.tr_meliscore_error_message)})}),melisCoreTool.done(".btnComCountryDelete")})}),window.loadAssocVariantList=function(e,t){var i=$("#"+t.sTableId).data("variantid");e.variantId=i},$(function(){var body=$("body");body.on("click",".btnAssocVAssign",function(){var e=$(this).data("variantid"),t=$(this).data("productid"),i=$(this).parents(".tableAssocVariantList2"),s=i.attr("id"),o=i.data("variantid"),a=$(this).parents(".variant-assoc-product-variant-list");melisCommerce.disableAllTabs(),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComAssociateVariant/assignVariant",data:{assignVariantid:e,assignToVariantId:o},dataType:"json",encode:!0}).success(function(e){if(e.success){if(melisHelper.zoneReload(o+"_id_meliscommerce_avar_tab_assoc_vars_list","meliscommerce_avar_tab_assoc_vars_list",{variantId:o}),a.length){var i=a.attr("id"),r=a.attr("data-melisKey"),n=$("#"+s+"_filter input[type='search']").val();melisHelper.zoneReload(i,r,{productId:t,variantId:o,search:n})}melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors);melisCommerce.enableAllTabs(),melisCore.flashMessenger()}).error(function(){melisCommerce.enableAllTabs(),alert(translations.tr_meliscore_error_message)})}),body.on("click",".removeAssoc",function(){var e=$(this).closest("tr").attr("id"),t=$(this).parents(".tableAssocVariantList1"),i=t.data("variantid"),s=$(this).closest("tr").attr("data-productid");melisCoreTool.pending(".removeAssociation"),melisCommerce.disableAllTabs(),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComAssociateVariant/removeAssociation",data:{assignedVariantId:e,variantId:i},dataType:"json",encode:!0}).success(function(e){if(e.success){melisHelper.zoneReload(i+"_id_meliscommerce_avar_tab_assoc_vars_list","meliscommerce_avar_tab_assoc_vars_list",{variantId:i});var t=$("#"+s+"_"+i+"_id_meliscommerce_avar_product_variants");if(t.length){
var o=t.attr("id"),a=t.attr("data-melisKey"),r=$(this).parents(".tableAssocVariantList2").attr("id"),n=$("#"+r+"_filter input[type='search']").val();melisHelper.zoneReload(o,a,{productId:s,variantId:i,search:n})}melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors);melisCoreTool.done(".removeAssociation"),melisCore.flashMessenger(),melisCommerce.enableAllTabs()}).error(function(){alert(translations.tr_meliscore_error_message)})}),body.on("click",".refreshVarList",function(){var e=$(this).closest(".container-level-a").attr("id").replace(/[^0-9]/g,"");melisHelper.zoneReload(e+"_id_meliscommerce_avar_tab_var_lists","meliscommerce_avar_tab_var_lists",{variantId:e})}),body.on("click",".refreshAssocVarList",function(){var e=$(this).closest(".container-level-a").attr("id").replace(/[^0-9]/g,"");melisHelper.zoneReload(e+"_id_meliscommerce_avar_tab_assoc_vars_list","meliscommerce_avar_tab_assoc_vars_list",{variantId:e})}),body.on("click",".btnAVVV1",function(){var e=$(this).parents("tr").children().eq(2).find("span").data().prodId,t=$(this).parents("tr").children().eq(3).find("span").data().sku;melisCommerce.disableAllTabs();var i=$(this).closest("tr").attr("id");melisHelper.tabOpen(t,"icon-tag-2",i+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:i,productId:e}),melisCommerce.enableAllTabs()}),body.on("click",".btnAVVV2",function(){var e=$(this),t=e.data("variantsku"),i=e.data("productid"),s=e.closest("tr").prev("tr").find("td:nth-child(3)").text(),o=i+"_id_meliscommerce_products_page",a="id_meliscommerce_product_list_container",r=e.data("variantid");$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_product_list_container']").length>0?(melisCommerce.disableAllTabs(),melisCommerce.openProductPage(i,s,a,function(){melisHelper.tabOpen(t,"icon-tag-2",r+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:r,productId:i},o),melisCommerce.setUniqueId(r),melisCommerce.enableAllTabs()})):melisHelper.tabOpen("Products","icon-shippment","id_meliscommerce_product_list_container","meliscommerce_product_list_container","",a,function(){melisCommerce.disableAllTabs(),melisCommerce.openProductPage(i,s,a,function(){melisCommerce.setUniqueId(i),melisHelper.tabOpen(t,"icon-tag-2",r+"_id_meliscommerce_variants_page","meliscommerce_variants_page",{variantId:r,productId:i},o),melisCommerce.setUniqueId(r),melisCommerce.enableAllTabs()})})});var curVarId=activeTabId.split("_")[0],assocTableSearch=$("input[type='search'][aria-controls='tableAssocVariantList1_"+curVarId+"']"),varTableSearch=$("input[type='search'][aria-controls='tableAssocVariantList2_"+curVarId+"']");assocTableSearch.keyup(function(){}),body.on("click",".showPrdVariants",function(){var parentTable=$(this).parents(".tableAssocVariantList2"),tableId=parentTable.attr("id"),tableInstance=eval("$"+tableId),currentVariantId=parentTable.data("variantid"),tr=$(this).closest("tr"),row=tableInstance.row(tr),productId=tr.attr("id");if(row.child.isShown())row.child.hide(),tr.removeClass("shown");else{var zoneId=productId+"_"+currentVariantId+"_id_meliscommerce_avar_product_variants",melisKey="meliscommerce_avar_product_variants",variantContainer='<div class="variant-assoc-product-variant-list" id="'+zoneId+'" melisKey="'+melisKey+'" style="height:50px"></div>';row.child(variantContainer).show(),tr.addClass("shown");var search=$("#"+tableId+"_filter input[type='search']").val();$(".checkout-product-variant-list").attr("style","margin-bottom: 10px;"),melisHelper.zoneReload(zoneId,melisKey,{productId:productId,variantId:currentVariantId,search:search})}})}),$(function(){$("body").on("click",".melisComDuplicateVariant",function(){var e=$(this),t=e.parents("tr").attr("id");e.attr("disabled",!0),zoneId="id_meliscommerce_variant_duplication",melisKey="meliscommerce_variant_duplication",modalUrl="/melis/MelisCommerce/MelisComPrdVarDuplication/renderDuplicateModal",melisHelper.createModal(zoneId,melisKey,!1,{variantId:t},modalUrl,function(){e.attr("disabled",!1)})}),$("body").on("click",".melisComDuplicateProduct",function(){var e=$(this),t=e.parents("tr").attr("id");e.attr("disabled",!0),zoneId="id_meliscommerce_product_duplication",melisKey="meliscommerce_product_duplication",modalUrl="/melis/MelisCommerce/MelisComPrdVarDuplication/renderDuplicateModal",melisHelper.createModal(zoneId,melisKey,!1,{productId:t},modalUrl,function(){e.attr("disabled",!1)})}),$("body").on("click","#melisComStartDuplicateVariant",function(){var e=$(this),t=new Array;$("#id_meliscommerce_variant_duplication form").each(function(){var e=$(this).find("input[name='var_id']").val(),i=$(this).serializeArray();$.each(i,function(){"var_id"!==this.name&&t.push({name:"variantSku["+e+"]["+this.name+"]",value:this.value})})});var i=0;$("#duplicate_images").is(":checked")&&(i=1),t.push({name:"duplicate_images",value:i});var s=0;$("#duplicate_documents").is(":checked")&&(s=1),t.push({name:"duplicate_documents",value:s});var o=0;$("#put_online").is(":checked")&&(o=1),t.push({name:"var_status",value:o}),t.push({name:"duplication_type",value:"variant"}),e.attr("disabled",!0),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComPrdVarDuplication/duplicateVariant",data:t,dataType:"json",encode:!0}).done(function(t){e.attr("disabled",!1),t.success?($("#id_meliscommerce_variant_duplication_container").modal("hide"),melisHelper.melisOkNotification(t.textTitle,t.textMessage,"#72af46"),melisHelper.zoneReload(melisCommerce.getCurrentProductId()+"_id_meliscommerce_products_page_content_tab_variant_content_container","meliscommerce_products_page_content_tab_variant_content_container",{productId:melisCommerce.getCurrentProductId()})):melisSKUKoNotification(t.textTitle,t.textMessage,t.errors,"closeByButtonOnly"),highlightSKUErrors(t.success,t.errors),melisCore.flashMessenger()}).fail(function(){e.attr("disabled",!1),alert(translations.tr_meliscore_error_message)})}),$("body").on("click",".main-variant-radio i",function(){console.log($(this).data("variantid")),$(this).addClass("fa-dot-circle-o"),$(this).addClass("text-success"),$(".main-variant-radio i").not(this).addClass("fa-circle-o"),$(".main-variant-radio i").not(this).removeClass("fa-dot-circle-o"),$(".main-variant-radio i").not(this).removeClass("text-success")}),$("body").on("click","#melisComStartDuplicateProduct",function(){var e=$(this),t=new Array;$("#id_meliscommerce_product_duplication form").each(function(){var e=$(this).find("input[name='var_id']").val(),i=$(this).serializeArray();$.each(i,function(){"var_id"!==this.name&&t.push({name:"variantSku["+e+"]["+this.name+"]",value:this.value})})}),t.push({name:"product_id",value:e.data("productid")});var i=0;$("#duplicate_images").is(":checked")&&(i=1),t.push({name:"duplicate_images",value:i});var s=0;$("#duplicate_documents").is(":checked")&&(s=1),t.push({name:"duplicate_documents",value:s});var o=0;$("#put_online").is(":checked")&&(o=1),t.push({name:"prd_status",value:o}),t.push({name:"main_variant_id",value:$(".main-variant-radio i.fa-dot-circle-o").data("variantid")}),t.push({name:"duplication_type",value:"product"}),e.attr("disabled",!0),$.ajax({type:"POST",url:"/melis/MelisCommerce/MelisComPrdVarDuplication/duplicateProduct",data:t,dataType:"json",encode:!0}).done(function(t){e.attr("disabled",!1),t.success?($("#id_meliscommerce_product_duplication_container").modal("hide"),melisHelper.melisOkNotification(t.textTitle,t.textMessage,"#72af46"),melisHelper.zoneReload("id_meliscommerce_product_list_container","meliscommerce_product_list_container")):melisSKUKoNotification(t.textTitle,t.textMessage,t.errors),highlightSKUErrors(t.success,t.errors),melisCore.flashMessenger()}).fail(function(){e.attr("disabled",!1),alert(translations.tr_meliscore_error_message)})})}),$(document).ready(function(){var e=$("body");e.on("click",".addStockAlertEmail",function(){var e=$(this),t=e.closest("div").find(".stockAlertSelect").val(),i=e.closest("div").find(".stockAlertSelect option:selected"),s=e.closest(".email-alert-area").find(".email_area"),o="";o+='<span class="alert-email-values" data-seaid="" data-userid="'+t+'" data-alertemail="'+i.text()+'">',o+='<span class="ab-attr">',o+='<span class="alert-email-value-email">',o+=i.text(),o+="</span>",o+='<i class="alert-email-remove fa fa-times"></i>',o+="</span>",o+="</span>",""!=t&&(i.remove(),s.append(o),e.closest(".email-alert-area").find(".noAlertRecipients").hide())}),e.on("click",".alert-email-values .alert-email-remove",function(){var e=$(this),t=e.closest(".alert-email-values"),i=t.data("userid"),s=t.data("alertemail"),o=e.closest(".email-alert-area").find(".stockAlertSelect"),a=o.val();o.append($("<option>",{value:i,text:s}));var r=e.closest(".email-alert-area").find(".stockAlertSelect option");r.sort(function(e,t){return e.value>t.value?1:e.value<t.value?-1:0}),o.empty().append(r),o.val(a),t.remove()}),e.on("click",".saveSettings",function(){var e=$(this).closest(".container-level-a");melisCommerceSettings.submitStockAlertSettings(e)})});var melisCommerceSettings=function(e){function t(e){var t=$(e).find("#id_meliscommerce_settings_tabs_content_main_details_left form"),i=[],s=$(e).find(".alert-email-values");Array.prototype.push.apply(i,$(t).serializeArray());var o=0,a="",r="",n="";s.each(function(){a=$(this).data("seaid"),r=$(this).data("alertemail"),n=$(this).data("userid"),i.push({name:"recipients["+o+"][sea_id]",value:a}),i.push({name:"recipients["+o+"][sea_email]",value:r}),i.push({name:"recipients["+o+"][sea_user_id]",value:n}),o++}),melisCommerce.postSave("melis/MelisCommerce/MelisComSettings/saveSettings",i,function(e){e.success?(melisHelper.tabClose("id_meliscommerce_settings_page"),melisHelper.tabOpen(translations.tr_meliscommerce_settings,"fa fa-wrench","id_meliscommerce_settings_page","meliscommerce_settings_page",{}),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_meliscommerce_settings_page")),melisCore.flashMessenger()},function(e){})}return{submitStockAlertSettings:t}}(window);$(document).ready(function(){var e=0;$("body").on("change",".com-orders-dash-chart-line",function(){commerceDashboardOrdersLineGraphInit($(this));var e=$(this).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config"),t=JSON.parse(e.text());t.activeFilter=$(this).val(),$(e).text(JSON.stringify(t)),melisDashBoardDragnDrop.saveCurrentDashboard($(this))}),$("body").on("click",".melis-commerce-dashboard-plugin-orders-number-item",function(){var e=$(this).find(".melis-commerce-dashboard-plugin-orders-number-item-id").text(),t=$(this).find(".melis-commerce-dashboard-plugin-orders-number-item-ref").text();melisHelper.tabOpen(translations.tr_meliscommerce_orders_Orders,"fa fa fa-cart-plus fa-2x","id_meliscommerce_order_list_page","meliscommerce_order_list_page");var i=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_order_list_page']"),s=setInterval(function(){if(i.length){melisHelper.tabOpen(translations.tr_meliscommerce_orders_Order+" "+t,"fa fa fa-cart-plus fa-2x",e+"_id_meliscommerce_orders_page","meliscommerce_orders_page",{orderId:e},"id_meliscommerce_order_list_page"),clearInterval(s)}},500)}),charts.commerceDashboardOrdersLineGraph={data:{d1:[]},plot:null,options:{grid:{color:"#dedede",borderWidth:1,borderColor:"#eee",clickable:!0,hoverable:!0,labelMargin:20},series:{lines:{show:!0,fill:!1,lineWidth:2,steps:!1},points:{show:!0,radius:5,lineWidth:3,fill:!0,fillColor:"#000"}},xaxis:{tickColor:"#eee"},yaxis:{show:!0,tickColor:"#eee",min:0,tickDecimals:0},legend:{position:"nw",noColumns:2,backgroundColor:null,backgroundOpacity:0},shadowSize:0,tooltip:!0,tooltipOpts:{content:"%y %s - %x",shifts:{x:-30,y:-50},defaultTheme:!1}},placeholder:".commerce-dashboard-orders-chart-linegraph-placeholder",init:function(){null==this.plot&&commerceDashboardOrdersLineGraphInit()}},window.commerceDashboardOrdersLineGraphInit=function(t,i){var t=t||null,i=i||null,s="";if(null===t){var o=$body.find(".commerce-dashboard-orders-chart-linegraph-placeholder"),a=0;if($body.find(".commerce-dashboard-orders-chart-linegraph-placeholder").each(function(e,t){""==$(this).text()&&a++}),a==$body.find(".commerce-dashboard-orders-chart-linegraph-placeholder").length){var r=$(o[e]).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text();r=JSON.parse(r),e++,e==o.length&&(e=0),s=r.datas.activeFilter,i="#commerce-dashboard-orders-chart-linegraph-placeholder-"+r.plugin_id}else{var n=body.find(".commerce-dashboard-orders-chart-linegraph-placeholder").length-1,r=$(o[n]).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text();r=JSON.parse(r),s=r.datas.activeFilter,i="#commerce-dashboard-orders-chart-linegraph-placeholder-"+r.plugin_id}}else"string"==typeof t?(s=t,i="#commerce-dashboard-orders-chart-linegraph-placeholder-"+i):(s=t.val(),i="#"+t.closest(".tab-pane").find(".commerce-dashboard-orders-chart-linegraph-placeholder").attr("id"));$.ajax({type:"POST",url:"/melis/dashboard-plugin/MelisCommerceDashboardPluginOrdersNumber/getDashboardOrdersData",data:{chartFor:s},dataType:"json",encode:!0}).success(function(e){for(var t=[],o=[],a=e.values.length,r=($(window).width(),0);r<e.values.length;r++){if("hourly"==s)var n=moment(e.values[r][0],"YYYY-MM-DD HH").format("HH");else if("daily"==s)var l=moment(e.values[r][0],"YYYY-MM-DD"),n=l.format("MMM")+"\n"+l.format("DD");else if("weekly"==s)var c=moment(e.values[r][0],"YYYY-MM-DD").format("W"),d=moment().day("Monday").week(c),n=d.format("MMM")+"\n"+d.format("DD");else if("monthly"==s)var n=moment(e.values[r][0],"YYYY-MM-DD").format("MMM");t.push([a,e.values[r][1]]),o.push([a,n]),a--}charts.commerceDashboardOrdersLineGraph.options.xaxis.ticks=o,charts.commerceDashboardOrdersLineGraph.options.tooltipOpts.content="%y %s",charts.commerceDashboardOrdersLineGraph.plot=$.plot($(i),[{label:translations.tr_melis_commerce_dashboard_plugin_orders_number,data:t,color:"#3997d4",lines:{fill:.2},points:{fillColor:"#fff"}}],charts.commerceDashboardOrdersLineGraph.options)}).error(function(e,t,i){console.log("ERROR !! Status = "+t+"\n Error = "+i+"\n xhr = "+e.statusText)})},$body.find(".commerce-dashboard-orders-chart-linegraph-placeholder").each(function(e,t){var i=$(t).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text(),s=JSON.parse(i).activeFilter,o=JSON.parse(i).plugin_id;commerceDashboardOrdersLineGraphInit(s,o)})}),$(document).ready(function(){var e=0;$("body").on("change",".commerce-dashboard-plugin-sales-revenue",function(){commerceDashboardPluginSalesRevenueChartStackedBarsInit($(this));var e=$(this).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config"),t=JSON.parse(e.text());t.activeFilter=$(this).val(),$(e).text(JSON.stringify(t)),melisDashBoardDragnDrop.saveCurrentDashboard($(this))}),charts.commerceDashboardPluginSalesRevenueChartStackedBars={data:null,plot:null,options:{grid:{color:"#dedede",borderWidth:1,borderColor:"transparent",clickable:!0,hoverable:!0,backgroundColor:{colors:["#fff","#fff"]}},series:{stack:!0,grow:{active:!1},bars:{show:!0,barWidth:.5,fill:1,align:"center"}},xaxis:{},yaxis:{min:0,tickDecimals:0},legend:{position:"ne",backgroundColor:null,backgroundOpacity:0,noColumns:2},colors:["#7acc66","#66cccc"],shadowSize:0,tooltip:!0,tooltipOpts:{content:"%s : %y",shifts:{x:-30,y:-50},defaultTheme:!1}},placeholder:".commerce-dashboard-plugin-sales-revenue-placeholder",init:function(){null==this.plot&&commerceDashboardPluginSalesRevenueChartStackedBarsInit()}},window.commerceDashboardPluginSalesRevenueChartStackedBarsInit=function(t,i){var t=t||null,i=i||null,s="";if(null==t){var o=$body.find(".commerce-dashboard-plugin-sales-revenue-placeholder"),a=0;if($body.find(".commerce-dashboard-plugin-sales-revenue-placeholder").each(function(e,t){""==$(this).text()&&a++}),a==$body.find(".commerce-dashboard-plugin-sales-revenue-placeholder").length){var r=$(o[e]).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text();r=JSON.parse(r),e++,e==o.length&&(e=0),s=r.datas.activeFilter,i="#commerce-dashboard-plugin-sales-revenue-placeholder-"+r.plugin_id}else{var n=body.find(".commerce-dashboard-plugin-sales-revenue-placeholder").length-1,r=$(o[n]).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text();r=JSON.parse(r),s=r.datas.activeFilter,i="#commerce-dashboard-plugin-sales-revenue-placeholder-"+r.plugin_id}}else"string"==typeof t?(s=t,i="#commerce-dashboard-plugin-sales-revenue-placeholder-"+i):(s=t.val(),i="#"+t.closest(".tab-pane").find(".commerce-dashboard-plugin-sales-revenue-placeholder").attr("id"));$.ajax({type:"POST",url:"/melis/dashboard-plugin/MelisCommerceDashboardPluginSalesRevenue/getDashboardSalesRevenueData",data:{chartFor:s},dataType:"json",encode:!0}).success(function(e){for(var t=[],o=[],a=[],r=e.values.length,n=($(window).width(),0);n<e.values.length;n++){if("hourly"==s)var l=moment(e.values[n][0],"YYYY-MM-DD HH").format("HH");else if("daily"==s)var c=moment(e.values[n][0],"YYYY-MM-DD"),l=c.format("MMM")+"\n"+c.format("DD");else if("weekly"==s)var d=moment(e.values[n][0],"YYYY-MM-DD").format("W"),h=moment().day("Monday").week(d),l=h.format("MMM")+"\n"+h.format("DD");else if("monthly"==s)var l=moment(e.values[n][0],"YYYY-MM-DD").format("MMM");t.push([r,e.values[n][1]]),o.push([r,e.values[n][2]]),a.push([r,l]),r--}charts.commerceDashboardPluginSalesRevenueChartStackedBars.options.xaxis.ticks=a,charts.commerceDashboardPluginSalesRevenueChartStackedBars.data=[],charts.commerceDashboardPluginSalesRevenueChartStackedBars.data.push({label:translations.tr_melis_commerce_dashboard_plugin_sales_revenue_order_price,data:t}),charts.commerceDashboardPluginSalesRevenueChartStackedBars.data.push({label:translations.tr_melis_commerce_dashboard_plugin_sales_revenue_shipping_price,data:o}),charts.commerceDashboardPluginSalesRevenueChartStackedBars.plot=$.plot($(i),charts.commerceDashboardPluginSalesRevenueChartStackedBars.data,charts.commerceDashboardPluginSalesRevenueChartStackedBars.options)}).error(function(e,t,i){console.log("ERROR !! Status = "+t+"\n Error = "+i+"\n xhr = "+e.statusText)})},$body.find(".commerce-dashboard-plugin-sales-revenue-placeholder").each(function(e,t){var i=$(t).closest(".grid-stack-item").find(".grid-stack-item-content .widget .widget-parent .widget-body .dashboard-plugin-json-config").text(),s=JSON.parse(i).activeFilter,o=JSON.parse(i).plugin_id;commerceDashboardPluginSalesRevenueChartStackedBarsInit(s,o)})});var commerceDashPluginOrderMessagesAllMessagesInterval="",commerceDashPluginOrderMessagesUnseenMessagesInterval="",commerceDashPluginorderMessagesInstanceCount=0,commDashPluginOrderMessagesWithUnansweredFilterInstance=0;$(document).ready(function(){function e(e){$.ajax({type:"POST",url:"/melis/dashboard-plugin/MelisCommerceDashboardPluginOrderMessages/getMessages",data:{filter:e},dataType:"json",encode:!0}).success(function(i){$(".melis-commerce-dashboard-plugin-order-messages-parent").find('label.active input[value="'+e+'"]').each(function(e,t){s.clear(t),s.setUnansweredMessages(i.unansweredMessages,t)}),$.each(i.messages,function(i,o){s.setMessages(t,o,e)})}).error(function(e,t,i){console.log("ERROR !! Status = "+t+"\n Error = "+i+"\n xhr = "+e.statusText)})}var t="",i="";$("body").on("change",".commerce-dashboard-plugin-order-messages",function(){commerceDashboardPluginOrderMessagesInit($(this))}),$("body").on("click",".commerce-dashboard-plugin-order-messages",function(){s.openOrderMessages(this)}),window.commerceDashboardPluginOrderMessagesInit=function(s){var o="";i=".message-count",void 0===s?(o="all",t=".commerce-dashboard-plugin-order-messages-list"):(o=s.val(),t="#"+s.closest(".melis-commerce-dashboard-plugin-order-messages-parent").find(".commerce-dashboard-plugin-order-messages-list").attr("id")),commDashPluginOrderMessagesWithUnansweredFilterInstance=$(".melis-commerce-dashboard-plugin-order-messages-parent").find('label.active input[value="unseen"]').length,commerceDashPluginorderMessagesInstanceCount=$(".melis-commerce-dashboard-plugin-order-messages-parent").find('label.active input[value="all"]').length,e(o),0==commDashPluginOrderMessagesWithUnansweredFilterInstance&&(clearInterval(commerceDashPluginOrderMessagesUnseenMessagesInterval),commerceDashPluginOrderMessagesUnseenMessagesInterval=""),0==commerceDashPluginorderMessagesInstanceCount&&(clearInterval(commerceDashPluginOrderMessagesAllMessagesInterval),commerceDashPluginOrderMessagesAllMessagesInterval=""),"all"==o?""==commerceDashPluginOrderMessagesAllMessagesInterval&&(commerceDashPluginOrderMessagesAllMessagesInterval=setInterval(e,6e4,o)):""==commerceDashPluginOrderMessagesUnseenMessagesInterval&&(commerceDashPluginOrderMessagesUnseenMessagesInterval=setInterval(e,6e4,o))},$(".commerce-dashboard-plugin-order-messages-list").length>0&&commerceDashboardPluginOrderMessagesInit();var s={openOrderMessages:function(e){var t=$(e).find(".order-message-id").val(),i=$(e).find(".order-message-reference").val();melisHelper.tabOpen(translations.tr_meliscommerce_orders_Orders,"fa fa fa-cart-plus fa-2x","id_meliscommerce_order_list_page","meliscommerce_order_list_page");var s=$("body #melis-id-nav-bar-tabs li a.tab-element[data-id='id_meliscommerce_order_list_page']"),o=setInterval(function(){if(s.length){melisHelper.tabOpen(translations.tr_meliscommerce_orders_Order+" "+i,"fa fa fa-cart-plus fa-2x",t+"_id_meliscommerce_orders_page","meliscommerce_orders_page",{orderId:t},"id_meliscommerce_order_list_page",function(){var e=t+"_id_meliscommerce_orders_content_tabs";$("#"+e).find(".widget-head").find("ul").find("li").each(function(){$(this).find("a").attr("href")=="#"+t+"_id_meliscommerce_orders_content_tabs_content_messages"?$(this).addClass("active"):$(this).hasClass("active")&&$(this).removeClass("active")});var e=t+"_id_meliscommerce_orders_content_tabs_content";$("#"+e).find(".tab-pane").each(function(){$(this).attr("id")==t+"_id_meliscommerce_orders_content_tabs_content_messages"?$(this).addClass("active"):$(this).hasClass("active")&&$(this).removeClass("active")})}),clearInterval(o)}},500)},clear:function(e){$(e).closest(".melis-commerce-dashboard-plugin-order-messages-parent").find(".commerce-dashboard-plugin-order-messages-list").empty(),$(e).closest(".melis-commerce-dashboard-plugin-order-messages-parent").find(".message-count").empty()},setUnansweredMessages:function(e,t){var s="",o="";e>1?(s=translations.tr_melis_commerce_dashboard_plugin_order_messages_unanswered_messages,o=s.replace("%d",e)):(s=translations.tr_melis_commerce_dashboard_plugin_order_messages_unanswered_messages,o=s.replace("messages","message").replace("%d",e)),$(t).closest(".melis-commerce-dashboard-plugin-order-messages-parent").find(i).append(o)},setMessages:function(e,t,i){var s="",o="",a="",r=t.omsg_message.length>70?t.omsg_message.substring(0,70)+"...":t.omsg_message,n=moment(t.omsg_date_creation,"YYYY-MM-DD HH:mm:ss");t.noReply&&(s='style="color: #981a1f;"',a="strong",o='style="background-color: #981a1f;"');var l='<span class="label label-inverse pull-right" '+o+">"+n.format("HH:mm:ss DD MMM")+"</span>",c='<i class="fa fa-angle-double-right" '+s+"<i/>",d='<span class="'+a+'" '+s+">"+t.clientFirstName+" "+t.clientLastName+"</span> "+c+' <small class="'+a+'" '+s+">"+translations.tr_melis_commerce_dashboard_plugin_order_messages_message_order_amount+t.totalOrderAmount+"</small> "+c+' <small class="'+a+'" '+s+">"+translations.tr_melis_commerce_dashboard_plugin_order_messages_message_placed_on+t.orderDate+"</small>",h='<a href="#" class="list-group-item commerce-dashboard-plugin-order-messages" style="border-radius: 0px;border-top: 0px;border-right: 0px;border-left:0px;margin-bottom: 0px;">  <input class="order-message-id" type="text" value="'+t.omsg_order_id+'" hidden="hidden">  <input class="order-message-reference" type="text" value="'+t.reference+'" hidden="hidden">  <span class="media">    <span class="media-body media-body-inline">'+l+d+'    <p class="list-group-item-text" style="font-size:12px;"> '+r+"     </p>    </span>  </span></a>";$(".melis-commerce-dashboard-plugin-order-messages-parent").find('label.active input[value="'+i+'"]').each(function(e,t){$(t).closest(".melis-commerce-dashboard-plugin-order-messages-parent").find(".commerce-dashboard-plugin-order-messages-list").append(h)})}}});